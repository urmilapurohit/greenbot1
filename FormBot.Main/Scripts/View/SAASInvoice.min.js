function SAASInvoiceKendoIntialiize(){kendoCols=[],kendoCols.push({title:"Chkbox",field:"Id",encoded:!1,template:function(e){return'<input type="checkbox" class="k-checkbox"  isInvoice = "'+e.IsInvoiceFlag.toLowerCase()+'" SAASInvoiceId="'+e.InvoiceId+'" Price="'+e.TotalAmount+'" Quantity="'+e.Quantity+'" PaymentStatusID="'+e.Status+'" InvoiceNumber="'+e.InvoiceNumber+'" JobID="'+e.JobID+'" XeroInvoiceId="'+e.XeroInvoiceId+'" id="chk_'+e.InvoiceId+'"><label class="k-checkbox-label" for="chk_'+e.InvoiceId+'">'},filterable:!1,sortable:!1,headerTemplate:'<input type="checkbox" id="chkAll" name="select_all"  class="k-checkbox"><label class="k-checkbox-label" for="chkAll"></label>',width:15,stickyPosition:0,reorderable:!1,resizable:!1}),kendoCols.push({title:"Invoice Id",field:"InvoiceNumber",encoded:!1,headerAttributes:{"data-field":"Invoice Id","data-columnid":"InvoiceNumber","data-order":2},headerTemplate:"<span>Invoice Id</span>",width:32,filterable:{operators:{string:{contains:"Contains"}},extra:!1},sortable:!0}),kendoCols.push({title:"Reseller Name",field:"ResellerName",encoded:!1,headerAttributes:{"data-field":"ResellerName","data-columnid":"ResellerName","data-order":2},headerTemplate:"<span>Reseller Name</span>",width:50,filterable:{operators:{string:{contains:"Contains"}},extra:!1},sortable:!0}),kendoCols.push({title:"Invoice Created",field:"CreatedDate",encoded:!1,headerAttributes:{"data-field":"Invoice Created","data-columnid":"CreatedDate","data-order":3},headerTemplate:"<span>Invoice Created</span>",width:30,template:"#=Kendo_CreatedDate(data) #",filterable:{operators:{string:{eq:"Is equal to",neq:"Is not equal to"}},extra:!0,ui:eval("filter_CreatedDate")},sortable:!0}),kendoCols.push({title:"Status",field:"Status",encoded:!1,headerTemplate:"<span>Status</span>",width:30,filterable:{operators:{string:{eq:"Is equal to"}},extra:!1,ui:filterStatus},template:function(e){return 1==e.Status?"<span >Outstanding</span>":2==e.Status?"<span>Partial Pay</span>":3==e.Status?"<span>Paid</span>":4==e.Status?"<span>Cancelled</span>":void 0},sortable:!0,reorderable:!1,resizable:!1,stickyPosition:4}),kendoCols.push({title:"Invoice Due",field:"InvoiceDueDate",encoded:!1,headerAttributes:{"data-field":"Invoice Due","data-columnid":"InvoiceDueDate","data-order":5},headerTemplate:"<span>Invoice Due</span>",width:30,template:"#=Kendo_InvoiceDueDate(data) #",filterable:{operators:{string:{eq:"Is equal to",neq:"Is not equal to"}},extra:!0,ui:eval("filter_InvoiceDueDate")},sortable:!0}),kendoCols.push({title:"Settlement Term",field:"SettlementTerms",encoded:!1,headerAttributes:{"data-field":"Settlement Term","data-columnid":"SettlementTerms","data-order":6},headerTemplate:"<span>Settlement Term</span>",width:30,filterable:{operators:{string:{contains:"Contains"}},extra:!1},sortable:!0}),kendoCols.push({title:"Rate",field:"Price",headerAttributes:{"data-field":"Rate","data-columnid":"Price","data-order":7},template:function(e){return e.IsGst?'<lable class="lblSTcPrice">$'+parseFloat(e.Price).toFixed(2)+" +GST</lable>":'<lable class="lblSTcPrice">$'+parseFloat(e.Price).toFixed(2)+"</lable>"},width:25,filterable:{operators:{string:{eq:"Is equal to",neq:"Is not equal to"}},extra:!1}}),kendoCols.push({title:"Quantity",field:"Quantity",headerAttributes:{"data-field":"Quantity","data-columnid":"Quantity","data-order":8},template:function(e){return'<lable class="lblSTcPrice">'+parseInt(e.Quantity)+"</lable>"},width:25,filterable:{operators:{string:{eq:"Is equal to",neq:"Is not equal to"}},extra:!1}}),kendoCols.push({title:"Total Amount",field:"TotalAmount",headerAttributes:{"data-field":"Invoice Amount","data-columnid":"TotalAmount","data-order":7},template:function(e){return'<lable class="lblSTcPrice">$'+parseFloat(e.TotalAmount).toFixed(2)+"</lable>"},width:30,filterable:{operators:{string:{eq:"Is equal to",neq:"Is not equal to"}},extra:!1}}),kendoCols.push({title:"Amount Paid",field:"PaidAmount",headerAttributes:{"data-field":"Amount Paid","data-columnid":"PaidAmount","data-order":8},template:function(e){return null==e.PaidAmount?'<lable class="lblSTcPrice">$'+parseFloat("0").toFixed(2)+"</lable>":'<lable class="lblSTcPrice">$'+parseFloat(e.PaidAmount).toFixed(2)+"</lable>"},width:30,filterable:{operators:{string:{eq:"Is equal to",neq:"Is not equal to"}},extra:!1}}),kendoCols.push({title:"Billing Period",field:"BillingPeriod",encoded:!1,headerAttributes:{"data-field":"Billing Period","data-columnid":"BillingPeriod","data-order":9},headerTemplate:"<span>Billing Period</span>",width:40,filterable:{operators:{string:{contains:"Contains"}},extra:!1},sortable:!0}),kendoCols.push({title:"Sent",field:"IsSent",template:function(e){return"true"==e.IsInvoiceFlag.toLowerCase()?'<span style="font-weight: bold;color: Green;">Yes</span>':'<span style="font-weight: bold;color: Red;">No</span>'},width:20,attributes:{class:"dt-right"},headerAttributes:{"data-field":"IsSent","data-columnid":"IsSent","data-order":10},filterable:{operators:{string:{eq:"Is equal to"}},extra:!1}}),kendoCols.push({title:"Action",field:"Id",template:function(e){if(imgassign="text-decoration:none;",4==UserTypeID||6==UserTypeID)e.JobID,e.STCJobDetailID;else e.JobID,e.STCJobDetailID;var t="";return 1==UserTypeID&&(t+='<a href="javascript:void(0);" onclick="CheckInXero(false, false, '+e.SAASUserId+');" style="margin-right:0; margin-top:0px;text-decoration:none;background-position: 11px 0px !important;" class="sync-ic" title="Check In Xero"></a>',e.IsDeleted?t+='<a href="javascript:void(0);" onclick="restoreSAASInvoice('+e.InvoiceId+')" id="" class="btn default btn-sm sprite-img reset_ic" title="Restore invoice"></a>':t+='<a href="javascript:void(0);" onclick="deleteSAASInvoice('+e.InvoiceId+')" id="" class="btn default icon-btn btn-sm remove-ic" title="Delete invoice"></a>'),t+='<a href="javascript:void(0);" onclick="DownloadSAASInvoice(\''+e.InvoiceNumber+'\')" id="" class="btn default btn-sm download_doc" title="Download invoice" style="background-position: center;"></a>',t},sortable:!1,width:50,filterable:!1})}function drawSAASInvoiceKendoGrid(e){$("#datatable").hasClass("k-grid")&&$("#datatable").kendoGrid("destroy").empty(),kendo.ui.FilterMenu.fn.options.operators.date={gte:"Begin Date",lte:"End Date"},$("#datatable").kendoGrid({columns:kendoCols,dataSource:{type:"json",transport:{read:{url:urlSAASInvoiceIndex,data:{},contentType:"application/json",dataType:"json",type:"POST"},parameterMap:function(e){if(null!=e.filter)for(t=0;t<e.filter.filters.length;t++)"CreatedDate"!=e.filter.filters[t].field&&"InvoiceDueDate"!=e.filter.filters[t].field||(e.filter.filters[t].value=moment(new Date(e.filter.filters[t].value.toString().substr(0,16))).format("DD-MM-YYYY"));if(1!=UserTypeID&&3!=UserTypeID||(e.reseller=document.getElementById("hdnResellerIdForFilter").value),e.createdFromDate=$("#txtCreatedFromDate").val(),e.createdToDate=$("#txtCreatedToDate").val(),e.invoiceDueFromDate=$("#txtInvoiceDueFromDate").val(),e.invoiceDueToDate=$("#txtInvoiceDueToDate").val(),e.InvoiceId=$("#txtInvoiceId").val(),e.Owner=$("#searchOwner").val(),"1"==$("#ddlBillingPeriod").val()?e.BillingPeriod="Monthly":"2"==$("#ddlBillingPeriod").val()?e.BillingPeriod="Weekly":e.BillingPeriod="",e.JobID=$("#searchJobid").val(),"1"==$("#SettlementTermId").val()?e.SettlementTermId="PerSTC-S":"2"==$("#SettlementTermId").val()?e.SettlementTermId="PerJob-S":"3"==$("#SettlementTermId").val()?e.SettlementTermId="PerUser-S":e.SettlementTermId="",e.IsSent=$("#chkSentInvoice").prop("checked"),e.reseller=$("#hdnResellerIdForFilter").val(),null!=e.filter)for(var t=0;t<e.filter.filters.length;t++)"IsSent"==e.filter.filters[t].field&&("yes"==e.filter.filters[t].value.toLowerCase()?e.filter.filters[t].value="1":e.filter.filters[t].value="0");return JSON.stringify(e)}},filter:e,schema:{data:"data",total:"total",model:{fields:{CreatedDate:{type:"date"},InvoiceDueDate:{type:"date"}}}},pageSize:GridConfig[0].PageSize,serverPaging:!0,serverSorting:!0,serverFiltering:!0,requestStart:function(e){setTimeout(function(e){$(".k-loading-image").hide()})},requestEnd:function(e){},resizable:!0,scrollable:!0,reorderable:!0,filterMenuInit:function(e){if($(".loading-image").hide(),e.field.includes("Date")){this.thead.find("[data-field='"+e.field+"'] .k-grid-filter").click(function(e){t()});var t=function(){var t=e.container.find("select:eq(0)").data("kendoDropDownList");t.value("gte"),t.trigger("change"),t.enable(!1);var a=e.container.find("select:eq(1)").data("kendoDropDownList");a.wrapper.hide();var o=e.container.find("select:eq(2)").data("kendoDropDownList");o.enable(!1),o.value("lte"),o.trigger("change")};t()}else if("contains"==e.container.find("select").val()){var a=e.container.find("select:eq(0)").data("kendoDropDownList");a.enable(!1)}else if(null!=e.container.find("select:eq(0)").data("kendoDropDownList")&&1==e.container.find("select:eq(0)").data("kendoDropDownList").dataSource.options.data.length){a=e.container.find("select:eq(0)").data("kendoDropDownList");a.enable(!1)}else if("TotalAmount"==e.field||"AmountPaid"==e.field||"Price"==e.field){a=e.container.find("select:eq(0)").data("kendoDropDownList");a.value("eq"),a.trigger("change"),a.enable(!1),e.container.find("input").attr("onkeypress","return isNumber(event);")}},dataBound:function(e){$("#chkAll").change(),$(".k-pager-sizes").find("select").on("change",function(){GridConfig[0].PageSize=$(this).val(),GridConfig[0].IsKendoGrid=!0,GridConfig[0].ViewPageId=3})}},groupable:!1,sortable:!0,filterable:{extra:!1},columnResize:function(e){SaveUserWiseColumnDetails()},columnReorder:onReorder,pageable:{buttonCount:5,pageSizes:[10,25,50,100,200]},resizable:!0,scrollable:!0,reorderable:!0,filterMenuInit:function(e){if($(".loading-image").hide(),e.field.includes("Date")){this.thead.find("[data-field='"+e.field+"'] .k-grid-filter").click(function(e){t()});var t=function(){var t=e.container.find("select:eq(0)").data("kendoDropDownList");t.value("gte"),t.trigger("change"),t.enable(!1);var a=e.container.find("select:eq(1)").data("kendoDropDownList");a.wrapper.hide();var o=e.container.find("select:eq(2)").data("kendoDropDownList");o.enable(!1),o.value("lte"),o.trigger("change")};t()}else if("contains"==e.container.find("select").val()){var a=e.container.find("select:eq(0)").data("kendoDropDownList");a.enable(!1)}else if(null!=e.container.find("select:eq(0)").data("kendoDropDownList")&&1==e.container.find("select:eq(0)").data("kendoDropDownList").dataSource.options.data.length){a=e.container.find("select:eq(0)").data("kendoDropDownList");a.enable(!1)}else if("Price"==e.field||"Quantiy"==e.field){a=e.container.find("select:eq(0)").data("kendoDropDownList");a.value("eq"),a.trigger("change"),a.enable(!1),e.container.find("input").attr("onkeypress","return isNumber(event);")}},dataBound:function(e){$("#chkAll").change(),$(".k-pager-sizes").find("select").on("change",function(){SetPageSizeForGrid($(this).val(),!0,ViewPageId),GridConfig[0].PageSize=$(this).val(),GridConfig[0].IsKendoGrid=!0,GridConfig[0].ViewPageId=parseInt(ViewPageId)})},detailInit:detailInitNew}),$("#datatable").data("kendoGrid").thead.kendoTooltip({filter:"th:not(':first')",content:function(e){var t=e.target;return $(t).text()}})}function onReorder(e){if(void 0!==e.column.reorderable&&!e.column.reorderable){var t=$("#datatable").data("kendoGrid");setTimeout(function(){t.reorderColumn(e.oldIndex,t.columns[e.newIndex])},0)}}function ToDate(e){return null!=e?e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2):""}function SaveUserWiseColumnDetails(){$("#loading-image").css("display","");var e=[],t=0,a=$("#datatable").data("kendoGrid").columns;$("#datatable th").not(":first").each(function(o,i){t+=1;var l=$("#datatable").data("kendoGrid").dataSource.pageSize();e.push({Width:a[o].width,ColumnID:$(i).attr("data-columnid"),OrderNumber:t,PageSize:l})}),$("#loading-image").css("display","none")}function detailInit(e){$("<div/>").appendTo(e.detailCell).kendoGrid({dataSource:{transport:{read:{url:urlSAASInvoiceDetail,data:{},contentType:"application/json",dataType:"json",type:"POST"},parameterMap:function(t){return t.InvoiceId=e.data.InvoiceId,JSON.stringify(t)}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,schema:{data:"data",total:"total",model:{fields:{}}}},scrollable:!1,sortable:!0,pageable:!1,columns:[{field:"InvoiceId",title:"InvoiceId",width:"0px"},{field:"JobId",title:"Job Id",width:"110px"},{field:"RefNumber",title:"Ref. Number",width:"110px"},{field:"OwnerName",title:"Owner Name",width:"110px"},{field:"OwnerAddress",title:"Owner Address",width:"300px"},{field:"STCPrice",title:"STC Amount",width:"100px",template:function(e){return'<lable class="lblSTcPrice">$'+parseFloat(e.STCPrice).toFixed(2)+"</lable>"}},{field:"Status",title:"CER Status",width:"200px"},{field:"RECBulkUploadTime",title:"REC Creation Date",width:"200px",template:function(e){return null!=e.RECBulkUploadTime&&"null"!=e.RECBulkUploadTime?ToDate(new Date(moment(e.RECBulkUploadTime).format("MM/DD/YYYY"))):""}},{field:"STCPVDCode",title:"PVD Code",width:"200px"}]})}function detailInitNew(e){var t=e.data.strJobID;null!=t&&$("<div/>").appendTo(e.detailCell).kendoGrid({dataSource:{transport:{read:{url:urlSAASInvoiceDetail,data:{},contentType:"application/json",dataType:"json",type:"POST"},parameterMap:function(t){return t.strJobID=e.data.strJobID,t.IsInvoiced=e.data.IsInvoice,t.InvoiceId=e.data.InvoiceId,JSON.stringify(t)}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,schema:{data:"data",total:"total",model:{fields:{}}}},scrollable:!1,sortable:!0,pageable:!1,dataBound:childGridDataBound,columns:[{field:"InvoiceId",title:"InvoiceId",width:"110px"},{field:"JobId",title:"Job Id",width:"110px"},{field:"RefNumber",title:"Ref. Number",width:"150px"},{field:"OwnerName",title:"Owner Name",width:"110px"},{field:"OwnerAddress",title:"Owner Address",width:"300px"},{field:"STCPrice",title:"STC Amount",width:"100px",template:function(e){return'<lable class="lblSTcPrice">$'+parseFloat(e.STCPrice).toFixed(2)+"</lable>"}},{field:"Status",title:"CER Status",width:"200px"},{field:"RECBulkUploadTime",title:"REC Creation Date",width:"200px",template:function(e){return null!=e.RECBulkUploadTime&&"null"!=e.RECBulkUploadTime?ToDate(new Date(moment(e.RECBulkUploadTime).format("MM/DD/YYYY"))):""}},{field:"STCPVDCode",title:"PVD Code",width:"200px"}]})}function childGridDataBound(e){for(var t=$("#datatable").data("kendoGrid"),a=e.sender.dataSource._view.length,o=0;o<a;o++){var i=e.sender.dataSource._view[o].uid,l=t.table.find("tr[data-uid='"+i+"']");$(l).css("background-color","#fff1e0")}}function BindSAASUser(){$.ajax({url:"/SAASInvoiceBuilder/GetSAASForPricingManager",dataType:"json",data:{},success:function(e){$("#SAASUserId").autocomplete({minLength:1,source:function(t,a){var o=[];$.each(e,function(e,t){t.ResellerName.toLowerCase().indexOf($("#SAASUserId").val().toLowerCase())>-1&&o.push({Title:t.ResellerName,id:t.ResellerID,ResellerIdForFilter:t.ResellerIdForFilter})}),a($.map(o,function(e){return{label:e.Title,value:e.Title,id:e.id,ResellerIdForFilter:e.ResellerIdForFilter}}))},select:function(e,t){$("#hdnresellerId").val(t.item.id),$("#hdnResellerIdForFilter").val(t.item.ResellerIdForFilter)}}).on("focus",function(){$(this).keydown()})}}),$.ui.autocomplete.prototype._renderItem=function(e,t){var a=new RegExp($.trim(this.term.toLowerCase())),o=t.label.replace(a,"<span style='font-weight:600;'>"+$.trim(this.term.toLowerCase())+"</span>");return $("<li style='font-size:14px;'></li>").data("item.autocomplete",t).append("<a>"+o+"</a>").appendTo(e)}}function ExportCsv(){window.location.href="/SAASInvoice/ExportCSV?&reseller="+$("#hdnresellerId").val()+"&InvoiceId="+$("#txtInvoiceId").val()+"&JobId="+$("#searchJobid").val()+"&Owner="+$("#searchOwner").val()+"&createdFromDate="+GetDates($("#txtCreatedFromDate").val())+"&createdToDate="+GetDates($("#txtCreatedToDate").val())+"&invoiceDueFromDate="+GetDates($("#txtInvoiceDueFromDate").val())+"&invoiceDueToDate="+GetDates($("#txtInvoiceDueToDate").val())+"&IsSent="+document.getElementById("chkSentInvoice").checked+"&SettlementTermId="+$("#SettlementTermId").val()+"&filter="+JSON.stringify($("#datatable").data("kendoGrid").dataSource.filter())}function ExportAllCsv(){window.location.href="/SAASInvoice/ExportAllCSV?&reseller="+$("#hdnresellerId").val()+"&InvoiceId="+$("#txtInvoiceId").val()+"&JobId="+$("#searchJobid").val()+"&Owner="+$("#searchOwner").val()+"&createdFromDate="+GetDates($("#txtCreatedFromDate").val())+"&createdToDate="+GetDates($("#txtCreatedToDate").val())+"&invoiceDueFromDate="+GetDates($("#txtInvoiceDueFromDate").val())+"&invoiceDueToDate="+GetDates($("#txtInvoiceDueToDate").val())+"&IsSent="+document.getElementById("chkSentInvoice").checked+"&SettlementTermId="+$("#SettlementTermId").val()+"&filter="+JSON.stringify($("#datatable").data("kendoGrid").dataSource.filter())}function showErrorMessage(e){$(".alert").hide(),$("#successMsgRegion").hide(),$("#errorMsgRegion").html(closeButton+e),$("#errorMsgRegion").show(),$("html").animate({scrollTop:0},"slow"),$("body").animate({scrollTop:0},"slow")}function showSuccessMessage(e){$(".alert").hide(),$("#errorMsgRegion").hide(),$("#successMsgRegion").html(closeButton+e),$("#successMsgRegion").show(),$("html").animate({scrollTop:0},"slow"),$("body").animate({scrollTop:0},"slow")}function GetDates(e){if(""!=e){var t=ConvertDateToTick(e,dateFormat);return moment(t).format("YYYY-MM-DD")}return""}function deleteSAASInvoice(e){var t=confirm("Are you sure you want to remove SAAS Invoice with ID: "+e+" ?");t&&$.ajax({type:"POST",url:"/SAASInvoice/DeleteSAASInvoice",dataType:"json",data:{InvoiceId:e},success:function(e){filter=$("#datatable").data("kendoGrid").dataSource.filter(),SAASInvoiceKendoIntialiize(),drawSAASInvoiceKendoGrid(filter)},error:function(e){alert("Error deleting data")}})}function RemoveSelectedSAASInvoice(){if(selectedRows=[],$('#datatable tbody input[type="checkbox"]').each(function(){1==$(this).prop("checked")&&selectedRows.push($(this).attr("saasinvoiceid"))}),null!=selectedRows&&selectedRows.length>0){var e=confirm("Are you sure you want to remove selected SAAS Invoice(s) ?");e&&$.ajax({type:"POST",url:"/SAASInvoice/RemoveSelectedSAASInvoice",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({invoiceIds:JSON.stringify(selectedRows)}),success:function(e){filter=$("#datatable").data("kendoGrid").dataSource.filter(),SAASInvoiceKendoIntialiize(),drawSAASInvoiceKendoGrid(filter)},error:function(e){alert("Error deleting data")}})}else null!=selectedRows&&0!=selectedRows.length||alert("Please select any SAAS Invoice to remove.")}function restoreSAASInvoice(e){$.ajax({type:"POST",url:"/SAASInvoice/RestoreSAASInvoice",dataType:"json",data:{InvoiceId:e},success:function(e){filter=$("#datatable").data("kendoGrid").dataSource.filter(),SAASInvoiceKendoIntialiize(),drawSAASInvoiceKendoGrid(filter)},error:function(e){alert("Error restoring data")}})}function StcCompliance(e,t,a){$.ajaxSetup({cache:!1}),$.ajax({type:"POST",url:url_StatusCompliance,data:JSON.stringify({uniq_param:(new Date).getTime(),JobId:t,JobDetailsId:a}),cache:!1,dataType:"html",contentType:"application/json; charset=utf-8",success:function(t){$("#popupStcCompliance").modal({backdrop:"static",keyboard:!1}),$("#modalContentStcCompliance").html(""),$("#modalContentStcCompliance").html(t),$(e).closest("tr").hasClass("hidden-row")?$("#isMultipleRecords").val(1):$("#isMultipleRecords").val(0)},error:function(e){}})}function DownloadSAASInvoice(e){var t=$("#datatable").data("kendoGrid"),a=t.dataSource.page();TempInvoiceId=e,TempIsSent=$("#chkSentInvoice").prop("checked"),window.location.href=urlDownloadSaasInvoice+TempInvoiceId+"&IsSent="+TempIsSent+"&page="+a}function BindGlobalPricingTerms(){$.ajax({type:"GET",url:"/SAASPricingManager/GetGlobalBillingTermsList",data:{IsIsArchive:!1},success:function(e){for(var t='<option value="0" id="popoptn_0">Please Select a Billable Term</option>',a=0;a<e.length;a++)t+='<option id="popoptn_'+e[a].Id+'"  value="'+e[a].Id+'" TermName="'+e[a].TermName+'" TermCode="'+e[a].TermCode+'" Price="'+e[a].GlobalPrice+'" Description="'+e[a].TermDescription+'"  IsGlobalGST="'+e[a].IsGlobalGST+'">'+e[a].strBillableCode+"</option>";$("#ddlPopTermCode").html(t)}})}function BindPrice(e){$("#txtpopPrice").val($("#popoptn_"+e.value).attr("price")),$("#popoptn_"+e.value).attr("isglobalgst")?$("#IspopGlobalGST").prop("checked",!0):$("#IspopGlobalGST").prop("checked",!1)}function BindPopSAASUser(){$.ajax({url:"/SAASInvoiceBuilder/GetSAASForPricingManager",dataType:"json",data:{},success:function(e){for(var t='<option value="0" id="popOptnSaasUser_0">Select</option>',a=0;a<e.length;a++)t+='<option id="popOptnSaasUser_'+e[a].ResellerIdForFilter+'"  value="'+e[a].ResellerIdForFilter+'" ResellerName="'+e[a].ResellerName+'">'+e[a].ResellerName+"</option>";$("#ddlPopSaasUsers").html(t)}})}function CreateNewInvoice(){var e,t,a,o,i;e=$("#ddlPopSaasUsers").val(),t=$("#ddlPopTermCode").val(),a=$("#txtpopPrice").val(),o=$("#txtpopQuantity").val(),i=$("#IspopGlobalGST").prop("checked"),$.ajax({url:urlCreateNewInvoice,dataType:"json",contentType:"application/json; charset=utf-8",type:"post",data:JSON.stringify({ResellerID:e,SettlementTermId:t,Price:a,UnitQTY:o,IsGST:i}),success:function(e){$("#popupCreateNewInvoice .close").click(),$("#ddlPopSaasUsers").val("0"),$("#ddlPopTermCode").val("0"),$("#txtpopPrice").val(""),$("#txtpopQuantity").val(""),$("#IspopGlobalGST").prop("checked",!1),drawSAASInvoiceKendoGrid(),showSuccessMessage("Invoice created.")},error:function(e){showErrorMessage("Invoice not created.")}})}function ValidateCreateNewInvoice(){return"0"==$("#ddlPopSaasUsers").val()?($("#ddlPopSaasUsersCheck").html("Please select saas user."),!1):($("#ddlPopSaasUsersCheck").hide(),"0"==$("#ddlPopTermCode").val()?($("#ddlPopTermCodeCheck").html("Please select term code."),!1):($("#ddlPopTermCodeCheck").hide(),""==$("#txtpopPrice").val()?($("#txtpopPriceCheck").html("Please enter price."),!1):($("#txtpopPriceCheck").hide(),""==$("#txtpopQuantity").val()?($("#txtpopQuantityCheck").html("Please enter quantity."),!1):($("#txtpopQuantityCheck").hide(),!0))))}var kendoCols=[],filterYesNo=function(e){var t=[{Text:"Yes",Value:1},{Text:"No",Value:0}];e.kendoDropDownList({dataTextField:"Text",dataValueField:"Value",dataSource:t,optionLabel:"--Select Value--"})},filterStatus=function(e){var t=[{Text:"OutStanding",Value:1},{Text:"PartialPaid",Value:2},{Text:"Paid",Value:3},{Text:"Cancelled",Value:4}];e.kendoDropDownList({dataTextField:"Text",dataValueField:"Value",dataSource:t,optionLabel:"--Select Value--"})},filter_CreatedDate=function(e){e.kendoDatePicker({format:"dd/MM/yyyy"})},filter_InvoiceDueDate=function(e){e.kendoDatePicker({format:"dd/MM/yyyy"})},Kendo_CreatedDate=function(e){return ToDate(e.CreatedDate)},Kendo_InvoiceDueDate=function(e){return ToDate(e.InvoiceDueDate)};$(document).ready(function(){$("#importCSV").fileupload({url:"/SAASInvoice/ImportCSV",dataType:"json",add:function(e,t){$("#ResellerId").val(),t.submit()},done:function(e,t){t.result.status?(filter=$("#datatable").data("kendoGrid").dataSource.filter(),SAASInvoiceKendoIntialiize(),drawSAASInvoiceKendoGrid(filter),showSuccessMessage("CSV File has been imported successfully.")):t.result.error?showErrorMessage(t.result.error):showErrorMessage("CSV File has not been imported.")},progressall:function(e,t){},singleFileUploads:!1,send:function(e,t){var a=t.files[0].type;if(1==t.files.length)for(var o=0;o<t.files.length;o++){if(t.files[o].name.length>50)return showErrorMessage("Please upload small filename."),$("html").animate({scrollTop:0},"slow"),$("body").animate({scrollTop:0},"slow"),!1;if(CheckSpecialCharInFileName(t.files[o].name))return showErrorMessage("Please upload file that not conatain <> ^ [] ."),$("html").animate({scrollTop:0},"slow"),$("body").animate({scrollTop:0},"slow"),!1}if(t.files.length>1)for(o=0;o<t.files.length;o++){if(t.files[o].size>parseInt(MaxImageSize))return showErrorMessage(" "+t.files[o].name+" Maximum file size limit exceeded. Please upload a file smaller  than "+maxLogoSize+"MB"),!1;if(CheckSpecialCharInFileName(t.files[o].name))return showErrorMessage("Please upload file that not conatain <> ^ [] ."),!1}else if(t.files[0].size>parseInt(MaxImageSize))return showErrorMessage("Maximum  file size limit exceeded.Please upload a  file smaller than "+maxLogoSize+"MB"),!1;return"text/csv"!=a&&"application/csv"!=a&&"csv"!=a&&"text/x-csv"!=a&&"application/x-csv"!=a&&"text/x-comma-separated-values"!=a&&"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=a&&"application/vnd.ms-excel"!=a&&"text/comma-separated-values"!=a&&""!=a?(showErrorMessage("Please upload a file with .csv extension."),!1):($(".alert").hide(),$("#errorMsgRegionForPopUp").html(""),$("#errorMsgRegionForPopUp").hide(),$('<input type="hidden">').attr({name:"Guid",value:USERID,id:USERID}).appendTo("form"),!0)},change:function(e,t){$("#uploadFile").val("C:\\fakepath\\"+t.files[0].name)}}).prop("disabled",!$.support.fileInput).parent().addClass($.support.fileInput?void 0:"disabled"),BindSAASUser(),BindPopSAASUser()}),$("#btnCreateNewInvoice").click(function(){BindGlobalPricingTerms(),$("#popupCreateNewInvoice").modal({backdrop:"static",keyboard:!1})}),$("#btnCancelCreateInvoicePopup").click(function(){$("#popupCreateNewInvoice .close").click(),$("#ddlPopSaasUsers").val("0"),$("#ddlPopTermCode").val("0"),$("#txtpopPrice").val(""),$("#txtpopQuantity").val(""),$("#IspopGlobalGST").prop("checked",!1)});