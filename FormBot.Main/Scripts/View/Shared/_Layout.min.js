function noBack(){window.history.forward()}function setKeepSessionAlive(e){setTimeout("KeepSessionAlive()",6e4*e)}function KeepSessionAlive(){var e=ProjectImagePath+"Base/KeepSessionAlive";$.ajax({type:"POST",url:e,success:function(){setKeepSessionAlive(Sessiontimeout-1)}})}function insertErrorLog(e,o,a,t){$.ajax({url:ProjectImagePath+"Account/InsertErrorintoLogFile/Account",type:"POST",dataType:"json",data:JSON.stringify({strErrortype:e,strstatus:o,strexception:a,url:t}),global:!1,contentType:"application/json; charset=utf-8",success:function(e){},error:function(e){}})}function RedirectFSAToUser(e){$.ajax({url:ProjectImagePath+"Account/RedirectFSAToUser/Account?userID="+e,type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",success:function(e){if(e&&e.status){var o=ProjectImagePath+"Dashboard/Index";""!=e.area&&(e.controller=e.area+"/"+e.controller),o=o.replace("Index",e.action).replace("Dashboard",e.controller),setTimeout(function(){setTimeout(function(){$("#loading-image").show()},60),window.location.href=o},0)}else alert(e.error)},error:function(e){}})}function FillDropDownForChangeUser(e,o,a,t,s,r){if(ProjectSession_SystemUserType&&0!=ProjectSession_SystemUserType.length){var n=JSON.parse(ProjectSession_SystemUserType.replace(/&quot;/g,'"'));DropDownForChangeUser_Values(n,e,o,a,t,s,r)}else $.ajax({url:o,contentType:"application/json",dataType:"json",method:"get",async:!1,cache:!1,success:function(n){DropDownForChangeUser_Values(n,e,o,a,t,s,r)}})}function ChangeUserLink(){$("#popupboxChangeUser").modal({backdrop:"static",keyboard:!1})}function BindUsersByUserType(e,o){if($("#searchUser").val(""),ProjectSession_SystemUsersOfUserType&&0!=ProjectSession_SystemUsersOfUserType.length&&e.indexOf("isTypeChange=1")<0){var a=JSON.parse(ProjectSession_SystemUsersOfUserType.replace(/&quot;/g,'"'));BindUsersByUserType_Values(a,o)}else $.ajax({type:"get",url:e,dataType:"json",success:function(e){BindUsersByUserType_Values(e,o)},error:function(e){alert("Failed to retrieve Users."+e)}});return!1}function BindResellersByUserType(e,o,a,t,s){ProjectImagePath;if($("#searchReseller").val(""),ProjectSession_SystemReseller&&0!=ProjectSession_SystemReseller.length&&0==o){var r=JSON.parse(ProjectSession_SystemReseller.replace(/&quot;/g,'"'));BindSystemReseller_Values(r,o,a,t,s)}else $.ajax({type:"get",url:ProjectImagePath+"Reseller/GetResellerFSAChangeUser/Reseller",dataType:"json",data:{isTypeChange:o},success:function(e){BindSystemReseller_Values(e,o,a,t,s)},error:function(e){alert("Failed to retrieve reseller."+e)}});return!1}function BindSolarCompanyByResellers(e,o,a,t){if($("#searchSolarCompanyFSA").val(""),ProjectSession_SystemSolarCompanyByReseller&&0!=ProjectSession_SystemSolarCompanyByReseller.length){var s=JSON.parse(ProjectSession_SystemSolarCompanyByReseller.replace(/&quot;/g,'"'));BindSystemSolarCompanyByReseller_Value(s,e,o,a,t)}else $.ajax({type:"get",url:ProjectImagePath+"SolarCompany/GetSolarCompanyByResellerIdFSAUserChange/SolarCompany",dataType:"json",data:{resellerId:e,isTypeChange:o},success:function(e){solarCompanyList=[],$.each(e,function(e,o){solarCompanyList.push({value:o.Value,text:o.Text})}),a>0?($("#hdnSolarCompanyIdFSA").val(a),$.each(solarCompanyList,function(e,o){o.value==a&&$("#searchSolarCompanyFSA").val(o.text)})):($("#hdnSolarCompanyIdFSA").val(solarCompanyList.length>0?solarCompanyList[0].value:0),$("#searchSolarCompanyFSA").val(solarCompanyList.length>0?solarCompanyList[0].text:""));var s=ProjectImagePath+"User/GetUserBySolarCompanyId/User?userTypeId="+$("#UserTypeIdFSA").val()+"&solarCompanyId="+$("#hdnSolarCompanyIdFSA").val()+"&isTypeChange="+o;$(".userDropdown").show(),BindUsersByUserType(s,t)},error:function(e){alert("Failed to retrieve solarCompany."+e)}});return!1}function ShowDropDownBasedOnUserType(e,o,a,t,s){if(1==e||3==e||2==e||6==e||7==e||9==e){var r=ProjectImagePath+"User/GetUserByUserTypeId/User?userTypeId="+e+"&isTypeChange="+o;BindUsersByUserType(r,s),$(".userDropdown").show(),$(".resellerDropdown").hide()}else $(".userDropdown").hide(),$(".resellerDropdown").show(),BindResellersByUserType(e,o,a,t,s);$(".solarCompanyDropdown").hide()}function ClearCreatePopup(){$("#createJobNewPopup").find("input[type=text]").each(function(){$(this).val(""),$(this).attr("class","form-control valid")}),$("#createJobNewPopup").find(".field-validation-error").attr("class","field-validation-valid"),$("#createJobNewPopup").find("select").each(function(){$(this).val(""),$(this).attr("class","form-control valid")}),$("#createJobNewPopup").find("textarea").val(""),$("#JobInstallationDetails_IsSameAsOwnerAddress").attr("checked",!1)}function OpenJobCreatePopup(){ClearCreatePopup(),$("#popupboxCreateJobPopup").modal({backdrop:"static",keyboard:!1}),$("#createJobNewPopup").find(".modal-body").height($(window).height()-300),$("#createJobNewPopup").find(".modal-body").css("overflow-y","scroll"),$("#createJobNewPopup").find(".modal-body").animate({scrollTop:0},"fast"),$("body").css("overflow","hidden"),$("#JobOwnerDetails_AddressID_Popup").val(1),$("#JobInstallationDetails_AddressID_Popup").val(1),$("#JobOwnerDetails_OwnerType_Popup").val("Individual"),$("#BasicDetails_JobType_Popup").val(1)}function DropDownForChangeUser_Values(e,o,a,t,s,r,n){var l="";$.each(e,function(e,o){l+='<option value = "'+o.Value+'" >'+o.Text+"</option>"}),$("#"+o).html(l),t&&""!=t&&0!=t&&$("#"+o).val(t),$("#"+o).attr("selval")&&$("#"+o).attr("selval")>0&&$("#"+o).val($("#"+o).attr("selval")),null!=$("#"+o).selectpicker&&$("#"+o).selectpicker("refresh"),null!=r&&r(),"UserTypeIdFSA"==o&&"True"==ProjectSession_IsUserFSA&&$("#UserTypeIdFSA").val(ProjectSession_UserTypeId),"UserFSA"==o&&"True"==ProjectSession_IsUserFSA&&$("#UserFSA").val(ProjectSession_LoggedInUserId),"0"==$("#UserTypeIdFSA").val()?$(".userDropdown").hide():$(".userDropdown").show()}function BindUsersByUserType_Values(e,o){userList=[],$.each(e,function(e,o){userList.push({value:o.Value,text:o.Text})}),o>0?($("#hdnUserId").val(o),$.each(userList,function(e,a){a.value==o&&$("#searchUser").val(a.text)})):($("#hdnUserId").val(userList.length>0?userList[0].value:0),$("#searchUser").val(userList.length>0?userList[0].text:""))}function BindSystemReseller_Values(e,o,a,t,s){if(resellerList=[],$.each(e,function(e,o){resellerList.push({value:o.Value,text:o.Text})}),a>0?($("#hdnResellerId").val(a),$.each(resellerList,function(e,o){o.value==a&&$("#searchReseller").val(o.text)})):($("#hdnResellerId").val(resellerList.length>0?resellerList[0].value:0),$("#searchReseller").val(resellerList.length>0?resellerList[0].text:"")),5==$("#UserTypeIdFSA").val()||4==$("#UserTypeIdFSA").val()){var r=ProjectImagePath+"User/GetUserByResellerId/User?userTypeId="+$("#UserTypeIdFSA").val()+"&resellerId="+$("#hdnResellerId").val()+"&isTypeChange="+o;$(".userDropdown").show(),BindUsersByUserType(r,s)}8==$("#UserTypeIdFSA").val()&&($(".solarCompanyDropdown").show(),BindSolarCompanyByResellers($("#hdnResellerId").val(),o,t,s))}function BindSystemSolarCompanyByReseller_Value(e,o,a,t,s){solarCompanyList=[],$.each(e,function(e,o){solarCompanyList.push({value:o.Value,text:o.Text})}),t>0?($("#hdnSolarCompanyIdFSA").val(t),$.each(solarCompanyList,function(e,o){o.value==t&&$("#searchSolarCompanyFSA").val(o.text)})):($("#hdnSolarCompanyIdFSA").val(solarCompanyList.length>0?solarCompanyList[0].value:0),$("#searchSolarCompanyFSA").val(solarCompanyList.length>0?solarCompanyList[0].text:""));var r=ProjectImagePath+"User/GetUserBySolarCompanyId/User?userTypeId="+$("#UserTypeIdFSA").val()+"&solarCompanyId="+$("#hdnSolarCompanyIdFSA").val()+"&isTypeChange="+a;$(".userDropdown").show(),BindUsersByUserType(r,s)}function OpenVEECCreatePopup(){$("#popupboxCreateVEECPopup").modal({backdrop:"static",keyboard:!1}),$("#createVEECPopup").find(".modal-body").height($(window).height()-300),$("#createVEECPopup").find(".modal-body").css("overflow-y","scroll"),$("#createVEECPopup").find(".modal-body").animate({scrollTop:0},"fast"),$("body").css("overflow","hidden")}function gtag(){dataLayer.push(arguments)}function PassswordResetSnackBar(){SnackBar({message:null,timeout:!1,NotificationTitle:null,SnackbarId:"abc"}),$("div [snackbarid='abc'] .js-snackbar__message").html('Please reset your password,It has been expired.<a href="javascript:void(0)" id="logoutid" style="color:greenyellow">Click Here.</a>'),$("div [snackbarid='abc'] .js-snackbar__message #logoutid").click(function(){var e=logOutURL;$.ajax({type:"get",url:e,success:function(e){window.location.href=forgotPasswordURL}})})}function SetsnackbarSession(e){date=(new Date).toISOString(),$.ajax({url:setSnackbarSessionURL+e,method:"POST",cache:!1,async:!1,success:function(){return!0}})}function ShowHideHeaderSearchBar(){$(".searchbar").toggle(),$("#SearchIcon").toggleClass("active")}function SearchMultipleFilter(){var e=$("#searchresult").val();$("#searchresult").autocomplete({scroll:!1,selectFirst:!1,autoFocus:!1,source:function(o,a){$.ajax({type:"GET",url:urllivesearch,data:{search:e},dataType:"json",contentType:"application/json; charset=utf-8",async:!1,success:function(e){a($.map(e.result,function(e){return{label:e.RefNumber+" ",label2:"("+e.JobID+") ",label3:e.CompanyName,val:e.Id}}));$(".ui-autocomplete").prepend('<span class=ui-menu-item style="height:40px;"><span style="color:#1b94da; font-size:15px;">View All results ('+e.TotalRecords+")</span></span>")},error:function(e){}})},minLength:2,select:function(e,o){var a=o.item.val;window.open("/Job/Index?Id="+a,"_blank")}}).autocomplete("widget").addClass("SearchDropdownAutoComplete"),$.ui.autocomplete.prototype._renderItem=function(e,o){return $("<li></li>").data("item.autocomplete",o).append($("<a></a>").html('<span style="color:#1b94da">'+o.label+"</span>"+o.label2+'</span><br>from <span style="color:#1b94da">'+o.label3+"</span>")).appendTo(e)}}function RedirectToFormBotHelpPage(){window.open(urlFormBotHeplPage,"_blank")}$(document).ready(function(){if(date=(new Date).toISOString(),window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-114902803-1"),$.ajax({url:getNotificationURL+date,method:"POST",cache:!1,async:!1,success:function(e){if(e&&(e=e.replace(/(?:\\r\\n|\\r|\\n)/g,"<br />"),e=JSON.parse(e),null!=e&&null!=e&&e.length))for(var o=0;o<e.length;o++){var a=e[o];a.IsShowToAll&&showSnackbar(a.NotificationContent,!1,a.NotificationTitle,a.NotificationId)}}}),""==sessionIsResetPwd||"null"==sessionIsResetPwd?$.ajax({type:"post",url:urlGetResetFlag,contentType:"application/json; charset=utf-8",success:function(e){1==e.status&&1==e.resetPwdflag&&PassswordResetSnackBar()}}):"True"==sessionIsResetPwd&&PassswordResetSnackBar(),$("#createAnotherJob").click(function(){$("#popupboxSuccessJobCreatePopup").modal("toggle"),$.get(urlCreateJobPopup,function(e){$("#createJobNewPopup").empty(),$("#createJobNewPopup").append(e),OpenJobCreatePopup()})}),$("#viewCreatedJob").click(function(){var e=urlIndexJob+"/"+$(this).attr("jobId");window.location.href=e}),$(".CreateNewJob").click(function(){$.get(urlCreateJobPopup,function(e){$("#createJobNewPopup").empty(),$("#createJobNewPopup").append(e),OpenJobCreatePopup()})}),$("#btnClosepopupboxChangeUser").click(function(){$("#popupboxChangeUser").modal("toggle")}),$(".createJobFromSolarJobScreen").click(function(){event.preventDefault(),$.get(urlCreateJobPopup,function(e){$("#createJobNewPopup").empty(),$("#createJobNewPopup").append(e),OpenJobCreatePopup()})}),$("#searchUser").autocomplete({minLength:0,source:function(e,o){var a=[];$("#hdnUserId").val(""),$.each(userList,function(e,o){o.text.toLowerCase().indexOf($("#searchUser").val().toLowerCase())>-1&&a.push({Title:o.text,id:o.value})}),o($.map(a,function(e){return{label:e.Title,value:e.Title,id:e.id}}))},select:function(e,o){$("#hdnUserId").val(o.item.id)}}).on("focus",function(){$(this).keydown()}),$("#searchReseller").autocomplete({minLength:0,source:function(e,o){var a=[];$("#hdnResellerId").val(""),$.each(resellerList,function(e,o){o.text.toLowerCase().indexOf($("#searchReseller").val().toLowerCase())>-1&&a.push({Title:o.text,id:o.value})}),o($.map(a,function(e){return{label:e.Title,value:e.Title,id:e.id}}))},select:function(e,o){if($("#hdnResellerId").val(o.item.id),5==$("#UserTypeIdFSA").val()||4==$("#UserTypeIdFSA").val()){var a=ProjectImagePath+"User/GetUserByResellerId/User?userTypeId="+$("#UserTypeIdFSA").val()+"&resellerId="+$("#hdnResellerId").val()+"&isTypeChange=1";$(".userDropdown").show(),BindUsersByUserType(a,"")}else 8==$("#UserTypeIdFSA").val()&&($(".solarCompanyDropdown").show(),BindSolarCompanyByResellers($("#hdnResellerId").val(),1,""))}}).on("focus",function(){$(this).keydown()}),$("#searchSolarCompanyFSA").autocomplete({minLength:0,source:function(e,o){var a=[];$("#hdnSolarCompanyIdFSA").val(""),$.each(solarCompanyList,function(e,o){o.text.toLowerCase().indexOf($("#searchSolarCompanyFSA").val().toLowerCase())>-1&&a.push({Title:o.text,id:o.value})}),o($.map(a,function(e){return{label:e.Title,value:e.Title,id:e.id}}))},select:function(e,o){$("#hdnSolarCompanyIdFSA").val(o.item.id);var a=ProjectImagePath+"User/GetUserBySolarCompanyId/User?userTypeId="+$("#UserTypeIdFSA").val()+"&solarCompanyId="+$("#hdnSolarCompanyIdFSA").val()+"&isTypeChange=1";$(".userDropdown").show(),BindUsersByUserType(a,"")}}).on("focus",function(){$(this).keydown()}),$("#searchUser").autocomplete("instance")._renderItem=function(e,o){var a=new RegExp($.trim(this.term.toLowerCase())),t=o.label.replace(a,"<span style='font-weight:600;'>"+$.trim(this.term.toLowerCase())+"</span>");return e.addClass("autocompleteChangeUser"),$("<li style='font-size:14px;'></li>").data("item.autocomplete",o).append("<a>"+t+"</a>").appendTo(e)},$("#searchReseller").autocomplete("instance")._renderItem=function(e,o){var a=new RegExp($.trim(this.term.toLowerCase())),t=o.label.replace(a,"<span style='font-weight:600;'>"+$.trim(this.term.toLowerCase())+"</span>");return e.addClass("autocompleteChangeUser"),$("<li style='font-size:14px;'></li>").data("item.autocomplete",o).append("<a>"+t+"</a>").appendTo(e)},$("#searchSolarCompanyFSA").autocomplete("instance")._renderItem=function(e,o){var a=new RegExp($.trim(this.term.toLowerCase())),t=o.label.replace(a,"<span style='font-weight:600;'>"+$.trim(this.term.toLowerCase())+"</span>");return e.addClass("autocompleteChangeUser"),$("<li style='font-size:14px;'></li>").data("item.autocomplete",o).append("<a>"+t+"</a>").appendTo(e)},$(".disableMenu").removeClass("disableMenu"),$(".menu .active").length>1&&$(".menu").find("li").first().removeClass("active"),$(".menu li a").click(function(){currentMenu=$(this).attr("id"),document.cookie="menuname="+$(this).attr("id")+"; path=/"}),$(document).ajaxStart(function(){$("#loading-image").show()}),$(document).ajaxComplete(function(){$("#loading-image").hide()}),$(document).ajaxError(function(e,o,a,t){var s=e.type,r=o.status,n=t,l=a.url;try{insertErrorLog(s,r,n,l)}catch(e){}}),null!=ProjectSession_Logo&&null!=ProjectSession_Theme&&""!=ProjectSession_Logo&&""!=ProjectSession_Theme){if("Images/logo.png"==ProjectSession_Logo)$("#imgLogo").attr("src",ProjectSession_SiteUrlBase+ProjectSession_Logo);else{$("body").attr("id",ProjectSession_Theme);var e=UploadedDocumentPath,o=ProjectSession_Logo,a=e+"UserDocuments/"+o;$("#imgLogo").attr("src",a),$(".hd-top .logo img").css("height","60px"),$(".hd-top .logo img").css("margin-top","0px")}$("body").attr("id",ProjectSession_Theme)}$("body").find("form").submit(function(e){if("function"==typeof validateExtraFields&&0==validateExtraFields())return!1}),$(document).attr("title","GreenBot - "+$("h1:first").text()),window.history.forward();var t=function(){ShowDropDownBasedOnUserType($("#UserTypeIdFSA").val(),1,"","","")};1!=ProjectSession_UserTypeId&&"True"!=ProjectSession_IsUserFSA||(FillDropDownForChangeUser("UserTypeIdFSA",ProjectImagePath+"UserType/GetUserType/UserType",1,!0,null),ShowDropDownBasedOnUserType($("#UserTypeIdFSA").val(),0,ProjectSession_ResellerId,ProjectSession_SolarCompanyId,ProjectSession_LoggedInUserId),$("#UserTypeIdFSA").unbind("change",t),$("#UserTypeIdFSA").bind("change",t)),$("#saveChangeUser").click(function(){$("#hdnUserId").val()>0?RedirectFSAToUser($("#hdnUserId").val()):alert("Please select user.")}),$("#resetChangeUser").click(function(){$(".resellerDropdown").hide(),$(".solarCompanyDropdown").hide(),$("#UserTypeIdFSA").val(1);var e=ProjectImagePath+"User/GetUserByUserTypeId/User?userTypeId=1&isTypeChange=1";BindUsersByUserType(e,"")}),setKeepSessionAlive(Sessiontimeout-1),$("#CreateVEECs").click(function(){OpenVEECCreatePopup()}),$("#createAnotherVeec").click(function(){$("#popupboxSuccessVeecCreatePopup").modal("toggle"),OpenVEECCreatePopup()}),$("#viewCreatedVeec").click(function(){var e=urlIndexVEEC+"/"+$(this).attr("veecID");window.location.href=e}),$(document).on("click","#closeErrorPopup",function(){$("#dialog").modal("hide")}),$("#jobTemplateId").change(function(){"2"==$(this).val()?($("#popupboxCreateJobTemplate").find(".newJob").css("display","none"),$("#popupboxCreateJobTemplate").find(".oldJob").css("display","")):($("#popupboxCreateJobTemplate").find(".newJob").css("display",""),$("#popupboxCreateJobTemplate").find(".oldJob").css("display","none"))})});