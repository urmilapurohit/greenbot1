var source, destination, directionsDisplay, latitude, longitude, latitude1, longitude1, OwnerPostcodeFromjson, InstallationPostcodeFromjson, OwnerEmailFromJson, OwnerFirstNameFromJson, OwnerLastNameFromJson, InstallerEmailFromJson, InstallerFirstNameFromJson, InstallerLastNameFromJson, locations = [], sourcedetail = [], destinationdetail = [], PanelXml = [], panel = [], inverter = [], InverterXml = [], dateaa = "", jsonvarSoldByDate = "", jsonvarJobSoldBy = "", ElectrianAddressJson = [], OwnerAddressJson = [], InstallationJson = [], InstallerJson = [], batteryXml = []; $("#BasicDetails_JobStage").change(function () { var e = $("#BasicDetails_JobStage option:selected").text(); $("#BasicDetails_CurrentJobStage").val(e) }), $("#BasicDetails_Priority").change(function () { var e = $("#BasicDetails_Priority option:selected").text(); $("#BasicDetails_CurrentPriority").val(e) }), $("#SSCID").change(function () { var e = $("#SSCID option:selected").text(); $("#BasicDetails_SSCName").val(e) }); var fillBasicAddress = function () { if ("0" != $("#BasicDetails_JobID").val()) { if ("" != $("#JobElectricians_Town").val().trim() && null != $("#JobElectricians_Town").val() && null != $("#JobElectricians_Town").val() && $("#JobElectricians_UnitTypeID").find("option").length > 0 && $("#JobElectricians_PostalAddressID").find("option").length > 0 && $("#JobElectricians_StreetTypeID").find("option").length > 0) { var e = $("#JobElectricians_UnitTypeID [value=" + JobElectricians_UnitTypeID + "]").text(), t = $("#JobElectricians_UnitNumber").val(), a = $("#JobElectricians_StreetNumber").val(), l = $("#JobElectricians_StreetName").val(), i = $("#JobElectricians_StreetTypeID").find("option:selected").text(), s = $("#JobElectricians_PostalAddressID [value=" + JobElectricians_PostalAddressID + "]").text(), n = $("#JobElectricians_PostalDeliveryNumber").val(), o = $("#JobElectricians_Town").val(), r = $("#JobElectricians_State").val(), d = $("#JobElectricians_PostCode").val(), c = $("#JobElectricians_CompanyName").val(), u = $("#JobElectricians_FirstName").val(), b = $("#JobElectricians_LastName").val(), D = $("#JobElectricians_Email").val(), m = $("#JobElectricians_Phone").val(), p = $("#JobElectricians_Mobile").val(), v = $("#JobElectricians_LicenseNumber").val(); 1 == $("#JobElectricians_AddressID").val() ? ("" != t ? (address = e + " " + t + "/" + a + " " + l + " " + i + ", " + o + " " + r + " " + d, address = address.replace("Select", "")) : (address = e + " " + a + " " + l + " " + i + ", " + o + " " + r + " " + d, address = address.replace("Select", "")), ElectrianAddressJson.push({ PostalAddressType: $("#JobElectricians_AddressID").val(), UnitType: $("#JobElectricians_UnitTypeID").val(), UnitNumber: $("#JobElectricians_UnitNumber").val(), StreetNumber: $("#JobElectricians_StreetNumber").val(), StreetName: $("#JobElectricians_StreetName").val(), StreetType: $("#JobElectricians_StreetTypeID").val(), Town: $("#JobElectricians_Town").val(), State: $("#JobElectricians_State").val(), PostCode: $("#JobElectricians_PostCode").val(), CompanyName: c, FirstName: u, LastName: b, Email: D, Phone: m, Mobile: p, LicenseNumber: v })) : (address = s + " " + n + ", " + o + " " + r + " " + d, ElectrianAddressJson.push({ PostalAddressType: $("#JobElectricians_AddressID").val(), PostalAddressID: $("#JobElectricians_PostalAddressID").val(), PostalDeliveryNumber: $("#JobElectricians_PostalDeliveryNumber").val(), Town: $("#JobElectricians_Town").val(), State: $("#JobElectricians_State").val(), PostCode: $("#JobElectricians_PostCode").val(), CompanyName: c, FirstName: u, LastName: b, Email: D, Phone: m, Mobile: p, LicenseNumber: v })), address = address.replace("Select", "") } $("#txtBasicAddress").val($("#JobElectricians_FirstName").val() + " " + $("#JobElectricians_LastName").val()) } }, fillInstallationAddress = function () { if ("0" != $("#BasicDetails_JobID").val() && "" != $("#JobInstallationDetails_Town").val().trim() && null != $("#JobInstallationDetails_Town").val() && null != $("#JobInstallationDetails_Town").val() && $("#JobInstallationDetails_UnitTypeID").find("option").length > 0 && $("#JobInstallationDetails_StreetTypeID").find("option").length > 0 && $("#JobInstallationDetails_PostalAddressID").find("option").length > 0) { var e, t = $("#JobInstallationDetails_UnitTypeID").find("option:selected").text(), a = $("#JobInstallationDetails_UnitNumber").val(), l = $("#JobInstallationDetails_StreetNumber").val(), i = $("#JobInstallationDetails_StreetName").val(), s = $("#JobInstallationDetails_StreetTypeID").find("option:selected").text(), n = $("#JobInstallationDetails_PostalAddressID").find("option:selected").text(), o = $("#JobInstallationDetails_PostalDeliveryNumber").val(), r = $("#JobInstallationDetails_Town").val(), d = $("#JobInstallationDetails_State").val(), c = $("#JobInstallationDetails_PostCode").val(); 1 == $("#JobInstallationDetails_AddressID").val() ? (e = "" != a ? (e = t + " " + a + "/" + l + " " + i + " " + s + ", " + r + " " + d + " " + c).replace("Select", "") : (e = t + " " + l + " " + i + " " + s + ", " + r + " " + d + " " + c).replace("Select", ""), InstallationJson.push({ PostalAddressType: $("#JobInstallationDetails_AddressID").val(), UnitType: $("#JobInstallationDetails_UnitTypeID").val(), UnitNumber: $("#JobInstallationDetails_UnitNumber").val(), StreetNumber: $("#JobInstallationDetails_StreetNumber").val(), StreetName: $("#JobInstallationDetails_StreetName").val(), StreetType: $("#JobInstallationDetails_StreetTypeID").val(), Town: $("#JobInstallationDetails_Town").val(), State: $("#JobInstallationDetails_State").val(), PostCode: $("#JobInstallationDetails_PostCode").val() })) : (e = n + " " + o + ", " + r + " " + d + " " + c, InstallationJson.push({ PostalAddressType: $("#JobInstallationDetails_AddressID").val(), PostalAddressID: $("#JobInstallationDetails_PostalAddressID").val(), PostalDeliveryNumber: $("#JobInstallationDetails_PostalDeliveryNumber").val(), Town: $("#JobInstallationDetails_Town").val(), State: $("#JobInstallationDetails_State").val(), PostCode: $("#JobInstallationDetails_PostCode").val() })), InstallationPostcodeFromjson = $("#JobInstallationDetails_PostCode").val(), "/ ," != (e = e.replace("Select", "")).trim() && "/Select ," != e.trim() && ($("#JobInstallationDetails_AddressDisplay").val(e), $("#txtAddress").val(e), $("#spantxtAddress").hide()) } }, fillOwnerAddress = function () { if ("0" != $("#BasicDetails_JobID").val() && $("#JobOwnerDetails_UnitTypeID").find("option").length > 0 && $("#JobOwnerDetails_PostalAddressID").find("option").length > 0 && $("#JobOwnerDetails_StreetTypeID").find("option").length > 0) { if (1 == $("#JobOwnerDetails_AddressID").val()) { var e = { OwnerType: $("#JobOwnerDetails_OwnerType").val(), CompanyName: $("#JobOwnerDetails_CompanyName").val(), Phone: $("#JobOwnerDetails_Phone").val(), Mobile: $("#JobOwnerDetails_Mobile").val(), FirstName: $("#JobOwnerDetails_FirstName").val(), LastName: $("#JobOwnerDetails_LastName").val(), Email: $("#JobOwnerDetails_Email").val(), PostalAddressType: $("#JobOwnerDetails_AddressID").val(), UnitType: $("#JobOwnerDetails_UnitTypeID").val(), UnitNumber: $("#JobOwnerDetails_UnitNumber").val(), StreetNumber: $("#JobOwnerDetails_StreetNumber").val(), StreetName: $("#JobOwnerDetails_StreetName").val(), StreetType: $("#JobOwnerDetails_StreetTypeID").val(), Town: $("#JobOwnerDetails_Town").val(), State: $("#JobOwnerDetails_State").val(), PostCode: $("#JobOwnerDetails_PostCode").val() }; OwnerAddressJson.push(e) } else OwnerAddressJson.push({ OwnerType: $("#JobOwnerDetails_OwnerType").val(), CompanyName: $("#JobOwnerDetails_CompanyName").val(), Phone: $("#JobOwnerDetails_Phone").val(), Mobile: $("#JobOwnerDetails_Mobile").val(), FirstName: $("#JobOwnerDetails_FirstName").val(), LastName: $("#JobOwnerDetails_LastName").val(), Email: $("#JobOwnerDetails_Email").val(), PostalAddressType: $("#JobOwnerDetails_AddressID").val(), PostalAddressID: $("#JobOwnerDetails_PostalAddressID").val(), PostalDeliveryNumber: $("#JobOwnerDetails_PostalDeliveryNumber").val(), Town: $("#JobOwnerDetails_Town").val(), State: $("#JobOwnerDetails_State").val(), PostCode: $("#JobOwnerDetails_PostCode").val() }); OwnerPostcodeFromjson = $("#JobOwnerDetails_PostCode").val(), OwnerEmailFromJson = $("#JobOwnerDetails_Email").val(), OwnerFirstNameFromJson = $("#JobOwnerDetails_FirstName").val(), OwnerLastNameFromJson = $("#JobOwnerDetails_LastName").val() } }, fillInstallerAddress = function () { "0" != $("#BasicDetails_JobID").val() && "2" == $("#BasicDetails_JobType").val() && $("#JobInstallerDetails_UnitTypeID").find("option").length > 0 && $("#JobInstallerDetails_PostalAddressID").find("option").length > 0 && $("#JobInstallerDetails_StreetTypeID").find("option").length > 0 && (1 == $("#JobInstallerDetails_AddressID").val() ? InstallerJson.push({ Phone: $("#JobInstallerDetails_Phone").val(), Mobile: $("#JobInstallerDetails_Mobile").val(), FirstName: $("#JobInstallerDetails_FirstName").val(), Surname: $("#JobInstallerDetails_Surname").val(), Email: $("#JobInstallerDetails_Email").val(), PostalAddressType: $("#JobInstallerDetails_AddressID").val(), UnitType: $("#JobInstallerDetails_UnitTypeID").val(), UnitNumber: $("#JobInstallerDetails_UnitNumber").val(), StreetNumber: $("#JobInstallerDetails_StreetNumber").val(), StreetName: $("#JobInstallerDetails_StreetName").val(), StreetType: $("#JobInstallerDetails_StreetTypeID").val(), Town: $("#JobInstallerDetails_Town").val(), State: $("#JobInstallerDetails_State").val(), PostCode: $("#JobInstallerDetails_PostCode").val() }) : InstallerJson.push({ Phone: $("#JobInstallerDetails_Phone").val(), Mobile: $("#JobInstallerDetails_Mobile").val(), FirstName: $("#JobInstallerDetails_FirstName").val(), Surname: $("#JobInstallerDetails_Surname").val(), Email: $("#JobInstallerDetails_Email").val(), PostalAddressType: $("#JobInstallerDetails_AddressID").val(), PostalAddressID: $("#JobInstallerDetails_PostalAddressID").val(), PostalDeliveryNumber: $("#JobInstallerDetails_PostalDeliveryNumber").val(), Town: $("#JobInstallerDetails_Town").val(), State: $("#JobInstallerDetails_State").val(), PostCode: $("#JobInstallerDetails_PostCode").val() }), InstallerEmailFromJson = $("#JobInstallerDetails_Email").val(), InstallerFirstNameFromJson = $("#JobInstallerDetails_FirstName").val(), InstallerLastNameFromJson = $("#JobInstallerDetails_Surname").val()) }, fillJobStage = function () { $("#BasicDetails_JobStage").find("option").eq(0).remove() }; function fillJobType() { 0 == BasicDetails_JobID && ($("#BasicDetails_JobType").val("1").change(), $("#BasicDetails_JobType option").first().remove()) } function fillJobType() { 0 == BasicDetails_JobID && ($("#BasicDetails_JobType").val("1").change(), $("#BasicDetails_JobType option").first().remove()) } function clearSoldBy() { $("#popupSoldBy").modal("hide") } function SaveJob(e) { "false" == isAssignSSC ? $("#BasicDetails_SSCID").val(BasicDetails_SSCID) : "" != $("#SSCID").val() && $("#SSCID").val() > 0 ? $("#BasicDetails_SSCID").val($("#SSCID").val()) : $("#BasicDetails_SSCID").val(""), "false" == isAssignSCO ? $("#BasicDetails_ScoID").val(BasicDetails_ScoID) : "" != $("#ScoID").val() && $("#ScoID").val() > 0 ? $("#BasicDetails_ScoID").val($("#ScoID").val()) : $("#BasicDetails_ScoID").val(""), EnableDropDownbyUsertype(), $("#BasicDetails_JobType").removeAttr("disabled"); var t = "", a = "", l = []; if (l = JSON.parse(JSON.stringify(batteryXml)), PanelXml.length > 0) { var i = JSON.stringify(PanelXml), s = "", n = $.parseJSON(i); $.each(n, function () { s += "<panel><Brand>" + htmlEncode(this.Brand) + "</Brand><Model>" + htmlEncode(this.Model) + "</Model><NoOfPanel>" + this.Count + "</NoOfPanel></panel>" }), t = "<Panels>" + s + "</Panels>" } if (InverterXml.length > 0) { i = JSON.stringify(InverterXml), s = "", n = $.parseJSON(i); $.each(n, function () { s += "<inverter><Brand>" + htmlEncode(this.Brand) + "</Brand><Model>" + htmlEncode(this.Model) + "</Model><Series>" + htmlEncode(this.Series) + "</Series></inverter>" }), a = "<Inverters>" + s + "</Inverters>" } $("#panelXml").val(t), $("#inverterXml").val(a); var o = JSON.stringify($("form").serializeToJson()), r = JSON.parse(o); if (r.JobSTCDetails.batterySystemPartOfAnAggregatedControl = $("#JobSTCDetails_batterySystemPartOfAnAggregatedControl").val(), r.JobSTCDetails.changedSettingOfBatteryStorageSystem = $("#JobSTCDetails_changedSettingOfBatteryStorageSystem").val(), l.length > 0) { for (var d = 0; d < l.length; d++)delete l[d].JobBatteryManufacturerId; r.lstJobBatteryManufacturer = l } var c = ""; "True" == isAddJob ? c = urlCreate : "True" == isEditjob && (c = urlEdit); c = ""; "True" == isAddJob ? c = urlCreate : "True" == isEditjob && (c = urlEdit), o = JSON.stringify(r), $.ajax({ url: c, type: "POST", dataType: "json", contentType: "application/json; charset=utf-8", processData: !1, data: o, cache: !1, async: !0, success: function (t) { (t.insert || t.update) && (1 == $("#BasicDetails_JobType").val() ? t.STCValue > 0 ? $("#JobSystemDetails_CalculatedSTC").val(t.STCValue) : $("#JobSystemDetails_CalculatedSTC").val("") : t.STCValue > 0 ? $("#JobSystemDetails_CalculatedSTCForSWH").val(t.STCValue) : $("#JobSystemDetails_CalculatedSTCForSWH").val("")), t.insert ? ($("#successMsgRegion").html(closeButton + " Job has been saved successfully."), $("#successMsgRegion").show(), $("html").animate({ scrollTop: 0 }, "slow"), $("body").animate({ scrollTop: 0 }, "slow"), window.location.href = 0 == e ? urlIndex + "/" + t.id : urlCreate, DisableDropDownbyUsertype()) : t.update ? ($("#successMsgRegion").html(closeButton + " Job has been updated."), $("#successMsgRegion").show(), $("html").animate({ scrollTop: 0 }, "slow"), $("body").animate({ scrollTop: 0 }, "slow"), $("#dvDocuments").load(url_Documents + t.id), DisableDropDownbyUsertype()) : t.error ? ($("#errorMsgRegion").html(closeButton + t.errorMessage), $("#errorMsgRegion").show(), $("html").animate({ scrollTop: 0 }, "slow"), $("body").animate({ scrollTop: 0 }, "slow"), DisableDropDownbyUsertype()) : ($("#errorMsgRegion").html(closeButton + " Job not save."), $("#errorMsgRegion").show(), $("html").animate({ scrollTop: 0 }, "slow"), $("body").animate({ scrollTop: 0 }, "slow"), DisableDropDownbyUsertype()), (t.insert || t.update) && ("" != $("#BasicDetails_GSTDocument").val() && null != $("#BasicDetails_GSTDocument").val() && null != $("#BasicDetails_GSTDocument").val() ? $("#BasicDetails_GSTDocument").attr("OldFileName", $("#BasicDetails_GSTDocument").val()) : $("#BasicDetails_GSTDocument").attr("OldFileName", "")) } }), $("#BasicDetails_JobType").attr("disabled", "disabled") } function loadMap() { new google.maps.Map(document.getElementById("dvMap")); directionsService = new google.maps.DirectionsService, new google.maps.places.SearchBox(document.getElementById("txtSource")), new google.maps.places.SearchBox(document.getElementById("txtDestination")), directionsDisplay = new google.maps.DirectionsRenderer({ draggable: !1 }), google.maps.event.addListener(directionsDisplay, "directions_changed", function () { directions = directionsDisplay.getDirections(); var e = directions.routes[0].legs[0].distance.text, t = directions.routes[0].legs[0].duration.text, a = directions.routes[0].legs[0].start_address, l = directions.routes[0].legs[0].end_address, i = document.getElementById("dvDistance"); i.innerHTML = "", i.innerHTML += "Distance: " + e + "   ", i.innerHTML += "Duration:" + t, $("#txtSource").val(a), $("#txtDestination").val(l) }) } function GetRoute() { if ($("#dvDistance").html(""), $("#errorMsgRegionMap").hide(), source = document.getElementById("txtSource").value, destination = document.getElementById("txtDestination").value, "" != source && "" != destination) { var e = { zoom: 4, center: new google.maps.LatLng(51.508742, -.12085) }; map = new google.maps.Map(document.getElementById("dvMap"), e), directionsDisplay.setMap(map); var t = { origin: source, destination: destination, travelMode: google.maps.TravelMode.DRIVING }; directionsService.route(t, function (e, t) { t == google.maps.DirectionsStatus.OK ? directionsDisplay.setDirections(e) : (createMarker(destination, 25.2744, 133.7751), $("#errorMsgRegionMap").html(closeButton + " Both Source and Destination  are not in same country."), $("#errorMsgRegionMap").show()) }) } else $("#errorMsgRegionMap").html(closeButton + " Both Source and Destination  address are  required"), $("#errorMsgRegionMap").show() } function GetLocation() { latitude = "", longitude = "", latitude1 = "", longitude1 = "", $("#dvDistance").html(""), $("#errorMsgRegionMap").hide(), locations = [], source = document.getElementById("txtSource").value, destination = document.getElementById("txtDestination").value, geocoder = new google.maps.Geocoder, "" != source || "" != destination ? ("" != source && geocoder.geocode({ address: source }, function (e, t) { t == google.maps.GeocoderStatus.OK ? (latitude = e[0].geometry.location.lat(), longitude = e[0].geometry.location.lng(), sourcedetail = [source, latitude, longitude], locations.push(sourcedetail), GetLocationOnMap(latitude, longitude)) : ($("#errorMsgRegionMap").html(closeButton + "Invalid source Address."), $("#errorMsgRegionMap").show(), createMarker("Victoria , Australia", -37.4713, 144.7852)) }), "" != destination && geocoder.geocode({ address: destination }, function (e, t) { t == google.maps.GeocoderStatus.OK ? (latitude1 = e[0].geometry.location.lat(), longitude1 = e[0].geometry.location.lng(), destinationdetail = [destination, latitude1, longitude1], locations.push(destinationdetail), GetLocationOnMap(latitude1, longitude1)) : ($("#errorMsgRegionMap").html(closeButton + "Invalid Destination Address."), $("#errorMsgRegionMap").show(), createMarker("Victoria , Australia", -37.4713, 144.7852)) })) : ($("#errorMsgRegionMap").html(closeButton + "Source or Destination address  are  required"), $("#errorMsgRegionMap").show()) } function GetLocationOnMap(e, t) { var a, l, i = new google.maps.LatLngBounds, s = new google.maps.InfoWindow, n = e, o = t, r = new google.maps.Map(document.getElementById("dvMap"), { zoom: 10, center: new google.maps.LatLng(n, o), mapTypeId: google.maps.MapTypeId.DRIVING }); for (l = 0; l < locations.length; l++)a = new google.maps.Marker({ position: new google.maps.LatLng(locations[l][1], locations[l][2]), draggable: !1, map: r }), i.extend(a.position), google.maps.event.addListener(a, "click", function (e, t) { return function () { s.setContent(locations[t][0]), s.open(r, e) } }(a, l)); r.fitBounds(i) } function geocodeAddress(e) { $("#errorMsgRegionMap").hide(); var t = new google.maps.Geocoder; "" == e.trim() ? createMarker("Victoria , Australia", -37.4713, 144.7852) : t.geocode({ address: e }, function (t, a) { if (a == google.maps.GeocoderStatus.OK) { var l = t[0].geometry.location, i = l.lat(), s = l.lng(); createMarker(e, i, s) } else $("#errorMsgRegionMap").html(closeButton + "Invalid Destination Address."), $("#errorMsgRegionMap").show(), createMarker("Victoria , Australia", -37.4713, 144.7852) }) } function createMarker(e, t, a) { var l = new google.maps.InfoWindow, i = new google.maps.LatLng(t, a), s = new google.maps.Map(document.getElementById("dvMap"), { zoom: 12, center: new google.maps.LatLng(t, a), mapTypeId: google.maps.MapTypeId.DRIVING }), n = (new google.maps.LatLngBounds, e), o = new google.maps.Marker({ position: new google.maps.LatLng(t, a), center: i, map: s, draggable: !1 }); google.maps.event.addListener(o, "click", function () { l.setContent(n), l.open(s, o) }) } function isValidPhone(e, t) { return !!e.ctrlKey || (43 == e.which && $("#" + t.id).val().length < 2 && -1 == $("#" + t.id).val().indexOf("+") || !(e.which > 31 && (e.which < 48 || e.which > 57))) } function fillJobType() { 0 == BasicDetails_JobID && $("#BasicDetails_JobType").val("1").change() } function validateInstallation() { if (addressInstallationValidationRules(), $("#JobInstallationAddress").valid()) { var e; InstallationJson = []; var t = $("#JobInstallationDetails_UnitTypeID").find("option:selected").text(), a = $("#JobInstallationDetails_UnitNumber").val(), l = $("#JobInstallationDetails_StreetNumber").val(), i = $("#JobInstallationDetails_StreetName").val(), s = $("#JobInstallationDetails_StreetTypeID").find("option:selected").text(), n = $("#JobInstallationDetails_PostalAddressID").find("option:selected").text(), o = $("#JobInstallationDetails_PostalDeliveryNumber").val(), r = $("#JobInstallationDetails_Town").val(), d = $("#JobInstallationDetails_State").val(), c = $("#JobInstallationDetails_PostCode").val(); 1 == $("#JobInstallationDetails_AddressID").val() ? (e = "" != a ? (e = t + " " + a + "/" + l + " " + i + " " + s + ", " + r + " " + d + " " + c).replace("Select", "") : (e = t + " " + l + " " + i + " " + s + ", " + r + " " + d + " " + c).replace("Select", ""), InstallationJson.push({ PostalAddressType: $("#JobInstallationDetails_AddressID").val(), UnitType: $("#JobInstallationDetails_UnitTypeID").val(), UnitNumber: $("#JobInstallationDetails_UnitNumber").val(), StreetNumber: $("#JobInstallationDetails_StreetNumber").val(), StreetName: $("#JobInstallationDetails_StreetName").val(), StreetType: $("#JobInstallationDetails_StreetTypeID").val(), Town: $("#JobInstallationDetails_Town").val(), State: $("#JobInstallationDetails_State").val(), PostCode: $("#JobInstallationDetails_PostCode").val() })) : (e = n + " " + o + ", " + r + " " + d + " " + c, InstallationJson.push({ PostalAddressType: $("#JobInstallationDetails_AddressID").val(), PostalAddressID: $("#JobInstallationDetails_PostalAddressID").val(), PostalDeliveryNumber: $("#JobInstallationDetails_PostalDeliveryNumber").val(), Town: $("#JobInstallationDetails_Town").val(), State: $("#JobInstallationDetails_State").val(), PostCode: $("#JobInstallationDetails_PostCode").val() })), InstallationPostcodeFromjson = $("#JobInstallationDetails_PostCode").val(), $("#JobInstallationDetails_AddressDisplay").val(e), $("#txtAddress").val(e), $("#spantxtAddress").hide(), $("#popupAddress").modal("toggle") } } function validateBasicAddress() { if (addressElectricianValidationRules(), $("#JobElectricians").valid()) { ElectrianAddressJson = []; var e = $("#JobElectricians_UnitTypeID").find("option:selected").text(), t = $("#JobElectricians_UnitNumber").val(), a = $("#JobElectricians_StreetNumber").val(), l = $("#JobElectricians_StreetName").val(), i = $("#JobElectricians_StreetTypeID").find("option:selected").text(), s = $("#JobElectricians_PostalAddressID").find("option:selected").text(), n = $("#JobElectricians_PostalDeliveryNumber").val(), o = $("#JobElectricians_Town").val(), r = $("#JobElectricians_State").val(), d = $("#JobElectricians_PostCode").val(), c = $("#JobElectricians_CompanyName").val(), u = $("#JobElectricians_FirstName").val(), b = $("#JobElectricians_LastName").val(), D = $("#JobElectricians_Email").val(), m = $("#JobElectricians_Phone").val(), p = $("#JobElectricians_Mobile").val(), v = $("#JobElectricians_LicenseNumber").val(); 1 == $("#JobElectricians_AddressID").val() ? ("" != t ? (e + " " + t + "/" + a + " " + l + " " + i + ", " + o + " " + r + " " + d).replace("Select", "") : (e + " " + a + " " + l + " " + i + ", " + o + " " + r + " " + d).replace("Select", ""), ElectrianAddressJson.push({ PostalAddressType: $("#JobElectricians_AddressID").val(), UnitType: $("#JobElectricians_UnitTypeID").val(), UnitNumber: $("#JobElectricians_UnitNumber").val(), StreetNumber: $("#JobElectricians_StreetNumber").val(), StreetName: $("#JobElectricians_StreetName").val(), StreetType: $("#JobElectricians_StreetTypeID").val(), Town: $("#JobElectricians_Town").val(), State: $("#JobElectricians_State").val(), PostCode: $("#JobElectricians_PostCode").val(), CompanyName: c, FirstName: u, LastName: b, Email: D, Phone: m, Mobile: p, LicenseNumber: v })) : (s + " " + n + ", " + o + " " + r + " " + d, ElectrianAddressJson.push({ PostalAddressType: $("#JobElectricians_AddressID").val(), PostalAddressID: $("#JobElectricians_PostalAddressID").val(), PostalDeliveryNumber: $("#JobElectricians_PostalDeliveryNumber").val(), Town: $("#JobElectricians_Town").val(), State: $("#JobElectricians_State").val(), PostCode: $("#JobElectricians_PostCode").val(), CompanyName: c, FirstName: u, LastName: b, Email: D, Phone: m, Mobile: p, LicenseNumber: v })), $("#txtBasicAddress").val($("#JobElectricians_FirstName").val() + " " + $("#JobElectricians_LastName").val()), $("#spantxtBasicAddress").hide(), $("#popupBasicAddress").modal("toggle"), electricianSignSRC = SRCSign } } function validateSoldBy() { if ("" != $("#BasicDetails_JobSoldByText").val()) { var e = $("#BasicDetails_JobSoldByText").val(); $("#BasicDetails_SoldBy").val(e), jsonvarSoldByDate = $("#BasicDetails_strSoldByDate").val(), jsonvarJobSoldBy = $("#BasicDetails_JobSoldByText").val(), $("#popupSoldBy").modal("toggle") } else $("#spanSoldBy").show().fadeOut(5e3) } function validateOwner() { if (addressOwnerValidationRules(), $("#JobOwner").valid()) { var e; if (OwnerAddressJson = [], "Government body" == $("#JobOwnerDetails_OwnerType").val() || "Corporate body" == $("#JobOwnerDetails_OwnerType").val() || "Trustee" == $("#JobOwnerDetails_OwnerType").val()) e = $("#JobOwnerDetails_CompanyName").val(); else e = $("#JobOwnerDetails_FirstName").val() + " " + $("#JobOwnerDetails_LastName").val(); $("#spantxtClientNames").hide(), $("#txtClientName").val(e), $("#popupOwner").modal("toggle"), 1 == $("#JobOwnerDetails_AddressID").val() ? OwnerAddressJson.push({ OwnerType: $("#JobOwnerDetails_OwnerType").val(), CompanyName: $("#JobOwnerDetails_CompanyName").val(), Phone: $("#JobOwnerDetails_Phone").val(), Mobile: $("#JobOwnerDetails_Mobile").val(), FirstName: $("#JobOwnerDetails_FirstName").val(), LastName: $("#JobOwnerDetails_LastName").val(), Email: $("#JobOwnerDetails_Email").val(), PostalAddressType: $("#JobOwnerDetails_AddressID").val(), UnitType: $("#JobOwnerDetails_UnitTypeID").val(), UnitNumber: $("#JobOwnerDetails_UnitNumber").val(), StreetNumber: $("#JobOwnerDetails_StreetNumber").val(), StreetName: $("#JobOwnerDetails_StreetName").val(), StreetType: $("#JobOwnerDetails_StreetTypeID").val(), Town: $("#JobOwnerDetails_Town").val(), State: $("#JobOwnerDetails_State").val(), PostCode: $("#JobOwnerDetails_PostCode").val() }) : OwnerAddressJson.push({ OwnerType: $("#JobOwnerDetails_OwnerType").val(), CompanyName: $("#JobOwnerDetails_CompanyName").val(), Phone: $("#JobOwnerDetails_Phone").val(), Mobile: $("#JobOwnerDetails_Mobile").val(), FirstName: $("#JobOwnerDetails_FirstName").val(), LastName: $("#JobOwnerDetails_LastName").val(), Email: $("#JobOwnerDetails_Email").val(), PostalAddressType: $("#JobOwnerDetails_AddressID").val(), PostalAddressID: $("#JobOwnerDetails_PostalAddressID").val(), PostalDeliveryNumber: $("#JobOwnerDetails_PostalDeliveryNumber").val(), Town: $("#JobOwnerDetails_Town").val(), State: $("#JobOwnerDetails_State").val(), PostCode: $("#JobOwnerDetails_PostCode").val() }), OwnerPostcodeFromjson = $("#JobOwnerDetails_PostCode").val(), OwnerEmailFromJson = $("#JobOwnerDetails_Email").val(), OwnerFirstNameFromJson = $("#JobOwnerDetails_FirstName").val(), OwnerLastNameFromJson = $("#JobOwnerDetails_LastName").val() } } function validateInstaller() { var e; (addressInstallerValidationRules(), $("#Installer").valid()) && (InstallerJson = [], e = $("#JobInstallerDetails_FirstName").val() + " " + $("#JobInstallerDetails_Surname").val(), $("#spantxtClientNames").hide(), $("#txtInstallerName").val(e), $("#popupInstaller").modal("toggle"), 1 == $("#JobInstallerDetails_AddressID").val() ? InstallerJson.push({ Phone: $("#JobInstallerDetails_Phone").val(), Mobile: $("#JobInstallerDetails_Mobile").val(), FirstName: $("#JobInstallerDetails_FirstName").val(), Surname: $("#JobInstallerDetails_Surname").val(), Email: $("#JobInstallerDetails_Email").val(), PostalAddressType: $("#JobInstallerDetails_AddressID").val(), UnitType: $("#JobInstallerDetails_UnitTypeID").val(), UnitNumber: $("#JobInstallerDetails_UnitNumber").val(), StreetNumber: $("#JobInstallerDetails_StreetNumber").val(), StreetName: $("#JobInstallerDetails_StreetName").val(), StreetType: $("#JobInstallerDetails_StreetTypeID").val(), Town: $("#JobInstallerDetails_Town").val(), State: $("#JobInstallerDetails_State").val(), PostCode: $("#JobInstallerDetails_PostCode").val(), SolarCompanyId: company_Id, SESignature: $("input[type='hidden'][name='Signature']").val(), ElectricianID: $("#JobInstallerDetails_ElectricianID").val() }) : InstallerJson.push({ Phone: $("#JobInstallerDetails_Phone").val(), Mobile: $("#JobInstallerDetails_Mobile").val(), FirstName: $("#JobInstallerDetails_FirstName").val(), Surname: $("#JobInstallerDetails_Surname").val(), Email: $("#JobInstallerDetails_Email").val(), PostalAddressType: $("#JobInstallerDetails_AddressID").val(), PostalAddressID: $("#JobInstallerDetails_PostalAddressID").val(), PostalDeliveryNumber: $("#JobInstallerDetails_PostalDeliveryNumber").val(), Town: $("#JobInstallerDetails_Town").val(), State: $("#JobInstallerDetails_State").val(), PostCode: $("#JobInstallerDetails_PostCode").val(), SolarCompanyId: company_Id, SESignature: $("input[type='hidden'][name='Signature']").val(), ElectricianID: $("#JobInstallerDetails_ElectricianID").val() }), InstallerEmailFromJson = $("#JobInstallerDetails_Email").val(), InstallerFirstNameFromJson = $("#JobInstallerDetails_FirstName").val(), InstallerLastNameFromJson = $("#JobInstallerDetails_Surname").val(), $("#JobInstallerDetails_SWHInstallerDesignerId").val($("#JobInstallerDetails_ElectricianID").val()), $("#JobInstallerDetails_SESignature").val($("input[type='hidden'][name='Signature']").val())) } function DeletePanelFromGrid(e) { confirm("Are you sure you want to delete this panel?") && (PanelXml = $.grep(PanelXml, function (t, a) { return t.ID.replace("action", "").trim() != e || ($("#JobSystemDetails_NoOfPanel").val(parseInt($("#JobSystemDetails_NoOfPanel").val()) - parseInt(t.Count)), document.getElementById("tblPanel").deleteRow(a), !1) }), 1 == $("#Paneldatatable tr").length && $("#gridPanel").hide()) } function DeleteInverterFromGrid(e) { confirm("Are you sure you want to delete this Inverter ?") && (InverterXml = $.grep(InverterXml, function (t, a) { return t.ID.replace("action", "").trim() != e || (document.getElementById("tblInverter").deleteRow(a), !1) }), 1 == $("#Inverterdatatable tr").length && $("#gridInverter").hide()) } function DeleteBatteryManufacturerFromGrid(e) { confirm("Are you sure you want to delete this Battery manufacturer?") && (batteryXml = $.grep(batteryXml, function (t, a) { return t.JobBatteryManufacturerId != e || (document.getElementById("tblBatteryManufacturer").deleteRow(a), !1) })) } function clearPopupInstallation() { $(".popupAddress").find("input[type=text]").each(function () { $(this).val(""), $(this).attr("class", "form-control valid") }), $(".popupAddress").find(".field-validation-error").attr("class", "field-validation-valid"), $("#JobInstallationDetails_UnitTypeID").val($("#JobInstallationDetails_UnitTypeID option:first").val()), $("#JobInstallationDetails_StreetTypeID").val($("#JobInstallationDetails_StreetTypeID option:first").val()), $("#JobInstallationDetails_PostalAddressID").val($("#JobInstallationDetails_PostalAddressID option:first").val()) } function clearPopupBasicAddress() { $(".popupBasicAddress").find("input[type=text]").each(function () { $(this).val(""), $(this).attr("class", "form-control valid") }), $(".popupBasicAddress").find(".field-validation-error").attr("class", "field-validation-valid"), $("#JobElectricians_UnitTypeID").val($("#JobElectricians_UnitTypeID option:first").val()), $("#JobElectricians_StreetTypeID").val($("#JobElectricians_StreetTypeID option:first").val()), $("#JobElectricians_PostalAddressID").val($("#JobElectricians_PostalAddressID option:first").val()) } function clearPopupOwner() { $(".popupOwner").find("input[type=text]").each(function () { $(this).val(""), $(this).attr("class", "form-control valid") }), $(".popupOwner").find(".field-validation-error").attr("class", "field-validation-valid"), $("#JobOwnerDetails_UnitTypeID").val($("#JobOwnerDetails_UnitTypeID option:first").val()), $("#JobOwnerDetails_StreetTypeID").val($("#JobOwnerDetails_StreetTypeID option:first").val()), $("#JobOwnerDetails_PostalAddressID").val($("#JobOwnerDetails_PostalAddressID option:first").val()) } function clearPopupInstaller() { $(".popupInstaller").find("input[type=text]").each(function () { $(this).val(""), $(this).attr("class", "form-control valid") }), $(".popupInstaller").find(".field-validation-error").attr("class", "field-validation-valid"), $("#JobInstallerDetails_UnitTypeID").val($("#JobOwnerDetails_UnitTypeID option:first").val()), $("#JobInstallerDetails_StreetTypeID").val($("#JobOwnerDetails_StreetTypeID option:first").val()), $("#JobInstallerDetails_PostalAddressID").val($("#JobOwnerDetails_PostalAddressID option:first").val()), $("#JobInstallerDetails_LicenseNumber").removeAttr("readonly"), $("#JobInstallerDetails_LicenseNumber").attr("onblur", "checkExistSWHInstaller(this,'InstallerDesigner LicenseNumber')"), $("#JobInstallerDetails_ElectricianID").val(""), $("#imgSWHSignatureInstaller").hide() } function deleteImageJob(e) { var t = Model_Guid, a = $("#imgSign").attr("class"), l = JobElectricians_Signature; confirm("Are you sure you want to delete this file ?") && $.ajax({ url: urlDeleteFileFromFolderAndElectrician, data: { fileName: a, FolderName: t, OldEleSign: l }, contentType: "application/json", method: "get", success: function () { $("#imgSign").attr("class"); return $("[name='Signature']").each(function () { $(this).remove() }), $("#imgSign").removeAttr("src"), $("#imgSign").removeAttr("class"), $("#popupbox").modal("hide"), $("#imgSignature").hide(), $(".alert").hide(), !1 } }) } function DeleteFileFromFolderAndElectrician(e, t, a) { $.ajax({ url: urlDeleteFileFromFolderAndElectrician, data: { fileName: e, FolderName: t, OldEleSign: a }, contentType: "application/json", method: "get", success: function (e) { } }) } function DeleteDocumentFolderOnCancel() { window.location.href = urlIndex } function DeleteJobs() { (selectedRows = [], jobDetail = { id: jobIDForScheduling, jobTitle: $("#BasicDetails_Title").val() }, selectedRows.push(jobDetail), null != selectedRows && selectedRows.length > 0) ? confirm("Are you sure you want to delete selected jobs ?") && $.ajax({ url: urlDeleteSelectedJobs, type: "POST", cache: !1, async: !0, data: JSON.stringify({ jobs: selectedRows }), dataType: "json", contentType: "application/json; charset=utf-8", success: function (e) { e.success ? window.location.href = "/Job/Index" : showErrorMessagesForStatus(e.JsonResponseObj.strErrors) } }) : alert("Please select any job for delete.") } function CheckShowErrorMessagesForPopup() { var e = !0, t = $("#JobSTCDetails_FailedAccreditationCode").val(), a = $("#JobSTCDetails_StatutoryDeclarations").val(), l = $("#txtAddress").val(), i = $("#txtClientName").val(); return "New" != $("#JobInstallationDetails_InstallingNewPanel").val() && "" != $("#JobInstallationDetails_InstallingNewPanel").val() && "" == $("#JobInstallationDetails_Location").val() ? ($("#spanInstallationLocation").show(), e = !1) : $("#spanInstallationLocation").hide(), "1" == JOBType && ("Yes" == $("#JobSTCDetails_MultipleSGUAddress").val() && "" == $("#JobSTCDetails_Location").val() ? ($("#spanSTCLocation").show(), e = !1) : $("#spanSTCLocation").hide()), "" == l.trim() || null == l || null == l ? ($("#spantxtAddress").show(), e = !1) : $("#spantxtAddress").hide(), "" == i.trim() || null == i || null == i ? ($("#spantxtClientNames").show(), e = !1) : $("#spantxtClientNames").hide(), "Yes" == $("#JobSTCDetails_CertificateCreated").val() && ("" != t.trim() && null != t && null != t || ($("#spanFailedAccreditationCode").show(), e = !1)), "Yes" == $("#JobSTCDetails_VolumetricCapacity").val() && ("Select" != a && null != a && null != a && "" != a.trim() || ($("#spanStatutoryDeclarations").show(), e = !1)), 1 == $("#BasicDetails_JobType").val() && parseFloat($("#JobSystemDetails_SystemSize").val()), e } function SerialNumbersValidation() { var e = !1, t = !1; if ("" != $("#JobSystemDetails_SerialNumbers").val().trim()) { for (var a = $("#JobSystemDetails_SerialNumbers").val().trim().split("\n"), l = ((a = a.filter(function (e) { return e.length > 0 })).length, 0); l < a.length; l++)if (a[l].length > 100) { e = !0; break } t = hasDuplicates(a) } return e ? $("#spanSerialNumbers").show().text("Serial numbers's maximum length  is of 100 characters.") : t ? $("#spanSerialNumbers").show().text("Serial numbers should not be same.") : $("#spanSerialNumbers").hide(), !e && !t } function hasDuplicates(e) { for (var t = [], a = 0; a < e.length; ++a) { var l = e[a]; if (-1 !== t.indexOf(l)) return !0; t.push(l) } return !1 } function editPanel(e) { $.each(PanelXml, function (t, a) { a.ID.replace("action", "").trim() == e && ($("#JobPanelDetails_Brand").val(a.Brand), $("#JobPanelDetails_Model").prop("disabled", !1), $("#JobPanelDetails_NoOfPanel").prop("disabled", !1), FillDropDown("JobPanelDetails_Model", urlGetPanelModel + a.Brand + "&JobType=1", a.Model, !0, null), $("#JobPanelDetails_NoOfPanel").val(a.Count), $("#btnEditPanel").show(), $("#btnAddPanel").hide(), $("#btnEditPanel").attr("name", e)) }) } function PanelEditAction(e) { var t = $("#JobPanelDetails_Brand").val(), a = $("#JobPanelDetails_Model").val(), l = $("#JobPanelDetails_NoOfPanel").val(), i = e.name; null != t && "" != t && null != a && "" != a && null != l && "" != l && 0 != l ? ($.each(PanelXml, function (e, s) { s.ID.replace("action", "").trim() == i && (s.Brand = t, s.Model = a, s.Count = l) }), $("#tblPanel tr").each(function () { $(this).find("td").eq(0).attr("class"), $(this).find("td").eq(1).attr("class"); var e = $(this).find("td").eq(2).attr("class"); $(this).find("td").eq(3).attr("class").replace("action", "").trim() == i && ($(this).find("td").eq(0).attr("class", $("#JobPanelDetails_Brand").val()), $(this).find("td").eq(0).text($("#JobPanelDetails_Brand").val()), $(this).find("td").eq(1).attr("class", $("#JobPanelDetails_Model").val()), $(this).find("td").eq(1).text($("#JobPanelDetails_Model").val()), $(this).find("td").eq(2).attr("class", $("#JobPanelDetails_NoOfPanel").val()), $(this).find("td").eq(2).text($("#JobPanelDetails_NoOfPanel").val()), $("#JobSystemDetails_NoOfPanel").val(parseInt($("#JobSystemDetails_NoOfPanel").val()) - e), $("#JobSystemDetails_NoOfPanel").val(parseInt($("#JobSystemDetails_NoOfPanel").val()) + parseInt($("#JobPanelDetails_NoOfPanel").val()))), $("#btnEditPanel").hide(), $("#btnAddPanel").show() })) : (null != t && "" != t.trim() || $("#spanJobPanelDetails_Brand").show().fadeOut(3e3), null != a && "" != a.trim() || $("#spanJobPanelDetails_Model").show().text("Panel Model  is required..").fadeOut(3e3), null != l && "" != l.trim() && 0 != l || $("#spanNoOfPanelValue").show().fadeOut(5e3)) } function editInverter(e) { $.each(InverterXml, function (t, a) { a.ID.replace("action", "").trim() == e && ($("#JobInverterDetails_Brand").val(a.Brand), $("#JobInverterDetails_Series").prop("disabled", !1), FillDropDown("JobInverterDetails_Series", urlGetInverterModel + a.Brand, a.Series, !0, null), $("#JobInverterDetails_Model").prop("disabled", !1), FillDropDown("JobInverterDetails_Model", urlGetInverterSeries + a.Series + "&Manufacturer=" + a.Brand, a.Model, !0, null), $("#btnEditInverter").show(), $("#btnAddInverter").hide(), $("#btnEditInverter").attr("name", e)) }) } function InverterEditAction(e) { var t = $("#JobInverterDetails_Brand").val(), a = $("#JobInverterDetails_Model").val(), l = $("#JobInverterDetails_Series").val(), i = e.name; null != t && "" != t && null != a && "" != a && null != l && "" != l ? ($.each(InverterXml, function (e, s) { s.ID.replace("action", "").trim() == i && (s.Brand = t, s.Model = a, s.Series = l) }), $("#tblInverter tr").each(function () { $(this).find("td").eq(0).attr("class"), $(this).find("td").eq(1).attr("class"), $(this).find("td").eq(2).attr("class"); $(this).find("td").eq(3).attr("class").replace("action", "").trim() == i && ($(this).find("td").eq(0).attr("class", t), $(this).find("td").eq(0).text(t), $(this).find("td").eq(1).attr("class", l), $(this).find("td").eq(1).text(l), $(this).find("td").eq(2).attr("class", a), $(this).find("td").eq(2).text(a)), $("#btnEditInverter").hide(), $("#btnAddInverter").show() })) : (null != t && "" != t.trim() || $("#spanJobInverterDetails_Brand").show().fadeOut(5e3), null != a && "" != a.trim() || $("#spanJobInverterDetails_Model").show().fadeOut(5e3), null != l && "" != l.trim() || $("#spanJobInverterDetails_Series").show().text("Inverter Series  is required.").fadeOut(5e3)) } function editBatteryManufacturer(e) { $.each(batteryXml, function (t, a) { a.JobBatteryManufacturerId == e && ($("#JobBatteryManufacturer_Manufacturer").val(a.Manufacturer), $("#JobBatteryManufacturer_ModelNumber").prop("disabled", !1), FillDropDown("JobBatteryManufacturer_ModelNumber", urlGetBatteryModel + a.Manufacturer, a.ModelNumber, !0, null), $("#btnEditBatteryManfacturer").show(), $("#btnAddBatteryManfacturer").hide(), $("#btnEditBatteryManfacturer").attr("name", e)) }) } function BatteryEditAction(e) { var t = $("#JobBatteryManufacturer_Manufacturer").val(), a = $("#JobBatteryManufacturer_ModelNumber").val(), l = e.name; null != t && "" != t && null != a && "" != a ? ($.each(batteryXml, function (e, i) { i.JobBatteryManufacturerId == l && (i.Manufacturer = t, i.ModelNumber = a) }), $("#tblBatteryManufacturer tr").each(function () { $(this).find("td").eq(2).attr("class") == l && ($(this).find("td").eq(0).attr("class", t), $(this).find("td").eq(0).text(t), $(this).find("td").eq(1).attr("class", a), $(this).find("td").eq(1).text(a)), $("#btnEditBatteryManfacturer").hide(), $("#btnAddBatteryManfacturer").show() })) : (null != t && "" != t.trim() || $("#spanJobBatteryManufacturer").show(), null != a && "" != a.trim() || $("#spanJobBatteryModelNumber").show()) } function fillElectrianPopup() { if (ElectrianAddressJson.length > 0) { var e = ElectrianAddressJson[0].PostalAddressType; $("#JobElectricians_AddressID").val(e), 1 == e ? ($("#JobElectricians_UnitTypeID").val(ElectrianAddressJson[0].UnitType), $("#JobElectricians_UnitNumber").val(ElectrianAddressJson[0].UnitNumber), $("#JobElectricians_StreetNumber").val(ElectrianAddressJson[0].StreetNumber), $("#JobElectricians_StreetName").val(ElectrianAddressJson[0].StreetName), $("#JobElectricians_StreetTypeID").val(ElectrianAddressJson[0].StreetType), $("#JobElectricians_PostalAddressID").val(""), $("#JobElectricians_PostalDeliveryNumber").val("")) : ($("#JobElectricians_PostalAddressID").val(ElectrianAddressJson[0].PostalAddressID), $("#JobElectricians_PostalDeliveryNumber").val(ElectrianAddressJson[0].PostalDeliveryNumber), $("#JobElectricians_UnitTypeID").val(""), $("#JobElectricians_UnitNumber").val(""), $("#JobElectricians_StreetNumber").val(""), $("#JobElectricians_StreetName").val(""), $("#JobElectricians_StreetTypeID").val("")), $("#JobElectricians_Town").val(ElectrianAddressJson[0].Town), $("#JobElectricians_State").val(ElectrianAddressJson[0].State), $("#JobElectricians_PostCode").val(ElectrianAddressJson[0].PostCode), $("#JobElectricians_CompanyName").val(ElectrianAddressJson[0].CompanyName), $("#JobElectricians_FirstName").val(ElectrianAddressJson[0].FirstName), $("#JobElectricians_LastName").val(ElectrianAddressJson[0].LastName), $("#JobElectricians_Email").val(ElectrianAddressJson[0].Email), $("#JobElectricians_Phone").val(ElectrianAddressJson[0].Phone), $("#JobElectricians_Mobile").val(ElectrianAddressJson[0].Mobile), $("#JobElectricians_LicenseNumber").val(ElectrianAddressJson[0].LicenseNumber) } else $("#JobElectricians_AddressID").val(1), $("#JobElectricians_UnitTypeID").val(""), $("#JobElectricians_UnitNumber").val(""), $("#JobElectricians_StreetNumber").val(""), $("#JobElectricians_StreetName").val(""), $("#JobElectricians_StreetTypeID").val(""), $("#JobElectricians_Town").val(""), $("#JobElectricians_State").val(""), $("#JobElectricians_PostCode").val(""), $("#JobElectricians_PostalAddressID").val(""), $("#JobElectricians_PostalDeliveryNumber").val(""), $("#JobElectricians_CompanyName").val(""), $("#JobElectricians_FirstName").val(""), $("#JobElectricians_LastName").val(""), $("#JobElectricians_Email").val(""), $("#JobElectricians_Phone").val(""), $("#JobElectricians_Mobile").val(""), $("#JobElectricians_LicenseNumber").val(""), $(".ElectriciansDPA").show(), $(".ElectriciansPDA").hide() } function fillInstallationPopup() { if (InstallationJson.length > 0) { var e = InstallationJson[0].PostalAddressType; $("#JobInstallationDetails_AddressID").val(e), 1 == e ? ($("#JobInstallationDetails_UnitTypeID").val(InstallationJson[0].UnitType), $("#JobInstallationDetails_UnitNumber").val(InstallationJson[0].UnitNumber), $("#JobInstallationDetails_StreetNumber").val(InstallationJson[0].StreetNumber), $("#JobInstallationDetails_StreetName").val(InstallationJson[0].StreetName), $("#JobInstallationDetails_StreetTypeID").val(InstallationJson[0].StreetType), $("#JobInstallationDetails_PostalAddressID").val(""), $("#JobInstallationDetails_PostalDeliveryNumber").val("")) : ($("#JobInstallationDetails_PostalAddressID").val(InstallationJson[0].PostalAddressID), $("#JobInstallationDetails_PostalDeliveryNumber").val(InstallationJson[0].PostalDeliveryNumber), $("#JobInstallationDetails_UnitTypeID").val(""), $("#JobInstallationDetails_UnitNumber").val(""), $("#JobInstallationDetails_StreetNumber").val(""), $("#JobInstallationDetails_StreetName").val(""), $("#JobInstallationDetails_StreetTypeID").val("")), $("#JobInstallationDetails_Town").val(InstallationJson[0].Town), $("#JobInstallationDetails_State").val(InstallationJson[0].State), $("#JobInstallationDetails_PostCode").val(InstallationJson[0].PostCode) } else $("#JobInstallationDetails_AddressID").val(1), $("#JobInstallationDetails_UnitTypeID").val(""), $("#JobInstallationDetails_UnitNumber").val(""), $("#JobInstallationDetails_StreetNumber").val(""), $("#JobInstallationDetails_StreetName").val(""), $("#JobInstallationDetails_StreetTypeID").val(""), $("#JobInstallationDetails_Town").val(""), $("#JobInstallationDetails_State").val(""), $("#JobInstallationDetails_PostCode").val(""), $("#JobInstallationDetails_PostalAddressID").val(""), $("#JobInstallationDetails_PostalDeliveryNumber").val(""), $("#JobInstallationDetails_IsSameAsOwnerAddress").prop("checked", !1), $(".InstallationDPA").show(), $(".InstallationPDA").hide() } function fillOwnerPopup() { if (OwnerAddressJson.length > 0) { var e = OwnerAddressJson[0].PostalAddressType; $("#JobOwnerDetails_AddressID").val(e), 1 == e ? ($("#JobOwnerDetails_UnitTypeID").val(OwnerAddressJson[0].UnitType), $("#JobOwnerDetails_UnitNumber").val(OwnerAddressJson[0].UnitNumber), $("#JobOwnerDetails_StreetNumber").val(OwnerAddressJson[0].StreetNumber), $("#JobOwnerDetails_StreetName").val(OwnerAddressJson[0].StreetName), $("#JobOwnerDetails_StreetTypeID").val(OwnerAddressJson[0].StreetType), $("#JobOwnerDetails_PostalAddressID").val(""), $("#JobOwnerDetails_PostalDeliveryNumber").val("")) : ($("#JobOwnerDetails_PostalAddressID").val(OwnerAddressJson[0].PostalAddressID), $("#JobOwnerDetails_PostalDeliveryNumber").val(OwnerAddressJson[0].PostalDeliveryNumber), $("#JobOwnerDetails_UnitTypeID").val(""), $("#JobOwnerDetails_UnitNumber").val(""), $("#JobOwnerDetails_StreetNumber").val(""), $("#JobOwnerDetails_StreetName").val(""), $("#JobOwnerDetails_StreetTypeID").val("")), $("#JobOwnerDetails_CompanyName").val(OwnerAddressJson[0].CompanyName), $("#JobOwnerDetails_FirstName").val(OwnerAddressJson[0].FirstName), $("#JobOwnerDetails_LastName").val(OwnerAddressJson[0].LastName), $("#JobOwnerDetails_Email").val(OwnerAddressJson[0].Email), $("#JobOwnerDetails_Mobile").val(OwnerAddressJson[0].Mobile), $("#JobOwnerDetails_Phone").val(OwnerAddressJson[0].Phone), $("#JobOwnerDetails_Town").val(OwnerAddressJson[0].Town), $("#JobOwnerDetails_State").val(OwnerAddressJson[0].State), $("#JobOwnerDetails_PostCode").val(OwnerAddressJson[0].PostCode) } else $("#JobOwnerDetails_AddressID").val(1), $("#JobOwnerDetails_UnitTypeID").val(""), $("#JobOwnerDetails_UnitNumber").val(""), $("#JobOwnerDetails_StreetNumber").val(""), $("#JobOwnerDetails_StreetName").val(""), $("#JobOwnerDetails_StreetTypeID").val(""), $("#JobOwnerDetails_Town").val(""), $("#JobOwnerDetails_State").val(""), $("#JobOwnerDetails_PostCode").val(""), $("#JobOwnerDetails_PostalAddressID").val(""), $("#JobOwnerDetails_PostalDeliveryNumber").val(""), $("#JobOwnerDetails_CompanyName").val(""), $("#JobOwnerDetails_FirstName").val(""), $("#JobOwnerDetails_LastName").val(""), $("#JobOwnerDetails_Email").val(""), $("#JobOwnerDetails_Mobile").val(""), $("#JobOwnerDetails_Phone").val(""), $(".OwnerDPA").show(), $(".OwnerPDA").hide() } function fillInstallerPopup() { if (InstallerJson.length > 0) { var e = InstallerJson[0].PostalAddressType; $("#JobInstallerDetails_AddressID").val(e), 1 == e ? ($("#JobInstallerDetails_UnitTypeID").val(InstallerJson[0].UnitType), $("#JobInstallerDetails_UnitNumber").val(InstallerJson[0].UnitNumber), $("#JobInstallerDetails_StreetNumber").val(InstallerJson[0].StreetNumber), $("#JobInstallerDetails_StreetName").val(InstallerJson[0].StreetName), $("#JobInstallerDetails_StreetTypeID").val(InstallerJson[0].StreetType), $("#JobInstallerDetails_PostalAddressID").val(""), $("#JobInstallerDetails_PostalDeliveryNumber").val("")) : ($("#JobInstallerDetails_PostalAddressID").val(InstallerJson[0].PostalAddressID), $("#JobInstallerDetails_PostalDeliveryNumber").val(InstallerJson[0].PostalDeliveryNumber), $("#JobInstallerDetails_UnitTypeID").val(""), $("#JobInstallerDetails_UnitNumber").val(""), $("#JobInstallerDetails_StreetNumber").val(""), $("#JobInstallerDetails_StreetName").val(""), $("#JobInstallerDetails_StreetTypeID").val("")), $("#JobInstallerDetails_FirstName").val(InstallerJson[0].FirstName), $("#JobInstallerDetails_Surname").val(InstallerJson[0].Surname), $("#JobInstallerDetails_Email").val(InstallerJson[0].Email), $("#JobInstallerDetails_Mobile").val(InstallerJson[0].Mobile), $("#JobInstallerDetails_Phone").val(InstallerJson[0].Phone), $("#JobInstallerDetails_Town").val(InstallerJson[0].Town), $("#JobInstallerDetails_State").val(InstallerJson[0].State), $("#JobInstallerDetails_PostCode").val(InstallerJson[0].PostCode), $("#JobInstallerDetails_ElectricianID").val(InstallerJson[0].ElectricianID), $("#JobInstallerDetails_SolarCompanyId").val(InstallerJson[0].SolarCompanyId), $("#JobInstallerDetails_SESignature").val(InstallerJson[0].SESignature) } else $("#JobInstallerDetails_AddressID").val(1), $("#JobInstallerDetails_UnitTypeID").val(""), $("#JobInstallerDetails_UnitNumber").val(""), $("#JobInstallerDetails_StreetNumber").val(""), $("#JobInstallerDetails_StreetName").val(""), $("#JobInstallerDetails_StreetTypeID").val(""), $("#JobInstallerDetails_Town").val(""), $("#JobInstallerDetails_State").val(""), $("#JobInstallerDetails_PostCode").val(""), $("#JobInstallerDetails_PostalAddressID").val(""), $("#JobInstallerDetails_PostalDeliveryNumber").val(""), $("#JobInstallerDetails_FirstName").val(""), $("#JobInstallerDetails_Surname").val(""), $("#JobInstallerDetails_Email").val(""), $("#JobInstallerDetails_Mobile").val(""), $("#JobInstallerDetails_Phone").val(""), $(".InstallerDPA").show(), $(".InstallerPDA").hide() } function EnableDropDownbyUsertype() { "1" == JOBType && (8 == USERType && "True" == IsUnderSSC && ($("#JobInstallationDetails_ExistingSystem").removeAttr("disabled"), $("#JobOwner").find("Select").each(function () { $(this).removeAttr("disabled") }), $("#JobInstallationAddress").find("Select").each(function () { $(this).removeAttr("disabled") }), $("#frmCreateJob").find("Select").each(function () { $(this).removeAttr("disabled") }), $("#BasicDetails_strInstallationDate").removeAttr("disabled")), 7 != USERType && 9 != USERType || ($("#JobInstallationDetails_ExistingSystem").removeAttr("disabled"), $("#JobElectricians").find("Select").each(function () { $(this).removeAttr("disabled") }), $("#JobOwner").find("Select").each(function () { $(this).removeAttr("disabled") }), $("#JobInstallationAddress").find("Select").each(function () { $(this).removeAttr("disabled") }), $("#frmCreateJob").find("Select").each(function () { $(this).removeAttr("disabled") })), 2 != USERType && 5 != USERType || ($("#JobInstallationDetails_ExistingSystem").removeAttr("disabled"), $("#JobElectricians").find("Select").each(function () { $(this).removeAttr("disabled") }), $("#JobOwner").find("Select").each(function () { $(this).removeAttr("disabled") }), $("#JobInstallationAddress").find("Select").each(function () { $(this).removeAttr("disabled") }), $("#frmCreateJob").find("Select").each(function () { $(this).removeAttr("disabled") }), $("#BasicDetails_strInstallationDate").removeAttr("disabled"))), "2" == JOBType && ((7 == USERType || 9 == USERType || 8 == USERType && "True" == IsUnderSSC) && ($("#JobInstallationDetails_ExistingSystem").removeAttr("disabled"), $("#JobElectricians").find("Select").each(function () { $(this).removeAttr("disabled") }), $("#JobOwner").find("Select").each(function () { $(this).removeAttr("disabled") }), $("#JobInstallationAddress").find("Select").each(function () { $(this).removeAttr("disabled") }), $("#frmCreateJob").find("Select").each(function () { $(this).removeAttr("disabled") }), $("#BasicDetails_strInstallationDate").removeAttr("disabled")), 2 != USERType && 5 != USERType || ($("#JobInstallationDetails_ExistingSystem").removeAttr("disabled"), $("#JobElectricians").find("Select").each(function () { $(this).removeAttr("disabled") }), $("#JobOwner").find("Select").each(function () { $(this).removeAttr("disabled") }), $("#JobInstallationAddress").find("Select").each(function () { $(this).removeAttr("disabled") }), $("#Installer").find("Select").each(function () { $(this).removeAttr("disabled") }), $("#frmCreateJob").find("Select").each(function () { $(this).removeAttr("disabled") }), $("#BasicDetails_strInstallationDate").removeAttr("disabled"))) } function DisableDropDownbyUsertype() { BasicDetails_JobID > 0 && $("#BasicDetails_JobType").attr("disabled", "disabled"), "1" == JOBType && (8 == USERType && "True" == IsUnderSSC && ($("#JobOwner").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#JobInstallationAddress").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#frmCreateJob").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#BasicDetails_strInstallationDate").attr("disabled", "disabled")), 7 != USERType && 9 != USERType || ($("#JobElectricians").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#JobOwner").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#JobInstallationAddress").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#frmCreateJob").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#BasicDetails_JobStage").removeAttr("disabled")), 2 != USERType && 5 != USERType || ($("#JobElectricians").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#JobOwner").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#JobInstallationAddress").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#frmCreateJob").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#BasicDetails_strInstallationDate").attr("disabled", "disabled"))), "2" == JOBType && ((7 == USERType || 9 == USERType || 8 == USERType && "True" == IsUnderSSC) && ($("#JobElectricians").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#JobOwner").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#JobInstallationAddress").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#frmCreateJob").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#BasicDetails_strInstallationDate").attr("disabled", "disabled"), $("#BasicDetails_JobStage").removeAttr("disabled")), 2 != USERType && 5 != USERType || ($("#JobElectricians").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#JobOwner").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#JobInstallationAddress").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#Installer").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#frmCreateJob").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#BasicDetails_strInstallationDate").attr("disabled", "disabled"))) } function CalculateStc1() { $("#JobSystemDetails_CalculatedSTC").val(""), $("#JobSystemDetails_CalculatedSTCForSWH").val(); var e = $("#BasicDetails_JobType").val(), t = $("#JobSystemDetails_SystemSize").val(), a = $("#BasicDetails_strInstallationDate").val(), l = ""; if (null != a && null != a && "" != a) { var i = ConvertDateToTick(a, GetDateFormat); l = moment(i).format("YYYY-MM-DD") } var s = $("#JobSTCDetails_DeemingPeriod").val(), n = InstallationPostcodeFromjson, o = $("#JobSystemDetails_SystemBrand").val(), r = $("#JobSystemDetails_SystemModel").val(); 1 == e ? null != l && "" != l && null != s && "" != s && null != n && "" != n && null != t && "" != t ? $.ajax({ url: urlCalculateSTC, data: { sguType: "SolarDeemed", expectedInstallDate: l, deemingPeriod: s, postcode: n, systemsize: t }, contentType: "application/json", method: "get", success: function (e) { var t = JSON.parse(e); if ("Failed" == t.status) $("#spanJobSystemDetails_CalculatedSTC").show().text(t.fieldErrors[0].defaultMessage); else { var a = t.result.numberOfStcs; $("#JobSystemDetails_CalculatedSTC").val(a) } } }) : $("#spanJobSystemDetails_CalculatedSTC").show().text("Installation Date, STC DeemingPeriod,Installation postcode and System size are required for it.").fadeOut(6e3) : 2 == e ? null != l && "" != l && null != l && null != n && "" != n && null != n && null != o && "" != o && null != r && "" != r ? $.ajax({ url: urlCalculateSWHST, data: { expectedInstallDate: l, postcode: n, systemBrand: o, systemModel: r }, contentType: "application/json", method: "get", success: function (e) { var t = JSON.parse(e); if ("Failed" == t.status) $("#spanJobSystemDetails_CalculatedSTCForSWH").show().text(t.errors[0]); else { var a = t.result.numStc; $("#JobSystemDetails_CalculatedSTCForSWH").val(a) } } }) : $("#spanJobSystemDetails_CalculatedSTCForSWH").show().text("Installation Date,System brand,System Model,Owner postcode are required for it.") : ($("#spanJobSystemDetails_CalculatedSTC").show().text("Please select Job Type.").fadeOut(6e3), $("#spanJobSystemDetails_CalculatedSTCForSWH").show().text("Please select Job Type.").fadeOut(6e3)) } function CheckStatusAndInstallationDate() { var e = $("#BasicDetails_InstallerID").val(), t = $("#BasicDetails_DesignerID").val(), a = $("#BasicDetails_strInstallationDate").val(); if ("" != t && null != t && null != t || (t = "0"), "" != e && null != e && null != e || (e = "0"), 0 == e && 0 == t || 1 != $("#BasicDetails_JobType").val()) return !0; var l = !0; return $.ajax({ url: urlCheckStatusAndInstallationDate, data: { InstallerId: e, DesignerId: t }, contentType: "application/json", method: "get", async: !1, success: function (e) { var t = JSON.parse(e); for (i = 0; i < t.length; i++) { var s = t[i].InstallerStatus, n = t[i].InstallerExpiryDate, o = t[i].SuspensionStartDate, r = t[i].SuspensionEndDate; if (null != a) { var d = ConvertDateToTick(a, GetDateFormat); a = moment(d).format("YYYY-MM-DD") } if (null != n && (n = moment(n).format("YYYY-MM-DD")), null != o && (o = moment(o).format("YYYY-MM-DD")), null != o && (o = moment(o).format("YYYY-MM-DD")), "Deferred" == s) { showErrorMessagesForStatus("The account is Deferred."), l = !1; break } if ("Cancelled" == s) { showErrorMessagesForStatus("The account is Cancelled."), l = !1; break } if ("Suspended" == s) { if (null == a || "" == a || null == a) { showErrorMessagesForStatus("The account is suspended."), l = !1; break } if (o < a < r) { showErrorMessagesForStatus("The account is suspended."), l = !1; break } if (!(n < a)) { showErrorMessagesForStatus("The account is expired."), l = !1; break } l = !0 } if ("Expired" == s) { if (null == a || "" == a || null == a) { showErrorMessagesForStatus("The S.E account is expired."), l = !1; break } if (!(n < a)) { showErrorMessagesForStatus("The S.E account is expired"), l = !1; break } l = !0 } if ("Current" == s) if (null != a && "" != a && null != a) { if (o < a < r) { showErrorMessagesForStatus("The account is suspended."), l = !1; break } if (!(n < a)) { showErrorMessagesForStatus("The account is expired."), l = !1; break } l = !0 } else l = !0 } }, error: function () { l = !0 } }), l } function FillDropDownInstaller(e, t, a, l, i, s) { $.ajax({ url: t, contentType: "application/json", dataType: "json", method: "get", cache: !1, success: function (t) { var n = ""; 1 == l && (null != s && null != s || (s = "Select"), n = "<option value=''>" + s + "</option>"), $.each(t, function (e, t) { t.Text.indexOf("(Current)") >= 0 ? n += '<option value = "' + t.Value + '" style="color:green" >' + t.Text + "</option>" : t.Text.indexOf("(") >= 0 && t.Text.indexOf("(Current)") < 0 ? n += '<option value = "' + t.Value + '"  style="color:red">' + t.Text + "</option>" : n += '<option value = "' + t.Value + '"  >' + t.Text + "</option>" }), $("#" + e).html(n), a && "" != a && 0 != a && $("#" + e).val(a), $("#" + e).attr("selval") && $("#" + e).attr("selval") > 0 && $("#" + e).val($("#" + e).attr("selval")), null != $("#" + e).selectpicker && $("#" + e).selectpicker("refresh"), null != i && i() } }) } function showSuccessMessages(e) { $(".alert").hide(), $("#successMsgRegion").html(closeButton + e), $("#successMsgRegion").show(), $("html").animate({ scrollTop: 0 }, "slow"), $("body").animate({ scrollTop: 0 }, "slow") } function showErrorMessagesForStatus(e) { $(".alert").hide(), $("#errorMsgRegion").html(closeButton + e), $("#errorMsgRegion").show(), $("html").animate({ scrollTop: 0 }, "slow"), $("body").animate({ scrollTop: 0 }, "slow") } function addressElectricianValidationRules() { $("#JobElectricians_UnitTypeID").rules("add", { required: !1 }), $("#JobElectricians_UnitNumber").rules("add", { required: !1 }), "" == $("#JobElectricians_UnitTypeID").val() && "" == $("#JobElectricians_UnitNumber").val() && ($("#lblElectriciansUnitNumber").removeClass("required"), $("#lblElectriciansUnitTypeID").removeClass("required"), $("#JobElectricians_UnitNumber").rules("add", { required: !1 }), $("#JobElectricians_UnitTypeID").rules("add", { required: !1 }), $("#lblElectriciansStreetNumber").addClass("required"), $("#JobElectricians_StreetNumber").rules("add", { required: !0, messages: { required: "Street Number is required." } })), $("#JobElectricians_UnitTypeID").val() > 0 && "" != $("#JobElectricians_UnitNumber").val() && ($("#lblElectriciansStreetNumber").removeClass("required"), $("#JobElectricians_StreetNumber").rules("add", { required: !1 }), $("#lblElectriciansUnitNumber").removeClass("required"), $("#lblElectriciansUnitTypeID").removeClass("required"), $("#JobElectricians_UnitNumber").rules("add", { required: !1 }), $("#JobElectricians_UnitTypeID").rules("add", { required: !1 })), $("#JobElectricians_UnitTypeID").val() > 0 && "" == $("#JobElectricians_UnitNumber").val() && ($("#JobElectricians_UnitNumber").rules("add", { required: !0, messages: { required: "Unit Number is required." } }), $("#lblElectriciansUnitNumber").addClass("required"), $("#lblElectriciansStreetNumber").removeClass("required"), $("#JobElectricians_StreetNumber").rules("add", { required: !1 })), "" == $("#JobElectricians_UnitTypeID").val() && "" != $("#JobElectricians_UnitNumber").val() && ($("#lblElectriciansUnitNumber").addClass("required"), $("#lblElectriciansUnitTypeID").removeClass("required"), $("#JobElectricians_UnitNumber").rules("add", { required: !1 }), $("#JobElectricians_UnitTypeID").rules("add", { required: !1 }), $("#lblElectriciansStreetNumber").addClass("required"), $("#JobElectricians_StreetNumber").rules("add", { required: !0, messages: { required: "Street Number is required." } })) } function addressOwnerValidationRules() { $("#JobOwnerDetails_UnitTypeID").rules("add", { required: !1 }), $("#JobOwnerDetails_UnitNumber").rules("add", { required: !1 }), "" == $("#JobOwnerDetails_UnitTypeID").val() && "" == $("#JobOwnerDetails_UnitNumber").val() && ($("#lblOwnerUnitNumber").removeClass("required"), $("#lblOwnerUnitTypeID").removeClass("required"), $("#JobOwnerDetails_UnitNumber").rules("add", { required: !1 }), $("#JobOwnerDetails_UnitTypeID").rules("add", { required: !1 }), $("#lblOwnerStreetNumber").addClass("required"), $("#JobOwnerDetails_StreetNumber").rules("add", { required: !0, messages: { required: "Street Number is required." } })), $("#JobOwnerDetails_UnitTypeID").val() > 0 && "" != $("#JobOwnerDetails_UnitNumber").val() && ($("#lblOwnerStreetNumber").removeClass("required"), $("#JobOwnerDetails_StreetNumber").rules("add", { required: !1 }), $("#lblOwnerUnitNumber").removeClass("required"), $("#lblOwnerUnitTypeID").removeClass("required"), $("#JobOwnerDetails_UnitNumber").rules("add", { required: !1 }), $("#JobOwnerDetails_UnitTypeID").rules("add", { required: !1 })), $("#JobOwnerDetails_UnitTypeID").val() > 0 && "" == $("#JobOwnerDetails_UnitNumber").val() && ($("#JobOwnerDetails_UnitNumber").rules("add", { required: !0, messages: { required: "Unit Number is required." } }), $("#lblOwnerUnitNumber").addClass("required"), $("#lblOwnerStreetNumber").removeClass("required"), $("#JobOwnerDetails_StreetNumber").rules("add", { required: !1 })), "" == $("#JobOwnerDetails_UnitTypeID").val() && "" != $("#JobOwnerDetails_UnitNumber").val() && ($("#lblOwnerUnitNumber").addClass("required"), $("#lblOwnerUnitTypeID").removeClass("required"), $("#JobOwnerDetails_UnitNumber").rules("add", { required: !1 }), $("#JobOwnerDetails_UnitTypeID").rules("add", { required: !1 }), $("#lblOwnerStreetNumber").addClass("required"), $("#JobOwnerDetails_StreetNumber").rules("add", { required: !0, messages: { required: "Street Number is required." } })) } function addressInstallationValidationRules() { $("#JobInstallationDetails_UnitTypeID").rules("add", { required: !1 }), $("#JobInstallationDetails_UnitNumber").rules("add", { required: !1 }), "" == $("#JobInstallationDetails_UnitTypeID").val() && "" == $("#JobInstallationDetails_UnitNumber").val() && ($("#lblInstallationUnitNumber").removeClass("required"), $("#lblInstallationUnitTypeID").removeClass("required"), $("#JobInstallationDetails_UnitNumber").rules("add", { required: !1 }), $("#JobInstallationDetails_UnitTypeID").rules("add", { required: !1 })), $("#JobInstallationDetails_UnitTypeID").val() > 0 && "" != $("#JobInstallationDetails_UnitNumber").val() && ($("#lblInstallationUnitNumber").removeClass("required"), $("#lblInstallationUnitTypeID").removeClass("required"), $("#JobInstallationDetails_UnitNumber").rules("add", { required: !1 }), $("#JobInstallationDetails_UnitTypeID").rules("add", { required: !1 })), $("#JobInstallationDetails_UnitTypeID").val() > 0 && "" == $("#JobInstallationDetails_UnitNumber").val() && ($("#JobInstallationDetails_UnitNumber").rules("add", { required: !0, messages: { required: "Unit Number is required." } }), $("#lblInstallationUnitNumber").addClass("required")), "" == $("#JobInstallationDetails_UnitTypeID").val() && "" != $("#JobInstallationDetails_UnitNumber").val() && ($("#lblInstallationUnitNumber").addClass("required"), $("#lblInstallationUnitTypeID").removeClass("required"), $("#JobInstallationDetails_UnitNumber").rules("add", { required: !1 }), $("#JobInstallationDetails_UnitTypeID").rules("add", { required: !1 })) } function addressInstallerValidationRules() { $("#JobInstallerDetails_UnitTypeID").rules("add", { required: !1 }), $("#JobInstallerDetails_UnitNumber").rules("add", { required: !1 }), "" == $("#JobInstallerDetails_UnitTypeID").val() && "" == $("#JobInstallerDetails_UnitNumber").val() && ($("#lblInstallerUnitNumber").removeClass("required"), $("#lblInstallerUnitTypeID").removeClass("required"), $("#JobInstallerDetails_UnitNumber").rules("add", { required: !1 }), $("#JobInstallerDetails_UnitTypeID").rules("add", { required: !1 }), $("#lblInstallerStreetNumber").addClass("required"), $("#JobInstallerDetails_StreetNumber").rules("add", { required: !0, messages: { required: "Street Number is required." } })), $("#JobInstallerDetails_UnitTypeID").val() > 0 && "" != $("#JobInstallerDetails_UnitNumber").val() && ($("#lblInstallerStreetNumber").removeClass("required"), $("#JobInstallerDetails_StreetNumber").rules("add", { required: !1 }), $("#lblInstallerUnitNumber").removeClass("required"), $("#lblInstallerUnitTypeID").removeClass("required"), $("#JobInstallerDetails_UnitNumber").rules("add", { required: !1 }), $("#JobInstallerDetails_UnitTypeID").rules("add", { required: !1 })), $("#JobInstallerDetails_UnitTypeID").val() > 0 && "" == $("#JobInstallerDetails_UnitNumber").val() && ($("#JobInstallerDetails_UnitNumber").rules("add", { required: !0, messages: { required: "Unit Number is required." } }), $("#lblInstallerUnitNumber").addClass("required"), $("#lblInstallerStreetNumber").removeClass("required"), $("#JobInstallerDetails_StreetNumber").rules("add", { required: !1 })), "" == $("#JobInstallerDetails_UnitTypeID").val() && "" != $("#JobInstallerDetails_UnitNumber").val() && ($("#lblInstallerUnitNumber").addClass("required"), $("#lblInstallerUnitTypeID").removeClass("required"), $("#JobInstallerDetails_UnitNumber").rules("add", { required: !1 }), $("#JobInstallerDetails_UnitTypeID").rules("add", { required: !1 }), $("#lblInstallerStreetNumber").addClass("required"), $("#JobInstallerDetails_StreetNumber").rules("add", { required: !0, messages: { required: "Street Number is required." } })) } function checkBusinessRules(e, t) { "" != $("#SSCID").val() && $("#SSCID").val() > 0 && $("#BasicDetails_SSCID").val($("#SSCID").val()), "" != $("#ScoID").val() && $("#ScoID").val() > 0 && $("#BasicDetails_ScoID").val($("#ScoID").val()), EnableDropDownbyUsertype(), $("#BasicDetails_JobType").removeAttr("disabled"); var a = "", l = "", i = []; if (i = JSON.parse(JSON.stringify(batteryXml)), PanelXml.length > 0) { var s = JSON.stringify(PanelXml), n = "", o = $.parseJSON(s); $.each(o, function () { n += "<panel><Brand>" + this.Brand + "</Brand><Model>" + this.Model + "</Model><NoOfPanel>" + this.Count + "</NoOfPanel></panel>" }), a = "<Panels>" + n + "</Panels>" } if (InverterXml.length > 0) { s = JSON.stringify(InverterXml), n = "", o = $.parseJSON(s); $.each(o, function () { n += "<inverter><Brand>" + htmlEncode(this.Brand) + "</Brand><Model>" + htmlEncode(this.Model) + "</Model><Series>" + htmlEncode(this.Series) + "</Series></inverter>" }), l = "<Inverters>" + n + "</Inverters>" } $("#panelXml").val(a), $("#inverterXml").val(l); var r = JSON.stringify($("form").serializeToJson()), d = JSON.parse(r); if (d.JobSTCDetails.batterySystemPartOfAnAggregatedControl = $("#JobSTCDetails_batterySystemPartOfAnAggregatedControl").val(), d.JobSTCDetails.changedSettingOfBatteryStorageSystem = $("#JobSTCDetails_changedSettingOfBatteryStorageSystem").val(), i.length > 0) { for (var c = 0; c < i.length; c++)delete i[c].JobBatteryManufacturerId; d.lstJobBatteryManufacturer = i } r = JSON.stringify(d); JSON.stringify($("#frmCreateJob").serializeToJson()); $.ajax({ url: urlCheckBusinessRules, type: "POST", dataType: "json", contentType: "application/json; charset=utf-8", processData: !1, data: r, cache: !1, async: !0, success: function (a) { a.IsSuccess ? (null != a.STCStatusName && null != a.STCStatusName && "" != a.STCStatusName && $("#spanSTCStatus").text(a.STCStatusName.trim()), null != a.STCDescription && null != a.STCDescription && "" != a.STCDescription && $("#STCDescription").html(a.STCDescription.trim()), null != a.STCStatusId && null != a.STCStatusId && "" != a.STCStatusId && $("#STCStatusId").val(a.STCStatusId.trim()), null != a.ValidationSummary && null != a.ValidationSummary && "" != a.ValidationSummary ? t ? 1 != ProjectSession_UserTypeId ? ($(".STCmodelBodyMessage").html(""), $(".STCmodelBodyMessage").append(a.ValidationSummary), $("#STCwarning").modal(), "true" == a.IsEMailNotification.toString().toLowerCase() && $.ajax({ url: urlSendMailForDuplicateAddress, method: "GET", data: { jobid: $("#BasicDetails_JobID").val(), mailList: a.EMailList.trim().toString().toLowerCase() }, cache: !1, async: !0, success: function (e) { } })) : LoadStc() : ($(".modelBodyMessage").html(""), $(".modelBodyMessage").append(a.ValidationSummary), $("#warning").modal()) : t ? LoadStc() : SaveJob(e)) : a.IsError && ($("#errorMsgRegion").html(closeButton + a.ValidationSummary), $("#errorMsgRegion").show(), $("html").animate({ scrollTop: 0 }, "slow"), $("body").animate({ scrollTop: 0 }, "slow"), DisableDropDownbyUsertype()) } }) } function jobChange() { "2" == $("#BasicDetails_JobType").val() ? ($("#TypeOfConnection,#JobSTCDetails_TypeOfConnection,#SystemMountingType,#JobSTCDetails_SystemMountingType").hide(), $("#DeemingPeriod,#JobSTCDetails_DeemingPeriod,#InstallerID,#BasicDetails_InstallerID,#DesignerID,#BasicDetails_DesignerID").hide(), $("#NMI,#JobInstallationDetails_NMI,#InstallingNewPanel,#InstallingNewPanel,#InstallingNewPanel,#JobInstallationDetails_InstallingNewPanel,#MeterNumber,#JobInstallationDetails_MeterNumber,#PhaseProperty,#JobInstallationDetails_PhaseProperty,#ElectricityProviderID,#JobInstallationDetails_ElectricityProviderID,#ExistingSystem1,#JobInstallationDetails_ExistingSystem,#ExistingSystem").hide(), $("#installContent").show(), $("#serialNumberLable").html("Tank serial number(s):"), $("#MultipleSGUAddress").html("Is there more than one SWH/ASHP at this address:"), $("#CertificateCreated").html("Creating certificates for previously failed SWH:"), $(".SWSystemDetails").show(), $(".PVDSystemDetail").hide(), $("#divVolumetricCapacity").show(), $("#divSecondhandWaterHeater").show(), $("#jobSSCID").hide(), $("#JobSystemDetails_NoOfPanel").removeAttr("readonly"), $("#electricianDetail").hide(), FillDropDown("JobInstallerDetails_ElectricianID", urlGetElectrician + $("#BasicDetails_JobID").val() + "&solarCompanyId=" + $("#BasicDetails_SolarCompanyId").val() + "&JobType=" + $("#BasicDetails_JobType").val(), JobInstallerDetails_ElectricianID, !0, null)) : "1" == $("#BasicDetails_JobType").val() && ($("#TypeOfConnection,#JobSTCDetails_TypeOfConnection,#SystemMountingType,#JobSTCDetails_SystemMountingType").show(), $("#DeemingPeriod,#JobSTCDetails_DeemingPeriod,#InstallerID,#BasicDetails_InstallerID,#DesignerID,#BasicDetails_DesignerID").show(), $("#NMI,#JobInstallationDetails_NMI,#InstallingNewPanel,#InstallingNewPanel,#InstallingNewPanel,#JobInstallationDetails_InstallingNewPanel,#MeterNumber,#JobInstallationDetails_MeterNumber,#PhaseProperty,#JobInstallationDetails_PhaseProperty,#ElectricityProviderID,#JobInstallationDetails_ElectricityProviderID,#ExistingSystem1,#JobInstallationDetails_ExistingSystem").show(), $("#installContent").hide(), $("#serialNumberLable").html("Equipment model serial number(s):"), $("#MultipleSGUAddress").html("Is there more than one SGU at this address?:"), $("#CertificateCreated").html("Are you creating certificates for a system that has previously been failed by the Clean Energy Regulator?:"), $(".SWSystemDetails").hide(), $(".PVDSystemDetail").show(), $("#divVolumetricCapacity").hide(), $("#divStatutoryDeclarations").hide(), $("#divSecondhandWaterHeater").hide(), $("#jobSSCID").show(), $("#JobSystemDetails_NoOfPanel").attr("readonly"), $("#electricianDetail").show(), FillDropDown("JobElectricians_ElectricianID", urlGetElectrician + $("#BasicDetails_JobID").val() + "&solarCompanyId=" + $("#BasicDetails_SolarCompanyId").val(), JobElectricians_ElectricianID, !0, null)), FillDropDown("JobPanelDetails_Brand", urlGetPanelBrand0 + $("#BasicDetails_JobType").val(), 0, !0, null) } function GSTFileUpload() { var e = Model_Guid, t = e, a = urlUploadInvoice; $("#uploadGSTFile").fileupload({ url: a, dataType: "json", done: function (e, a) { var l = []; l.length = 0; var i = []; i.length = 0; var s = []; s.length = 0; for (var n = 0; n < a.result.length; n++)if (1 == a.result[n].Status) { var o = document.getElementsByName("BasicDetails.GSTDocument"), r = $("#BasicDetails_GSTDocument").attr("OldFileName"); if (o.length > 0) { var d = o[0].defaultValue; null == d || "" == d || "" != r && null != r && null != r || DeleteGSTFile(d, t), $("#tblDocuments").find("tr").each(function () { $(this).remove() }) } var c = a.result[n].MimeType.split("/")[0], u = "<tr style='margin-top:30px' id= " + a.result[n].FileName.replace("%", "$") + " >"; u += '<td class="col-sm-8" style="color:#494949;border-bottom:0px !important">' + a.result[n].FileName.replace("%", "$") + " </td>", u += "image" == c ? '<td  class="col-sm-2" style="color:blue;border-bottom:0px !important"><img src=' + ProjectImagePath + 'images/view-icon.png style="cursor: pointer" id="' + a.result[n].FileName.replace("%", "$") + '"  class="' + a.result[n].FileName.replace("%", "$") + '" title="Preview" onclick="OpenGSTDocument(this)"></td>' : '<td  class="col-sm-2" style="color:blue;border-bottom:0px !important"><img src=' + ProjectImagePath + 'images/view-icon.png style="cursor: pointer" id="' + a.result[n].FileName.replace("%", "$") + '" class="' + a.result[n].FileName.replace("%", "$") + '" title="Download" onclick="DownloadGSTDocument(this)"></td>', u += '<td class="col-sm-2" style="color:blue;border-bottom:0px !important"><img src=' + ProjectImagePath + 'images/delete-icon.png style="cursor: pointer" id="' + a.result[n].FileName.replace("%", "$") + '" title="Delete" onclick="DeleteGSTDocument(this)"></td>', u += "</tr>", $("#tblDocuments").append(u), $("#BasicDetails_GSTDocument").val(a.result[n].FileName.replace("%", "$")) } else 0 == a.result[n].Status && "File Type Not Allowed." == a.result[n].Message ? s.push(a.result[n].FileName) : 0 == a.result[n].Status && "BigName" == a.result[n].Message ? i.push(a.result[n].FileName.replace("%", "$")) : l.push(a.result[n].FileName.replace("%", "$")); l.length > 0 && ($(".alert").hide(), $("#successMsgRegion").hide(), $("#errorMsgRegion").html(closeButton + l.length + " File has not been uploaded."), $("#errorMsgRegion").show()), s.length > 0 && ($(".alert").hide(), $("#successMsgRegion").hide(), $("#errorMsgRegion").html(closeButton + s.length + " Uploaded file type is not supported."), $("#errorMsgRegion").show()), i.length > 0 && ($(".alert").hide(), $("#successMsgRegion").hide(), $("#errorMsgRegion").html(closeButton + i.length + " Uploaded filename is too big."), $("#errorMsgRegion").show()), 0 == i.length && 0 == s.length && 0 == l.length && ($(".alert").hide(), $("#errorMsgRegion").hide(), $("#successMsgRegion").html(closeButton + "File has been uploaded successfully."), $("#successMsgRegion").show()) }, progressall: function (e, t) { }, singleFileUploads: !1, send: function (e, t) { if (1 == t.files.length) for (var a = 0; a < t.files.length; a++) { if (t.files[a].name.length > 500) return $(".alert").hide(), $("#successMsgRegion").hide(), $("#errorMsgRegion").html(closeButton + "Please upload small filename."), $("#errorMsgRegion").show(), $("html").animate({ scrollTop: 0 }, "slow"), $("body").animate({ scrollTop: 0 }, "slow"), !1; if (CheckSpecialCharInFileName(t.files[a].name)) return ShowErrorMsgForFileName("Please upload file that not conatain <> ^ [] ."), !1 } if (t.files.length > 1) for (a = 0; a < t.files.length; a++) { if (t.files[a].size > parseInt(MaxImageSize)) return $(".alert").hide(), $("#successMsgRegion").hide(), $("#errorMsgRegion").html(closeButton + " " + t.files[a].name + " Maximum file size limit exceeded. Please upload a file smaller  than " + maxsize + "MB"), $("#errorMsgRegion").show(), !1; if (CheckSpecialCharInFileName(t.files[a].name)) return ShowErrorMsgForFileName("Please upload file that not conatain <> ^ [] ."), !1 } else if (t.files[0].size > parseInt(MaxImageSize)) return $(".alert").hide(), $("#successMsgRegion").hide(), $("#errorMsgRegion").html(closeButton + "Maximum  file size limit exceeded.Please upload a  file smaller than " + maxsize + "MB"), $("#errorMsgRegion").show(), !1; return $(".alert").hide(), $("#errorMsgRegion").html(""), $("#errorMsgRegion").hide(), $('<input type="hidden">').attr({ name: "Guid", value: USERID, id: USERID }).appendTo("form"), !0 }, formData: { guid: e, jobId: t, isGSTDocument: 1 }, change: function (e, t) { $("#uploadFile").val("C:\\fakepath\\" + t.files[0].name) } }).prop("disabled", !$.support.fileInput).parent().addClass($.support.fileInput ? void 0 : "disabled") } function DeleteGSTFile(e, t, a) { $.ajax({ url: urlDeleteGSTFile, data: { fileName: e, FolderName: t, OldInvoiceFile: a }, contentType: "application/json", method: "get", async: !1, success: function (e) { return !1 } }) } function DeleteGSTDocument(e) { var t = $(e).attr("id"), a = Model_Guid, l = $(e).attr("oldFileName"); confirm("Are you sure you want to delete this file ?") && $.ajax({ url: urlDeleteGSTFile, data: { fileName: t, FolderName: a, OldInvoiceFile: l }, contentType: "application/json", method: "get", success: function () { return $("#tblDocuments").find("tr").each(function () { $(this).remove() }), $("#BasicDetails_GSTDocument").val(""), !1 } }) } function OpenGSTDocument(e) { var t = Model_Guid, a = $(e).attr("id"), l = UploadedDocumentPath + "/JobDocuments/" + t + "/GST/" + a; $("#loading-image").css("display", ""), $("#imgViewImage").attr("src", l).load(function () { logoWidthGST = this.width, logoHeightGST = this.height, $("#popupProof").modal({ backdrop: "static", keyboard: !1 }), $(window).height() <= logoHeightGST ? ($("#imgViewImage").closest("div").height($(window).height() - 205), $("#imgViewImage").closest("div").css("overflow-y", "scroll"), $("#imgViewImage").height(logoHeightGST)) : ($("#imgViewImage").height(logoHeightGST), $("#imgViewImage").closest("div").removeAttr("style")), screen.width <= logoWidthGST || logoWidthGST >= screen.width - 250 ? ($("#popupProof").find(".modal-dialog").width(screen.width - 250), $("#imgViewImage").width(logoWidthGST)) : ($("#imgViewImage").width(logoWidthGST), $("#popupProof").find(".modal-dialog").width(logoWidthGST)), $("#loading-image").css("display", "none") }), $("#imgViewImage").unbind("error"), $("#imgViewImage").attr("src", l).error(function () { alert("Image does not exist."), $("#loading-image").css("display", "none") }) } function DownloadGSTDocument(e) { var t = Model_Guid, a = $(e).attr("id"); window.location.href = urlDownloadGSTDocument + a + "&FolderName=" + t } function LoadImageSignature() { $("#loading-image").css("display", ""), $("#imgAllSign").attr("src", SRCSignAll).load(function () { logoWidthAllSignature = this.width, logoHeightAllSignature = this.height, $("#popupSign").modal({ backdrop: "static", keyboard: !1 }), $(window).height() <= logoHeightAllSignature ? ($("#imgAllSign").closest("div").height($(window).height() - 150), $("#imgAllSign").closest("div").css("overflow-y", "scroll"), $("#imgAllSign").height(logoHeightAllSignature)) : ($("#imgAllSign").height(logoHeightAllSignature), $("#imgAllSign").closest("div").removeAttr("style")), screen.width <= logoWidthAllSignature || logoWidthAllSignature >= screen.width - 250 ? ($("#popupSign").find(".modal-dialog").width(screen.width - 250), $("#imgAllSign").width(logoWidthAllSignature)) : ($("#imgAllSign").width(logoWidthAllSignature), $("#popupSign").find(".modal-dialog").width(logoWidthAllSignature)), $("#loading-image").css("display", "none") }), $("#imgAllSign").unbind("error"), $("#imgAllSign").attr("src", SRCSignAll).error(function () { alert("Image does not exist."), $("#loading-image").css("display", "none") }) } function GetInstallerDesignerElectricianSignature(e, t) { t > 0 ? $.ajax({ url: urlGetInstallerDesignerElectricianSignature, data: { signatureTypeId: e, jobId: BasicDetails_JobID, installerDesignerElectricianId: t }, contentType: "application/json", method: "get", success: function (t) { t.status ? (2 == e ? installerSignSRC = t.signature : 4 == e ? designerSignSRC = t.signature : 3 == e && (electricianSignSRC = t.signature), 2 == e ? ($("#imgInstallerSignatureViewSWH").show(), $("#imgInstallerSignatureView").show()) : $("#imgDesignerSignatureView").show()) : t.error ? showErrorMessagesForStatus(t.error) : showErrorMessagesForStatus("Signature does not exist.") }, error: function () { showErrorMessagesForStatus("Signature does not exist.") } }) : 2 == e ? ($("#imgInstallerSignatureViewSWH").hide(), $("#imgInstallerSignatureView").hide()) : $("#imgDesignerSignatureView").hide() } function UploadAllSignatureOfJob(e) { var t = e.attr("typeOfSignature"); e.fileupload({ url: urlUploadJobSignature, dataType: "json", done: function (e, a) { var l = []; l.length = 0; for (var i = 0; i < a.result.length; i++)a.result[i].AbsolutePath = "/" + JobDocumentsToSavePath + "/" + BasicDetails_JobID + "/" + a.result[i].FileName, 1 == a.result[i].Status ? 3 == t ? (isElectricianSignUpload = !0, electricianSignSRC = a.result[i].AbsolutePath, $("#imgElectricianSignatureView").show()) : 4 == t ? (isDesignerSignUpload = !0, designerSignSRC = a.result[i].AbsolutePath, $("#imgDesignerSignatureView").show()) : 2 == t ? (isInstallerSignUpload = !0, installerSignSRC = a.result[i].AbsolutePath, $("#imgInstallerSignatureViewSWH").show(), $("#imgInstallerSignatureView").show()) : 1 == t && (isOwnerSignUpload = !0, SRCOwnerSign = signatureURL + a.result[i].AbsolutePath, $("#imgOwnerSignatureView").show()) : l.push(a.result[i].FileName.replace("%", "$")); l.length > 0 ? showErrorMessagesForStatus("File has not been uploaded.") : showSuccessMessages("File has been uploaded successfully.") }, progressall: function (e, t) { }, singleFileUploads: !1, send: function (e, t) { var a = t.files[0].type.split("/")[0]; if (t.files.length > 1) for (var l = 0; l < t.files.length; l++) { if (t.files[l].size > parseInt(MaxImageSize_Job)) return showErrorMessagesForStatus(" " + t.files[l].name + " Maximum file size limit exceeded. Please upload a file smaller  than " + maxsize + "MB"), !1; if (CheckSpecialCharInFileName(t.files[l].name)) return showErrorMessagesForStatus("Please upload file that not conatain <> ^ [] ."), !1 } else { if (t.files[0].size > parseInt(MaxImageSize_Job)) return showErrorMessagesForStatus("Maximum file size limit exceeded.Please upload a file smaller than " + maxsize + "MB"), !1; if (CheckSpecialCharInFileName(t.files[0].name)) return showErrorMessagesForStatus("Please upload file that not conatain <> ^ [] ."), !1 } return "image" != a ? (showErrorMessagesForStatus("Please upload a file with .jpg , .jpeg or .png extension."), $("html").animate({ scrollTop: 0 }, "slow"), $("body").animate({ scrollTop: 0 }, "slow"), !1) : ($(".alert").hide(), $("#errorMsgRegion").html(""), $("#errorMsgRegion").hide(), !0) }, formData: { jobId: BasicDetails_JobID, typeOfSignature: t } }) } function clearSignature(e) { confirm("Are you sure you want to delete uploaded signature?") && (1 == e ? (ClearAllSignature(e, SRCOwnerSign, isOwnerSignUpload), isOwnerSignUpload = !1, $("#imgOwnerSignatureView").hide()) : 2 == e ? (ClearAllSignature(e, installerSignSRC, isInstallerSignUpload), isInstallerSignUpload = !1, $("#imgInstallerSignatureViewSWH").hide(), $("#imgInstallerSignatureView").hide()) : 3 == e ? (ClearAllSignature(e, electricianSignSRC, isElectricianSignUpload), isElectricianSignUpload = !1, $("#imgElectricianSignatureView").hide()) : 4 == e && (ClearAllSignature(e, designerSignSRC, isDesignerSignUpload), isDesignerSignUpload = !1, $("#imgDesignerSignatureView").hide())) } function ClearAllSignature(e, t, a) { $.ajax({ url: urlClearJobSignture, dataType: "json", contentType: "application/json; charset=utf-8", type: "get", data: { typeOfSignature: e, signaturePath: t, jobId: BasicDetails_JobID, isUpload: a.toString().toLowerCase() }, success: function (e) { e.status ? showSuccessMessages("Signature has been deleted successfully.") : showErrorMessagesForStatus(e.error) }, error: function () { showErrorMessagesForStatus("Signature has not been deleted.") } }) } function jobErrorMessage(e) { $("#errorMsgRegion").html(closeButton + e), $("#errorMsgRegion").show(), $("html").animate({ scrollTop: 0 }, "slow"), $("body").animate({ scrollTop: 0 }, "slow") } function checkExistSWHInstaller(e, t) { var a, l = e.id, i = e.value; a = company_Id, "" != i && null != i && $.ajax({ url: CheckSWHUserExistURL, data: { UserValue: i, FieldName: l, userId: null, resellerID: null, solarCompanyId: parseInt(a) }, contentType: "application/json", method: "get", success: function (e) { var t; 0 == e.status ? (t = e.message, !1, $(".alert").hide(), $("#errorMsgRegionSWHInstallerPopup").html(closeButton + t), $("#errorMsgRegionSWHInstallerPopup").show()) : !0 } }) } function SWHInstallerSignatureUpload() { var e = UploadedDocumentPath; if ("" != $("#imgSignSWHInstall").attr("src") && "" != JobInstallerDetailsSWH_SESignature) { var t = $("#imgSignSWHInstall").attr("src"), a = ProjectSession_LoggedInUserId; SRCSignSWHInstall = e + "UserDocuments/" + a + "/" + t, $("#imgSignSWHInstall").attr("class", t), $("#imgSWHSignatureInstaller").show() } null != BasicDetails_InstallerSignature && "" != BasicDetails_InstallerSignature && null != BasicDetails_InstallerSignature ? (BasicDetails_InstallerSignature_Replace = BasicDetails_InstallerSignature.replace("\\", "/"), $("#imgInstallerSign").attr("src", e + BasicDetails_InstallerSignature_Replace + "?" + (new Date).getTime())) : $("#imgInstallerSign").attr("src", SRCSignSWHInstall), $("#imgSWHSignatureInstaller").click(function () { $("#loading-image").css("display", ""), $("#imgSignSWHInstall").attr("src", SRCSignSWHInstall).load(function () { logoWidthSignSWHInstall = this.width, logoHeightSignSWHInstall = this.height, $("#popupboxSWHInsaller").modal({ backdrop: "static", keyboard: !1 }), $(window).height() <= logoHeightSignSWHInstall ? ($("#imgSignSWHInstall").closest("div").height($(window).height() - 205), $("#imgSignSWHInstall").closest("div").css("overflow-y", "scroll"), $("#imgSignSWHInstall").height(logoHeightSignSWHInstall)) : ($("#imgSignSWHInstall").height(logoHeightSignSWHInstall), $("#imgSignSWHInstall").closest("div").removeAttr("style")), screen.width <= logoWidthSignSWHInstall || logoWidthSignSWHInstall >= screen.width - 250 ? ($("#popupboxSWHInsaller").find(".modal-dialog").width(screen.width - 250), $("#imgSignSWHInstall").width(logoWidthSignSWHInstall)) : ($("#imgSignSWHInstall").width(logoWidthSignSWHInstall), $("#popupboxSWHInsaller").find(".modal-dialog").width(logoWidthSignSWHInstall)), $("#loading-image").css("display", "none") }), $("#popupboxSWHInsaller").unbind("error"), $("#imgSignSWHInstall").attr("src", SRCSignSWHInstall).error(function () { alert("Image does not exist."), $("#loading-image").css("display", "none") }) }), $("#uploadBtnSignatureSWHInstaller").fileupload({ url: Upload_User, dataType: "json", done: function (e, t) { var a = []; a.length = 0; var l = []; l.length = 0; for (var i = 0; i < t.result.length; i++)if (1 == t.result[i].Status) { var s = ProjectSession_LoggedInUserId, n = $("#imgSignSWHInstall").attr("class"); $("[name='JobInstallerDetails.SESignature']").each(function () { $(this).remove() }), null != n && "" != n && DeleteFileFromLogoOnUpload(n, s, JobInstallerDetailsSWH_SESignature); var o = UploadedDocumentPath; SRCSignSWHInstall = o + "UserDocuments/" + s + "/" + t.result[i].FileName, $("#imgSignSWHInstall").attr("src", SRCSignSWHInstall), $("#imgSignSWHInstall").attr("class", t.result[i].FileName), $("#imgSWHSignatureInstaller").show(), $('<input type="hidden">').attr({ name: "JobInstallerDetails.SESignature", value: t.result[i].FileName, id: t.result[i].FileName }).appendTo("form") } else 0 == t.result[i].Status && "BigName" == t.result[i].Message ? l.push(t.result[i].FileName) : a.push(t.result[i].FileName); a.length > 0 && showErrorMessageForPopup(a.length + " File has not been uploaded.", $("#errorMsgRegionSWHInstallerPopup"), $("#successMsgRegionSWHInstallerPopup")), l.length > 0 && showErrorMessageForPopup(l.length + " Uploaded filename is too big.", $("#errorMsgRegionSWHInstallerPopup"), $("#successMsgRegionSWHInstallerPopup")), 0 == l.length && 0 == a.length && showSuccessMessageForPopup("File has been uploaded successfully.", $("#successMsgRegionSWHInstallerPopup"), $("#errorMsgRegionSWHInstallerPopup")) }, progressall: function (e, t) { }, singleFileUploads: !1, send: function (e, t) { var a = t.files[0].type.split("/")[0]; if (1 == t.files.length) for (var l = 0; l < t.files.length; l++) { if (t.files[l].name.length > 50) return showErrorMessageForPopup("Please upload small filename.", $("#errorMsgRegionSWHInstallerPopup"), $("#successMsgRegionSWHInstallerPopup")), $("html").animate({ scrollTop: 0 }, "slow"), $("body").animate({ scrollTop: 0 }, "slow"), !1; if (CheckSpecialCharInFileName(t.files[l].name)) return showErrorMessageForPopup("Please upload file that not conatain <> ^ [] .", $("#errorMsgRegionSWHInstallerPopup"), $("#successMsgRegionSWHInstallerPopup")), $("html").animate({ scrollTop: 0 }, "slow"), $("body").animate({ scrollTop: 0 }, "slow"), !1 } if (t.files.length > 1) for (l = 0; l < t.files.length; l++) { if (t.files[l].size > parseInt(MaxLogoSize)) return showErrorMessageForPopup(" " + t.files[l].name + " Maximum file size limit exceeded. Please upload a file smaller  than " + maxLogoSize + "MB", $("#errorMsgRegionSWHInstallerPopup"), $("#successMsgRegionSWHInstallerPopup")), !1; if (CheckSpecialCharInFileName(t.files[l].name)) return showErrorMessageForPopup("Please upload file that not conatain <> ^ [] .", $("#errorMsgRegionSWHInstallerPopup"), $("#successMsgRegionSWHInstallerPopup")), !1 } else if (t.files[0].size > parseInt(MaxLogoSize)) return showErrorMessageForPopup("Maximum  file size limit exceeded.Please upload a  file smaller than " + maxLogoSize + "MB", $("#errorMsgRegionSWHInstallerPopup"), $("#successMsgRegionSWHInstallerPopup")), !1; return "image" != a ? (showErrorMessageForPopup("Please upload a file with .jpg , .jpeg or .png extension.", $("#errorMsgRegionSWHInstallerPopup"), $("#successMsgRegionSWHInstallerPopup")), $("html").animate({ scrollTop: 0 }, "slow"), $("body").animate({ scrollTop: 0 }, "slow"), !1) : ($(".alert").hide(), $("#errorMsgRegion").html(""), $("#errorMsgRegion").hide(), $('<input type="hidden">').attr({ name: "Guid", value: ProjectSession_LoggedInUserId, id: ProjectSession_LoggedInUserId }).appendTo("form"), !0) }, formData: { userId: ProjectSession_LoggedInUserId }, change: function (e, t) { $("#uploadFile").val("C:\\fakepath\\" + t.files[0].name) } }).prop("disabled", !$.support.fileInput).parent().addClass($.support.fileInput ? void 0 : "disabled") } function showErrorMessageForPopup(e, t, a) { $(".alert").hide(), a && a.hide(), t.html(closeButton + e), t.show() } function showSuccessMessageForPopup(e, t, a) { $(".alert").hide(), a && a.hide(), t.html(closeButton + e), t.show() } $("#noWarning").click(function () { $("#warning").modal("hide"), "0" != $("#BasicDetails_JobID").val() && ($("#BasicDetails_JobType").attr("disabled", "disabled"), $("#BasicDetails_JobType").change()) }), $("#CloseWarning").click(function () { $("#STCwarning").modal("hide"), "0" != $("#BasicDetails_JobID").val() && ($("#BasicDetails_JobType").attr("disabled", "disabled"), $("#BasicDetails_JobType").change()) }), $("#yesWarning").click(function () { $("#warning").modal("hide"), SaveJob(jobSaveType) }), $(document).ready(function () { UploadAllSignatureOfJob($("#uploadJobInstallerSignSWH")), UploadAllSignatureOfJob($("#uploadJobInstallerSign")), UploadAllSignatureOfJob($("#uploadJobDesignerSign")), UploadAllSignatureOfJob($("#uploadJobElectricianSign")), UploadAllSignatureOfJob($("#uploadJobOwnerSign")), null != installerSignSRC && "" != installerSignSRC && ($("#imgInstallerSignatureViewSWH").show(), $("#imgInstallerSignatureView").show()), null != designerSignSRC && "" != designerSignSRC && $("#imgDesignerSignatureView").show(), null != electricianSignSRC && "" != electricianSignSRC && $("#imgElectricianSignatureView").show(), $("#BasicDetails_InstallerID").change(function () { GetInstallerDesignerElectricianSignature(2, $(this).val()) }), $("#BasicDetails_DesignerID").change(function () { GetInstallerDesignerElectricianSignature(4, $(this).val()) }), $("#imgInstallerSignatureViewSWH").click(function () { SRCSignAll = signatureURL + installerSignSRC, LoadImageSignature() }), $("#imgInstallerSignatureView").click(function () { SRCSignAll = signatureURL + installerSignSRC, LoadImageSignature() }), $("#imgDesignerSignatureView").click(function () { SRCSignAll = signatureURL + designerSignSRC, LoadImageSignature() }), $("#imgElectricianSignatureView").click(function () { SRCSignAll = signatureURL + electricianSignSRC, LoadImageSignature() }), $("#JobInstallationDetails_PropertyType").change(function () { 2 == IsGSTSetByAdminUser || "True" != IsRegisteredWithGST || "Commercial" != $(this).val() && "School" != $(this).val() ? ($("#BasicDetails_IsGst").prop("checked", !1), $("#BasicDetails_GSTDocument").val(""), $("#tblDocuments").find("tr").each(function () { $(this).remove() }), $(".isGSTRegistered").hide()) : $(".isGSTRegistered").show() }), 2 == IsGSTSetByAdminUser || "True" != IsRegisteredWithGST || "Commercial" != $("#JobInstallationDetails_PropertyType").val() && "School" != $("#JobInstallationDetails_PropertyType").val() ? $(".isGSTRegistered").hide() : $(".isGSTRegistered").show(), STCInvoiceCount > 0 ? $("#BasicDetails_IsGst").prop("disabled", !0) : $("#BasicDetails_IsGst").prop("disabled", !1), GSTFileUpload(), $("#btnClosepopupProof").click(function () { $("#popupProof").modal("hide") }); var e = $("#BasicDetails_strSoldByDate").val(); if (null != e && null != e && "" != e) { $("#BasicDetails_strSoldByDate").val("").removeAttr("value"), $("#BasicDetails_strSoldByDate").datepicker({ format: GetDateFormat, autoclose: !0 }).on("changeDate", function () { $(this).datepicker("hide") }); var t = moment(e).format(GetDateFormat.toUpperCase()); $("#BasicDetails_strSoldByDate").val(t) } else $("#BasicDetails_strSoldByDate").datepicker({ format: GetDateFormat, autoclose: !0 }).on("changeDate", function () { $(this).datepicker("hide") }); jsonvarSoldByDate = $("#BasicDetails_strSoldByDate").val(), jsonvarJobSoldBy = $("#BasicDetails_SoldBy").val(), $("#loading-image").show(), $("#btnPopupSerialNumber").click(function () { $("#serialNumberPopup").html(""); var e = $("#JobSystemDetails_SerialNumbers").val().trim(), t = JSON.stringify({ serialNumbers: $("#JobSystemDetails_SerialNumbers").val(), jobID: $("#BasicDetails_JobID").val() }); $.ajax({ url: urlCheckDuplicateSerialNumbers, type: "post", async: !0, dataType: "json", data: t, cache: !1, contentType: "application/json; charset=utf-8", success: function (t) { if (t.length > 0) { MasterSerialArray = [], JobSerialArray = []; var a = $.parseJSON(t); $.grep(a, function (e, t) { e.IsExistInMaster ? JobSerialArray.push(e.ExistsSerialNumber) : MasterSerialArray.push(e.ExistsSerialNumber) }); var l = e.split("\n"); l = l.filter(function (e) { return e.length > 0 }); for (var i = 1; i < l.length + 1; i++)-1 !== JobSerialArray.indexOf(l[i - 1]) ? $("#serialNumberPopup").append("<li><span style='background-color: rgba(30, 121, 204, 0.21);'>" + i + " :" + l[i - 1] + "</span></li>") : -1 !== MasterSerialArray.indexOf(l[i - 1]) ? $("#serialNumberPopup").append("<li><span style='background-color: rgba(220, 82, 109, 0.21);'>" + i + " :" + l[i - 1] + "</span></li>") : $("#serialNumberPopup").append("<li><span>" + i + " :" + l[i - 1] + "</span></li>") } else MasterSerialArray = [], JobSerialArray = [] } }), $("#popupSerialNumber").modal({ backdrop: "static", keyboard: !1 }) }), $("#JobOwnerDetails_UnitTypeID").change(function () { "" == $("#JobOwnerDetails_UnitTypeID option:selected").val() ? ($("#lblOwnerUnitNumber").removeClass("required"), $("#lblOwnerUnitTypeID").removeClass("required"), $("#lblOwnerStreetNumber").addClass("required")) : ($("#lblOwnerUnitNumber").addClass("required"), $("#lblOwnerUnitTypeID").addClass("required"), $("#lblOwnerStreetNumber").removeClass("required")) }), $("#JobInstallationDetails_UnitTypeID").change(function () { "" == $("#JobInstallationDetails_UnitTypeID option:selected").val() ? ($("#lblInstallationUnitNumber").removeClass("required"), $("#lblInstallationUnitTypeID").removeClass("required"), $("#lblInstallationStreetNumber").addClass("required")) : ($("#lblInstallationUnitNumber").addClass("required"), $("#lblInstallationUnitTypeID").addClass("required")) }), $("#JobElectricians_UnitTypeID").change(function () { "" == $("#JobElectricians_UnitTypeID option:selected").val() ? ($("#lblElectriciansUnitNumber").removeClass("required"), $("#lblElectriciansUnitTypeID").removeClass("required"), $("#lblElectriciansStreetNumber").addClass("required")) : ($("#lblElectriciansUnitNumber").addClass("required"), $("#lblElectriciansUnitTypeID").addClass("required"), $("#lblElectriciansStreetNumber").removeClass("required")) }), $("#JobInstallerDetails_UnitTypeID").change(function () { "" == $("#JobInstallerDetails_UnitTypeID option:selected").val() ? ($("#lblInstallerUnitNumber").removeClass("required"), $("#lblInstallerUnitTypeID").removeClass("required"), $("#lblInstallerStreetNumber").addClass("required")) : ($("#lblInstallerUnitNumber").addClass("required"), $("#lblInstallerUnitTypeID").addClass("required"), $("#lblInstallerStreetNumber").removeClass("required")) }), $("#JobOwnerDetails_OwnerType").change(function (e) { "Government body" == this.value || "Corporate body" == this.value || "Trustee" == this.value ? ($("#OwnerCompanyName").addClass("required"), "" != $("#JobOwnerDetails_CompanyName").val() || ($("#JobOwnerDetails_CompanyName").removeClass("valid"), $("#OwnerCompanyNameValidate").addClass("field-validation-error")), $("#OwnerCompanyNameValidate").show(), $("#JobOwnerDetails_CompanyName").rules("add", { required: !0, messages: { required: "Company Name is required." } })) : ($("#JobOwnerDetails_CompanyName").rules("remove"), $("#JobOwnerDetails_CompanyName").removeClass("input-validation-error"), $("#OwnerCompanyName").removeClass("required"), $("#OwnerCompanyNameValidate").hide(), $("#OwnerFirstName").addClass("required"), "" != $("#JobOwnerDetails_FirstName").val() || ($("#JobOwnerDetails_FirstName").removeClass("valid"), $("#OwnerFirstNameValidate").addClass("field-validation-error")), $("#OwnerFirstNameValidate").show(), $("#JobOwnerDetails_FirstName").rules("add", { required: !0, messages: { required: "First Name is required." } }), $("#OwnerLastName").addClass("required"), "" != $("#JobOwnerDetails_LastName").val() || ($("#JobOwnerDetails_LastName").removeClass("valid"), $("#OwnerLastNameValidate").addClass("field-validation-error")), $("#OwnerLastNameValidate").show(), $("#JobOwnerDetails_LastName").rules("add", { required: !0, messages: { required: "Last Name is required." } })) }), $("#BasicDetails_JobSoldBy").change(function () { var e = $("#BasicDetails_JobSoldBy").val(); $("#BasicDetails_JobSoldByText").val(e) }), $("#btnSoldBy").click(function () { $("#popupSoldBy").modal({ backdrop: "static", keyboard: !1 }), "" != jsonvarSoldByDate && $("#BasicDetails_strSoldByDate").val(jsonvarSoldByDate), $("#BasicDetails_JobSoldByText").val(jsonvarJobSoldBy) }), $("#edit").click(function (e) { window.location.href = "/Job/Edit/" + jobIDForScheduling }), $("#JobInstallationDetails_InstallingNewPanel").change(function (e) { "New" != $("#JobInstallationDetails_InstallingNewPanel").val() && "" != $("#JobInstallationDetails_InstallingNewPanel").val() ? $("#installationLocation").show() : $("#installationLocation").hide() }), $("#JobSTCDetails_MultipleSGUAddress").change(function (e) { "1" == JOBType && ("Yes" == this.value ? $("#STCLocation").show() : $("#STCLocation").hide()) }), $("#btnMainCancel").click(function (e) { window.location.href = "/Job/Index" }), setTimeout(function () { $("#BasicDetails_JobType").focus() }, 3e3); var a = BasicDetails_JobID; $.ajax({ url: urlGetSSCUserInEdit + a, type: "get", dataType: "json", cache: !1, async: !1, contentType: "application/json; charset=utf-8", success: function (e) { e.length > 0 ? ($("#SSCID").empty(), $("#SSCID").append('<option value="">Select</option>'), $.each(e, function (e, t) { $("#SSCID").append('<option value="' + t.Value + '">' + t.Text + "</option>") })) : ($("#SSCID").empty(), $("#SSCID").append('<option value="">Select</option>')) } }), $.ajax({ url: urlGetSSCUserInDropdown + a, type: "get", dataType: "json", cache: !1, async: !1, contentType: "application/json; charset=utf-8", success: function (e) { e.length > 0 ? ($("#SSCID").prop("disabled", !0), $("#SSCID").val(parseInt(e[0].SSCID)), $("#btnJobSSCMapping").hide()) : ($("#SSCID").prop("disabled", !1), $("#btnJobSSCMapping").show()) } }), BasicDetails_ScoID > 0 ? FillDropDown("ScoID", urlGetSCOUser, BasicDetails_ScoID, !0, null) : FillDropDown("ScoID", urlGetSCOUser, null, !0, null); var l = JobInstallationDetails_PostalAddressID || 0, i = JobInstallationDetails_UnitTypeID || 0, s = StreetTypeID || 0; (_ = []).push({ id: "JobInstallationDetails_UnitTypeID", key: "UnitType", value: i, hasSelect: !0, callback: fillInstallationAddress, defaultText: null, proc: "UnitType_BindDropdown", param: [], bText: "UnitTypeName", bValue: "UnitTypeID" }, { id: "JobInstallationDetails_StreetTypeID", key: "StreetType", value: s, hasSelect: !0, callback: fillInstallationAddress, defaultText: null, proc: "StreetType_BindDropdown", param: [], bText: "StreetTypeName", bValue: "StreetTypeID" }, { id: "JobInstallationDetails_PostalAddressID", key: "PostalAddress", value: l, hasSelect: !0, callback: fillInstallationAddress, defaultText: null, proc: "PostalAddress_BindDropdown", param: [], bText: "PostalDeliveryType", bValue: "PostalAddressID" }), _.bindDropdown(); var n = JobOwnerDetails_PostalAddressID || 0, o = JobOwnerDetails_UnitTypeID || 0, r = JobOwnerDetails_StreetTypeID || 0; (_ = []).push({ id: "JobOwnerDetails_UnitTypeID", key: "UnitType", value: o, hasSelect: !0, callback: fillOwnerAddress, defaultText: null, proc: "UnitType_BindDropdown", param: [], bText: "UnitTypeName", bValue: "UnitTypeID" }, { id: "JobOwnerDetails_StreetTypeID", key: "StreetType", value: r, hasSelect: !0, callback: fillOwnerAddress, defaultText: null, proc: "StreetType_BindDropdown", param: [], bText: "StreetTypeName", bValue: "StreetTypeID" }, { id: "JobOwnerDetails_PostalAddressID", key: "PostalAddress", value: n, hasSelect: !0, callback: fillOwnerAddress, defaultText: null, proc: "PostalAddress_BindDropdown", param: [], bText: "PostalDeliveryType", bValue: "PostalAddressID" }), _.bindDropdown(); var d = JobInstallerDetails_PostalAddressID || 0, c = JobOwnerDetails_UnitTypeID || 0, u = JobInstallerDetails_StreetTypeID || 0; (_ = []).push({ id: "JobInstallerDetails_UnitTypeID", key: "UnitType", value: c, hasSelect: !0, callback: fillInstallerAddress, defaultText: null, proc: "UnitType_BindDropdown", param: [], bText: "UnitTypeName", bValue: "UnitTypeID" }, { id: "JobInstallerDetails_StreetTypeID", key: "StreetType", value: u, hasSelect: !0, callback: fillInstallerAddress, defaultText: null, proc: "StreetType_BindDropdown", param: [], bText: "StreetTypeName", bValue: "StreetTypeID" }, { id: "JobInstallerDetails_PostalAddressID", key: "PostalAddress", value: d, hasSelect: !0, callback: fillInstallerAddress, defaultText: null, proc: "PostalAddress_BindDropdown", param: [], bText: "PostalDeliveryType", bValue: "PostalAddressID" }), _.bindDropdown(); var b, D, m, p = InstallerID || 0, v = DesignerID || 0, S = JobInstallationDetails_DistributorID || 0; FillDropDownInstaller("BasicDetails_InstallerID", urlGetInstallerDesignerWithStatus + "?isInstaller=true&existUserId=" + p + "&solarCompanyId=" + $("#BasicDetails_SolarCompanyId").val() + "&jobId=" + BasicDetails_JobID, p, !0, null), FillDropDownInstaller("BasicDetails_DesignerID", urlGetInstallerDesignerWithStatus + "?isInstaller=false&existUserId=" + v + "&solarCompanyId=" + $("#BasicDetails_SolarCompanyId").val() + "&jobId=" + BasicDetails_JobID, v, !0, null), "1" == JOBType || "0" == JOBType ? FillDropDown("JobElectricians_ElectricianID", urlGetElectrician + $("#BasicDetails_JobID").val() + "&solarCompanyId=" + $("#BasicDetails_SolarCompanyId").val(), JobElectricians_ElectricianID, !0, null) : (FillDropDown("JobInstallerDetails_ElectricianID", urlGetElectrician + $("#BasicDetails_JobID").val() + "&solarCompanyId=" + $("#BasicDetails_SolarCompanyId").val() + "&JobType=" + $("#BasicDetails_JobType").val(), JobInstallerDetails_ElectricianID, !0, null), SWHInstallerSignatureUpload()), FillDropDown("BasicDetails_JobSoldBy", urlGetSoldBy, 0, !0, null), FillDropDown("JobInstallationDetails_DistributorID", urlGetDestributors, S, !0, null), JOBType, b = BasicDetails_JobStage || 0, D = BasicDetails_Priority || 0, m = JobSTCDetails_DeemingPeriod || 0, FillDropDown("BasicDetails_JobStage", urlGetJobStage, b, !0, fillJobStage), FillDropDown("BasicDetails_Priority", urlGetPriority, D, !0, null); var I = JobInstallationDetails_ElectricityProviderID || 0; FillDropDown("JobInstallationDetails_ElectricityProviderID", urlGetElectricityProvider, I, !0, null); $("#BasicDetails_strInstallationDate").val(); var J = "", h = $("#BasicDetails_strInstallationDateTemp").val(); null != h && null != h && "" != h && (J = moment(h).format("yyyy".toUpperCase())), FillDropDown("JobSTCDetails_DeemingPeriod", urlGetDeemingPeriod + J, m, !0, null), $("#BasicDetails_strInstallationDate").change(function () { var e, t = "", a = $("#BasicDetails_strInstallationDate").val(); null != a && null != a && "" != a && (t = moment(a, "DD/MM/YYYY").format("yyyy".toUpperCase())), e = $("#JobSTCDetails_DeemingPeriod").val(), FillDropDown("JobSTCDetails_DeemingPeriod", urlGetDeemingPeriod + t, e, !0, null) }); var _, g = JobElectricians_PostalAddressID || 0, y = JobElectricians_UnitTypeID || 0, f = JobElectricians_StreetTypeID || 0; (_ = []).push({ id: "JobElectricians_UnitTypeID", key: "UnitType", value: y, hasSelect: !0, callback: fillBasicAddress, defaultText: null, proc: "UnitType_BindDropdown", param: [], bText: "UnitTypeName", bValue: "UnitTypeID" }, { id: "JobElectricians_StreetTypeID", key: "StreetType", value: f, hasSelect: !0, callback: fillBasicAddress, defaultText: null, proc: "StreetType_BindDropdown", param: [], bText: "StreetTypeName", bValue: "StreetTypeID" }, { id: "JobElectricians_PostalAddressID", key: "PostalAddress", value: g, hasSelect: !0, callback: fillBasicAddress, defaultText: null, proc: "PostalAddress_BindDropdown", param: [], bText: "PostalDeliveryType", bValue: "PostalAddressID" }), _.bindDropdown(), FillDropDownInstaller("JobElectricians_InstallerID", urlGetInstallerDesignerWithStatus + "?isInstaller=true&existUserId=" + p + "&solarCompanyId=" + $("#BasicDetails_SolarCompanyId").val() + "&jobId=" + BasicDetails_JobID, JobElectricians_InstallerID, !0, null); var w = JobPanelDetails_Brand || "0"; FillDropDown("JobPanelDetails_Brand", urlGetPanelBrand, w, !0, null), $("#btnCalculatedSTC,#btnCalculatedSTCSWH").click(function (e) { CalculateStc1() }), $("#JobPanelDetails_Brand").change(function (e) { this.selectedIndex > 0 ? ($("#JobPanelDetails_Model").prop("disabled", !1), FillDropDown("JobPanelDetails_Model", urlGetPanelModel + $("#JobPanelDetails_Brand").val() + "&JobType=1", 0, !0, null)) : ($("#JobPanelDetails_Model").prop("disabled", !0), $("#JobPanelDetails_NoOfPanel").prop("disabled", !0)) }), $("#JobPanelDetails_Model").change(function (e) { this.selectedIndex > 0 ? $("#JobPanelDetails_NoOfPanel").prop("disabled", !1) : ($("#JobPanelDetails_NoOfPanel").prop("disabled", !0), $("#JobPanelDetails_NoOfPanel").val("")) }); var T = JobInverterDetails_Brand || 0; FillDropDown("JobInverterDetails_Brand", urlGetInverterBrand, T, !0, null), $("#JobInverterDetails_Brand").change(function () { this.selectedIndex > 0 ? ($("#JobInverterDetails_Series").prop("disabled", !1), FillDropDown("JobInverterDetails_Series", urlGetInverterModel + $("#JobInverterDetails_Brand").val(), 0, !0, null)) : ($("#JobInverterDetails_Model").prop("disabled", !0), $("#JobInverterDetails_Series").prop("disabled", !0)) }), $("#JobInverterDetails_Series").change(function () { this.selectedIndex > 0 ? ($("#JobInverterDetails_Model").prop("disabled", !1), FillDropDown("JobInverterDetails_Model", urlGetInverterSeries + $("#JobInverterDetails_Series").val() + "&Manufacturer=" + $("#JobInverterDetails_Brand").val(), 0, !0, null)) : $("#JobInverterDetails_Model").prop("disabled", !0) }), $("#JobPanelDetails_Brand").change(function () { this.selectedIndex > 0 ? ($("#JobPanelDetails_Model").prop("disabled", !1), FillDropDown("JobPanelDetails_Model", urlGetPanelModel + $("#JobPanelDetails_Brand").val() + "&JobType=1", 0, !0, null)) : $("#JobPanelDetails_Model").prop("disabled", !0) }), FillDropDown("JobBatteryManufacturer_Manufacturer", urlGetBatteryManufacturer, null, !0, null), $("#JobBatteryManufacturer_Manufacturer").change(function (e) { this.selectedIndex > 0 ? ($("#JobBatteryManufacturer_ModelNumber").prop("disabled", !1), FillDropDown("JobBatteryManufacturer_ModelNumber", urlGetBatteryModel + $("#JobBatteryManufacturer_Manufacturer").val(), 0, !0, null)) : $("#JobBatteryManufacturer_ModelNumber").prop("disabled", !0) }); var N = JobSystemDetails_SystemBrand || 0; FillDropDown("JobSystemDetails_SystemBrand", urlGetPanelBrand2, N, !0, null), $("#JobSystemDetails_SystemBrand").change(function () { this.selectedIndex > 0 ? ($("#JobSystemDetails_SystemModel").prop("disabled", !1), FillDropDown("JobSystemDetails_SystemModel", urlGetPanelModel + $("#JobSystemDetails_SystemBrand").val() + "&JobType=2", 0, !0, null)) : $("#JobSystemDetails_SystemModel").prop("disabled", !0) }); Model_Guid, Math.round(MaxImageSize_Job / 1024e3); if ($("#JobSystemDetails_NoOfPanel").attr("data-val", "false"), "0" == $("#BasicDetails_JobID").val()) $("#JobPanelDetails_NoOfPanel").val(""), $("#JobInstallationDetails_ExistingSystemSize").val(""), $("#JobInstallationDetails_NoOfPanels").val(""), $("#JobSystemDetails_SystemSize").val(""), $("#JobSystemDetails_CalculatedSTC").val(""), $("#JobSystemDetails_CalculatedSTCForSWH").val(""), $("#JobSystemDetails_NoOfPanel").val(""), $("#JobPanelDetails_NoOfPanel").prop("disabled", !0), $("#deletejob").hide(), $("#ExistingSystem").hide(); else { if ("0" == $("#JobPanelDetails_NoOfPanel").val() && $("#JobPanelDetails_NoOfPanel").val(""), $("#JobPanelDetails_NoOfPanel").prop("disabled", !0), "0.00" == $("#JobInstallationDetails_ExistingSystemSize").val() && $("#JobInstallationDetails_ExistingSystemSize").val(""), "0" == $("#JobInstallationDetails_NoOfPanels").val() && $("#JobInstallationDetails_NoOfPanels").val(""), "0.00" == $("#JobSystemDetails_CalculatedSTC").val() && $("#JobSystemDetails_CalculatedSTC").val(""), "0.00" == $("#JobSystemDetails_CalculatedSTCForSWH").val() && $("#JobSystemDetails_CalculatedSTCForSWH").val(""), "0" == $("#JobSystemDetails_NoOfPanel").val() && $("#JobSystemDetails_NoOfPanel").val(""), "0.00" == $("#JobSystemDetails_SystemSize").val() && $("#JobSystemDetails_SystemSize").val(""), "1" == JOBType && ("Yes" == JobSTCDetails_MultipleSGUAddress ? $("#STCLocation").show() : $("#STCLocation").hide()), $("#InvoiceStartDate").val("").removeAttr("value"), "Replacing" != JobInstallationDetails_InstallingNewPanel && "Adding" != JobInstallationDetails_InstallingNewPanel && "Extension" != JobInstallationDetails_InstallingNewPanel || $("#installationLocation").show(), 4 == USERType || 8 == USERType && "False" == IsUnderSSC ? $("#deletejob").show() : $("#deletejob").hide(), $("#BasicDetails_JobType").prop("disabled", !0), JobElectricians_Signature) { $("#imgSign").attr("src", JobElectricians_Signature); var P = $("#imgSign").attr("src"), E = Model_Guid, A = UploadedDocumentPath; SRCSign = A + "JobDocuments/" + E + "/" + P, $("#imgSign").attr("class", P), $("#imgSignature").show() } var C, O; if (null != SRCOwnerSign && "" != SRCOwnerSign && (SRCOwnerSign = signatureURL + SRCOwnerSign, $("#imgOwnerSignatureView").show()), $("#imgOwnerSignatureView").click(function () { $("#loading-image").css("display", ""), $("#imgOwnerSign").attr("src", SRCOwnerSign).load(function () { logoWidth1 = this.width, logoHeight1 = this.height, $("#popupOwnerSign").modal({ backdrop: "static", keyboard: !1 }), $(window).height() <= logoHeight1 ? ($("#imgOwnerSign").closest("div").height($(window).height() - 150), $("#imgOwnerSign").closest("div").css("overflow-y", "scroll"), $("#imgOwnerSign").height(logoHeight1)) : ($("#imgOwnerSign").height(logoHeight1), $("#imgOwnerSign").closest("div").removeAttr("style")), screen.width <= logoWidth1 || logoWidth1 >= screen.width - 250 ? ($("#popupOwnerSign").find(".modal-dialog").width(screen.width - 250), $("#imgOwnerSign").width(logoWidth1)) : ($("#imgOwnerSign").width(logoWidth1), $("#popupOwnerSign").find(".modal-dialog").width(logoWidth1)), $("#loading-image").css("display", "none") }), $("#imgOwnerSign").unbind("error"), $("#imgOwnerSign").attr("src", SRCOwnerSign).error(function () { alert("Image does not exist."), $("#loading-image").css("display", "none") }) }), $("#btnClosepopupOwnerSign").click(function () { $("#popupOwnerSign").modal("toggle") }), $("#btnClosePopupSign").click(function () { $("#popupSign").modal("toggle") }), $("#tblPanel tr").each(function () { $("#gridPanel").show(); var e = $(this).find("td").eq(0).attr("class"), t = $(this).find("td").eq(1).attr("class"), a = $(this).find("td").eq(2).attr("class"), l = $(this).find("td").eq(3).attr("data-supplier"), i = $(this).find("td").eq(3).attr("class"); PanelXml.push({ ID: i, Brand: e, Model: t, Count: a, Supplier: l }) }), $("#tblInverter tr").each(function () { $("#gridInverter").show(); var e = $(this).find("td").eq(0).attr("class"), t = $(this).find("td").eq(1).attr("class"), a = $(this).find("td").eq(2).attr("class"), l = $(this).find("td").eq(3).attr("class"); InverterXml.push({ ID: l, Brand: e, Series: t, Model: a }) }), $("#tblBatteryManufacturer tr").each(function () { $("#gridBattery").show(); var e = $(this).find("td").eq(0).attr("class"), t = $(this).find("td").eq(1).attr("class"), a = $(this).find("td").eq(2).attr("class"); batteryXml.push({ JobBatteryManufacturerId: a, Manufacturer: e, ModelNumber: t }) }), 1 == JobOwnerDetails_AddressID ? ($(".OwnerDPA").show(), $(".OwnerPDA").hide()) : ($(".OwnerPDA").show(), $(".OwnerDPA").hide()), 1 == JobInstallerDetails_AddressID ? ($(".InstallerDPA").show(), $(".InstallerPDA").hide()) : ($(".InstallerPDA").show(), $(".InstallerDPA").hide()), 1 == JobInstallationDetails_AddressID ? ($(".InstallationDPA").show(), $(".InstallationPDA").hide()) : ($(".InstallationPDA").show(), $(".InstallationDPA").hide()), 1 == JobElectricians_AddressID ? ($(".ElectriciansDPA").show(), $(".ElectriciansPDA").hide()) : ($(".ElectriciansPDA").show(), $(".ElectriciansDPA").hide()), "2" == JOBType ? ($("#TypeOfConnection,#JobSTCDetails_TypeOfConnection,#SystemMountingType,#JobSTCDetails_SystemMountingType").hide(), $("#DeemingPeriod,#JobSTCDetails_DeemingPeriod,#InstallerID,#BasicDetails_InstallerID,#DesignerID,#BasicDetails_DesignerID").hide(), $("#NMI,#JobInstallationDetails_NMI,#InstallingNewPanel,#InstallingNewPanel,#InstallingNewPanel,#JobInstallationDetails_InstallingNewPanel,#MeterNumber,#JobInstallationDetails_MeterNumber,#PhaseProperty,#JobInstallationDetails_PhaseProperty,#ElectricityProviderID,#JobInstallationDetails_ElectricityProviderID,#ExistingSystem1,#JobInstallationDetails_ExistingSystem,#ExistingSystem").hide(), $("#installContent").show(), $(".SWSystemDetails").show(), $(".PVDSystemDetail").hide(), $("#serialNumberLable").html("Tank serial number(s):"), $("#MultipleSGUAddress").html("Is there more than one SWH/ASHP at this address:"), $("#CertificateCreated").html("Creating certificates for previously failed SWH:"), $("#divVolumetricCapacity").show(), $("#divSecondhandWaterHeater").show(), $("#JobSystemDetails_NoOfPanel").removeAttr("readonly"), $("#electricianDetail").hide(), "Yes" == JobSTCDetails_VolumetricCapacity && $("#divStatutoryDeclarations").show()) : "1" == JOBType && ($("#TypeOfConnection,#JobSTCDetails_TypeOfConnection,#SystemMountingType,#JobSTCDetails_SystemMountingType").show(), $("#DeemingPeriod,#JobSTCDetails_DeemingPeriod,#InstallerID,#BasicDetails_InstallerID,#DesignerID,#BasicDetails_DesignerID").show(), $("#NMI,#JobInstallationDetails_NMI,#InstallingNewPanel,#InstallingNewPanel,#InstallingNewPanel,#JobInstallationDetails_InstallingNewPanel,#MeterNumber,#JobInstallationDetails_MeterNumber,#PhaseProperty,#JobInstallationDetails_PhaseProperty,#ElectricityProviderID,#JobInstallationDetails_ElectricityProviderID,#ExistingSystem1,#JobInstallationDetails_ExistingSystem").show(), $("#installContent").hide(), $("#serialNumberLable").html("Equipment model serial number(s):"), $("#MultipleSGUAddress").html("Is there more than one SGU at this address?:"), $("#CertificateCreated").html("Are you creating certificates for a system that has previously been failed by the Clean Energy Regulator?:"), $(".SWSystemDetails").hide(), $(".PVDSystemDetail").show(), $("#divVolumetricCapacity").hide(), $("#divStatutoryDeclarations").hide(), $("#divSecondhandWaterHeater").hide(), $("#JobSystemDetails_NoOfPanel").attr("readonly"), $("#electricianDetail").show()), "Government body" == $("#JobOwnerDetails_OwnerType").val() || "Corporate body" == $("#JobOwnerDetails_OwnerType").val() || "Trustee" == $("#JobOwnerDetails_OwnerType").val()) C = $("#JobOwnerDetails_CompanyName").val(); else C = $("#JobOwnerDetails_FirstName").val() + " " + $("#JobOwnerDetails_LastName").val(); $("#txtClientName").val(C), $("#spantxtClientNames").hide(), O = $("#JobInstallerDetails_FirstName").val() + " " + $("#JobInstallerDetails_Surname").val(), $("#txtInstallerName").val(O), "False" == JobInstallationDetails_ExistingSystem ? $("#ExistingSystem").hide() : $("#ExistingSystem").show(), "False" == BasicDetails_IsGst ? $("#jobGST").hide() : $("#jobGST").show(), "No" == JobSTCDetails_CertificateCreated ? ($("#FailedAccreditationCode").hide(), $("#JobSTCDetails_FailedAccreditationCode").hide(), $("#FailedReason").hide(), $("#JobSTCDetails_FailedReason").hide()) : "Yes" == JobSTCDetails_CertificateCreated && ($("#FailedAccreditationCode").show(), $("#JobSTCDetails_FailedAccreditationCode").show(), $("#FailedReason").show(), $("#JobSTCDetails_FailedReason").show()), $("#JobSystemDetails_SystemModel").prop("disabled", !1); var M = JobSystemDetails_SystemModel || 0; FillDropDown("JobSystemDetails_SystemModel", urlGetPanelModel + JobSystemDetails_SystemBrand + "&JobType=" + JOBType, M, !0, null), 1 == JOBType && (8 == USERType && "True" == IsUnderSSC && ($("#JobInstallationDetails_IsSameAsOwnerAddress").attr("disabled", "disabled"), $("#JobInstallationDetails_ExistingSystem").attr("disabled", "disabled"), $("#JobOwner").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#JobOwner").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#JobInstallationAddress").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#JobInstallationAddress").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#frmCreateJob").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#frmCreateJob").find("textarea").each(function () { $(this).attr("Readonly", "true") }), $("#frmCreateJob").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#BasicDetails_strInstallationDate").attr("disabled", "disabled"), $("#JobInstallationAddress").find("button[type=button]").each(function () { $(this).hide() }), $("#JobOwner").find("button[type=button]").each(function () { $(this).hide() }), $("#btnCalculatedSTC").hide(), $("#btnAddPanel").hide(), $("#btnAddInverter").hide(), $("#BasicDetails_InstallerID").removeAttr("disabled"), $("#BasicDetails_DesignerID").removeAttr("disabled"), $("#JobElectricians_InstallerID").removeAttr("disabled"), $("#JobElectricians_CompanyName").removeAttr("Readonly"), $("#JobElectricians_FirstName").removeAttr("Readonly"), $("#JobElectricians_LastName").removeAttr("Readonly"), $("#JobElectricians_Email").removeAttr("Readonly"), $("#JobElectricians_Phone").removeAttr("Readonly"), $("#JobElectricians_Mobile").removeAttr("Readonly"), $("#JobElectricians_LicenseNumber").removeAttr("Readonly")), 7 != USERType && 9 != USERType || ($("#JobInstallationDetails_IsSameAsOwnerAddress").attr("disabled", "disabled"), $("#JobInstallationDetails_ExistingSystem").attr("disabled", "disabled"), $("#JobElectricians").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#JobElectricians").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#JobOwner").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#JobOwner").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#JobInstallationAddress").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#JobInstallationAddress").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#frmCreateJob").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#frmCreateJob").find("textarea").each(function () { $(this).attr("Readonly", "true") }), $("#frmCreateJob").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#JobElectricians").find("button[type=button]").each(function () { $(this).hide() }), $("#JobInstallationAddress").find("button[type=button]").each(function () { $(this).hide() }), $("#JobOwner").find("button[type=button]").each(function () { $(this).hide() }), $("#divUpload").hide(), $("#btnCalculatedSTC").hide(), $("#btnAddPanel").hide(), $("#btnAddInverter").hide(), $("#BasicDetails_strInstallationDate").removeAttr("Readonly"), $("#BasicDetails_JobStage").removeAttr("disabled")), 2 != USERType && 5 != USERType || ($("#JobInstallationDetails_IsSameAsOwnerAddress").attr("disabled", "disabled"), $("#JobInstallationDetails_ExistingSystem").attr("disabled", "disabled"), $("#JobElectricians").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#JobElectricians").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#JobOwner").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#JobOwner").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#JobInstallationAddress").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#JobInstallationAddress").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#frmCreateJob").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#frmCreateJob").find("textarea").each(function () { $(this).attr("Readonly", "true") }), $("#frmCreateJob").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#BasicDetails_strInstallationDate").attr("disabled", "disabled"), $("#JobElectricians").find("button[type=button]").each(function () { $(this).hide() }), $("#JobInstallationAddress").find("button[type=button]").each(function () { $(this).hide() }), $("#JobOwner").find("button[type=button]").each(function () { $(this).hide() }), $("#divUpload").hide(), $("#btnCalculatedSTC").hide(), $("#btnAddPanel").hide(), $("#btnAddInverter").hide(), $("#btnMainCancel").hide())), 2 == JOBType && ((7 == USERType || 9 == USERType || 8 == USERType && "True" == IsUnderSSC) && ($("#JobInstallationDetails_IsSameAsOwnerAddress").attr("disabled", "disabled"), $("#JobInstallationDetails_ExistingSystem").attr("disabled", "disabled"), $("#JobElectricians").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#JobElectricians").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#JobOwner").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#JobOwner").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#JobInstallationAddress").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#JobInstallationAddress").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#frmCreateJob").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#frmCreateJob").find("textarea").each(function () { $(this).attr("Readonly", "true") }), $("#frmCreateJob").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#BasicDetails_strInstallationDate").attr("disabled", "disabled"), $("#JobElectricians").find("button[type=button]").each(function () { $(this).hide() }), $("#JobInstallationAddress").find("button[type=button]").each(function () { $(this).hide() }), $("#JobOwner").find("button[type=button]").each(function () { $(this).hide() }), $("#divUpload").hide(), $("#btnCalculatedSTCSWH").hide(), $("#btnAddPanel").hide(), $("#btnAddInverter").hide(), $("#BasicDetails_strInstallationDate").removeAttr("Readonly"), $("#BasicDetails_JobStage").removeAttr("disabled")), 2 != USERType && 5 != USERType || ($("#JobInstallationDetails_IsSameAsOwnerAddress").attr("disabled", "disabled"), $("#JobInstallationDetails_ExistingSystem").attr("disabled", "disabled"), $("#JobElectricians").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#JobElectricians").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#JobOwner").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#JobOwner").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#JobInstallationAddress").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#JobInstallationAddress").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#Installer").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#Installer").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#frmCreateJob").find("input[type=text]").each(function () { $(this).attr("Readonly", "true") }), $("#frmCreateJob").find("textarea").each(function () { $(this).attr("Readonly", "true") }), $("#frmCreateJob").find("Select").each(function () { $(this).attr("disabled", "disabled") }), $("#BasicDetails_strInstallationDate").attr("disabled", "disabled"), $("#JobElectricians").find("button[type=button]").each(function () { $(this).hide() }), $("#JobInstallationAddress").find("button[type=button]").each(function () { $(this).hide() }), $("#Installer").find("button[type=button]").each(function () { $(this).hide() }), $("#Installer").find("button[type=button]").each(function () { $(this).hide() }), $("#divUpload").hide(), $("#btnCalculatedSTCSWH").hide(), $("#btnAddPanel").hide(), $("#btnAddInverter").hide(), $("#btnMainCancel").hide())) } $("#imgSignature").click(function () { $("#loading-image").css("display", ""), $("#imgSign").attr("src", SRCSign).load(function () { logoWidth = this.width, logoHeight = this.height, $("#popupbox").modal({ backdrop: "static", keyboard: !1 }), $(window).height() <= logoHeight ? ($("#imgSign").closest("div").height($(window).height() - 205), $("#imgSign").closest("div").css("overflow-y", "scroll"), $("#imgSign").height(logoHeight)) : ($("#imgSign").height(logoHeight), $("#imgSign").closest("div").removeAttr("style")), screen.width <= logoWidth || logoWidth >= screen.width - 250 ? ($("#popupbox").find(".modal-dialog").width(screen.width - 250), $("#imgSign").width(logoWidth)) : ($("#imgSign").width(logoWidth), $("#popupbox").find(".modal-dialog").width(logoWidth)), $("#loading-image").css("display", "none") }), $("#imgSign").unbind("error"), $("#imgSign").attr("src", SRCSign).error(function () { alert("Image does not exist."), $("#loading-image").css("display", "none") }) }), $("#btnClosePopUpBox").click(function () { $("#popupbox").modal("toggle") }), $("#BasicDetails_JobType").change(function (e) { jobChange(), "1" != this.value && "2" != this.value || $.ajax({ url: urlGetJobNumber + this.value, type: "GET", dataType: "json", contentType: "application/json; charset=utf-8", processData: !1, cache: !1, async: !0, success: function (e) { $("#BasicDetails_JobNumber").val(e) } }) }), $("#JobSTCDetails_CertificateCreated").change(function (e) { $("#spanFailedAccreditationCode").hide(), $("#JobSTCDetails_FailedAccreditationCode").val(""), $("#JobSTCDetails_FailedReason").val(""), "No" == this.value ? ($("#FailedAccreditationCode").hide(), $("#JobSTCDetails_FailedAccreditationCode").hide(), $("#FailedReason").hide(), $("#JobSTCDetails_FailedReason").hide()) : "Yes" == this.value && ($("#FailedAccreditationCode").show(), $("#JobSTCDetails_FailedAccreditationCode").show(), $("#FailedReason").show(), $("#JobSTCDetails_FailedReason").show()) }), $("ul#SaveJob").on("click", "li", function () { fillElectrianPopup(), fillOwnerPopup(), fillInstallationPopup(), $("#BasicDetails_JobType").val(), $(".sidebar-list").show(), "Commercial" == $("#JobInstallationDetails_PropertyType").val() || "School" == $("#JobInstallationDetails_PropertyType").val() ? $(".isGSTRegistered").show() : $(".isGSTRegistered").hide(), $(".menuheader").addClass("openheader"), jobChange(), $("#JobInstallationDetails_ExistingSystem").change(); var e, t = SerialNumbersValidation(), a = CheckShowErrorMessagesForPopup(), l = $("#frmCreateJob").valid(); e = 1 == $("#BasicDetails_JobType").val() ? !!($("#BasicDetails_strInstallationDate").val() && $("#JobSTCDetails_DeemingPeriod").val() && $("#JobInstallationDetails_PostCode").val()) : !!($("#JobSystemDetails_SystemBrand").val() && $("#JobSystemDetails_SystemModel").val() && $("#JobInstallationDetails_PostCode").val()); var i, s = $("#JobSystemDetails_SystemSize").val() > 0, n = !!$("#BasicDetails_strInstallationDate").val(); i = 1 == $("#BasicDetails_JobType").val() ? !s || s && e : !n || n && e, l && a && t ? i ? ($("#loading-image").show(), jobSaveType = $(this).index(), checkBusinessRules($(this).index(), !1)) : 1 == $("#BasicDetails_JobType").val() ? jobErrorMessage("Please fill Installation Date, STC DeemingPeriod, Installation postcode to set STC value.") : jobErrorMessage("Please fill Installation Date, System brand, System Model, Installation postcode to set STC value.") : jobErrorMessage("Please fill  all required fields.") }), Array.prototype.pushArray = function () { for (var e = this.concat.apply([], arguments), t = 0, a = e.length; t < a; ++t)this.push(e[t]) }, $.fn.serializeToJson = function () { var e = $(this[0]), t = $("#addressPopup"), a = $("#JobElectricians"), l = $("#JobOwner"), i = $("#JobInstallationAddress"), s = $("#Installer"), n = $("#SoldBy"), o = e.serializeArray(); o.pushArray(t.serializeArray()), o.pushArray(a.serializeArray()), o.pushArray(l.serializeArray()), o.pushArray(i.serializeArray()), o.pushArray(s.serializeArray()), o.pushArray(n.serializeArray()); var r = {}, d = []; return $.each(o, function (e, t) { if ("BasicDetails.strInstallationDate" == t.name && "" != t.value && null != t.value && null != t.value) { var a = ConvertDateToTick(t.value, GetDateFormat); installationDateSerialize = moment(a).format("YYYY-MM-DD"), t.value = installationDateSerialize } if ("BasicDetails.strSoldByDate" == t.name && "" != t.value && null != t.value && null != t.value) { var l = ConvertDateToTick(t.value, GetDateFormat); soldbyDatSerialize = moment(l).format("YYYY-MM-DD"), t.value = soldbyDatSerialize } if (-1 != t.name.indexOf(".")) { var i = t.name.split("."); d.indexOf(i[0]) < 0 && d.push(i[0]); var s = r[d[d.indexOf(i[0])]] || {}; s[i[1]] || (s[i[1]] = t.value), r[d[d.indexOf(i[0])]] = s } else r[t.name] || (r[t.name] = t.value) }), r }, $("#JobInstallationDetails_ExistingSystem").change(function () { $(this).is(":checked") ? $("#ExistingSystem").show() : $("#ExistingSystem").hide() }), $("#BasicDetails_IsGst").change(function () { $("#tblDocuments").find("tr").each(function () { $(this).remove() }), $(this).is(":checked") ? $("#jobGST").show() : $("#jobGST").hide() }), $("#JobInstallationDetails_Town").autocomplete({ minLength: 3, source: function (e, t) { $.ajax({ type: "GET", url: urlProcessRequest, dataType: "json", data: { excludePostBoxFlag: !0, q: e.term }, success: function (e) { var a = JSON.parse(e); a.localities.locality instanceof Array ? t($.map(a.localities.locality, function (e) { return { label: e.location + ", " + e.state + ", " + e.postcode, value: e.location, state: e.state, postcode: e.postcode } })) : t($.map(a.localities, function (e) { return { label: e.location + ", " + e.state + ", " + e.postcode, value: e.location, state: e.state, postcode: e.postcode } })) } }) }, select: function (e, t) { $("#JobInstallationDetails_State").val(t.item.state), $("#JobInstallationDetails_PostCode").val(t.item.postcode) } }), $("#JobInstallationDetails_PostCode").autocomplete({ minLength: 3, source: function (e, t) { $.ajax({ type: "GET", url: urlProcessRequest, dataType: "json", data: { excludePostBoxFlag: !0, q: e.term }, success: function (e) { var a = JSON.parse(e); a.localities.locality instanceof Array ? t($.map(a.localities.locality, function (e) { return { label: e.location + ", " + e.state + ", " + e.postcode, value: e.postcode, state: e.state, location: e.location } })) : t($.map(a.localities, function (e) { return { label: e.location + ", " + e.state + ", " + e.postcode, value: e.postcode, state: e.state, location: e.location } })) } }) }, select: function (e, t) { $("#JobInstallationDetails_State").val(t.item.state), $("#JobInstallationDetails_Town").val(t.item.location) } }), $("#JobOwnerDetails_Town").autocomplete({ minLength: 3, source: function (e, t) { $.ajax({ type: "GET", url: urlProcessRequest, dataType: "json", data: { excludePostBoxFlag: !0, q: e.term }, success: function (e) { var a = JSON.parse(e); a.localities.locality instanceof Array ? t($.map(a.localities.locality, function (e) { return { label: e.location + ", " + e.state + ", " + e.postcode, value: e.location, state: e.state, postcode: e.postcode } })) : t($.map(a.localities, function (e) { return { label: e.location + ", " + e.state + ", " + e.postcode, value: e.location, state: e.state, postcode: e.postcode } })) } }) }, select: function (e, t) { $("#JobOwnerDetails_State").val(t.item.state), $("#JobOwnerDetails_PostCode").val(t.item.postcode) } }), $("#JobOwnerDetails_PostCode").autocomplete({ minLength: 3, source: function (e, t) { $.ajax({ type: "GET", url: urlProcessRequest, dataType: "json", data: { excludePostBoxFlag: !0, q: e.term }, success: function (e) { var a = JSON.parse(e); a.localities.locality instanceof Array ? t($.map(a.localities.locality, function (e) { return { label: e.location + ", " + e.state + ", " + e.postcode, value: e.postcode, state: e.state, location: e.location } })) : t($.map(a.localities, function (e) { return { label: e.location + ", " + e.state + ", " + e.postcode, value: e.postcode, state: e.state, location: e.location } })) } }) }, select: function (e, t) { $("#JobOwnerDetails_State").val(t.item.state), $("#JobOwnerDetails_Town").val(t.item.location) } }), $("#JobElectricians_Town").autocomplete({ minLength: 3, source: function (e, t) { $.ajax({ type: "GET", url: urlProcessRequest, dataType: "json", data: { excludePostBoxFlag: !0, q: e.term }, success: function (e) { var a = JSON.parse(e); console.log(a), a.localities.locality instanceof Array ? t($.map(a.localities.locality, function (e) { return { label: e.location + ", " + e.state + ", " + e.postcode, value: e.location, state: e.state, postcode: e.postcode } })) : t($.map(a.localities, function (e) { return { label: e.location + ", " + e.state + ", " + e.postcode, value: e.location, state: e.state, postcode: e.postcode } })) } }) }, select: function (e, t) { $("#JobElectricians_State").val(t.item.state), $("#JobElectricians_PostCode").val(t.item.postcode) } }), $("#JobElectricians_PostCode").autocomplete({ minLength: 3, source: function (e, t) { $.ajax({ type: "GET", url: urlProcessRequest, dataType: "json", data: { excludePostBoxFlag: !0, q: e.term }, success: function (e) { var a = JSON.parse(e); a.localities.locality instanceof Array ? t($.map(a.localities.locality, function (e) { return { label: e.location + ", " + e.state + ", " + e.postcode, value: e.postcode, state: e.state, location: e.location } })) : t($.map(a.localities, function (e) { return { label: e.location + ", " + e.state + ", " + e.postcode, value: e.postcode, state: e.state, location: e.location } })) } }) }, select: function (e, t) { $("#JobElectricians_State").val(t.item.state), $("#JobElectricians_Town").val(t.item.location) } }), $("#JobInstallerDetails_Town").autocomplete({ minLength: 3, source: function (e, t) { $.ajax({ type: "GET", url: urlProcessRequest, dataType: "json", data: { excludePostBoxFlag: !0, q: e.term }, success: function (e) { var a = JSON.parse(e); a.localities.locality instanceof Array ? t($.map(a.localities.locality, function (e) { return { label: e.location + ", " + e.state + ", " + e.postcode, value: e.location, state: e.state, postcode: e.postcode } })) : t($.map(a.localities, function (e) { return { label: e.location + ", " + e.state + ", " + e.postcode, value: e.location, state: e.state, postcode: e.postcode } })) } }) }, select: function (e, t) { $("#JobInstallerDetails_State").val(t.item.state), $("#JobInstallerDetails_PostCode").val(t.item.postcode) } }), $("#JobInstallerDetails_PostCode").autocomplete({ minLength: 3, source: function (e, t) { $.ajax({ type: "GET", url: urlProcessRequest, dataType: "json", data: { excludePostBoxFlag: !0, q: e.term }, success: function (e) { var a = JSON.parse(e); a.localities.locality instanceof Array ? t($.map(a.localities.locality, function (e) { return { label: e.location + ", " + e.state + ", " + e.postcode, value: e.postcode, state: e.state, location: e.location } })) : t($.map(a.localities, function (e) { return { label: e.location + ", " + e.state + ", " + e.postcode, value: e.postcode, state: e.state, location: e.location } })) } }) }, select: function (e, t) { $("#JobInstallerDetails_State").val(t.item.state), $("#JobInstallerDetails_Town").val(t.item.location) } }), $("#btnAddressDetail").click(function () { $("#popupAddress").modal({ backdrop: "static", keyboard: !1 }), setTimeout(function () { $("#JobInstallationDetails_AddressID").focus() }, 1e3), $(".popupAddress").find("input[type=text]").each(function () { $(this).attr("class", "form-control valid") }), $(".popupAddress").find(".field-validation-error").attr("class", "field-validation-valid"), $.each(InstallationJson, function (e, t) { $("#JobInstallationDetails_AddressID").val(t.PostalAddressType), $("#JobInstallationDetails_UnitNumber").val(t.UnitNumber), $("#JobInstallationDetails_UnitTypeID").val(t.UnitType), $("#JobInstallationDetails_StreetNumber").val(t.StreetNumber), $("#JobInstallationDetails_StreetName").val(t.StreetName), $("#JobInstallationDetails_StreetTypeID").val(t.StreetType), $("#JobInstallationDetails_Town").val(t.Town), $("#JobInstallationDetails_State").val(t.State), $("#JobInstallationDetails_PostCode").val(t.PostCode), $("#JobInstallationDetails_PostalDeliveryNumber").val(t.PostalDeliveryNumber), $("#JobInstallationDetails_PostalAddressID").val(t.PostalAddressID) }), "" == $("#JobInstallationDetails_UnitTypeID option:selected").val() ? ($("#lblInstallationUnitNumber").removeClass("required"), $("#lblInstallationUnitTypeID").removeClass("required"), $("#lblInstallationStreetNumber").addClass("required")) : ($("#lblInstallationUnitNumber").addClass("required"), $("#lblInstallationUnitTypeID").addClass("required")), 1 == $("#JobInstallationDetails_AddressID").val() ? ($(".InstallationDPA").show(), $(".InstallationPDA").hide()) : ($(".InstallationPDA").show(), $(".InstallationDPA").hide()) }), $("#btnClearInsatallerDetail").click(function () { var e; clearPopupInstaller(), InstallerJson = [], e = $("#JobInstallerDetails_FirstName").val() + " " + $("#JobInstallerDetails_Surname").val(), $("#spantxtClientNames").hide(), $("#txtInstallerName").val(e), 1 == $("#JobInstallerDetails_AddressID").val() ? InstallerJson.push({ Phone: $("#JobInstallerDetails_Phone").val(), Mobile: $("#JobInstallerDetails_Mobile").val(), FirstName: $("#JobInstallerDetails_FirstName").val(), Surname: $("#JobInstallerDetails_Surname").val(), Email: $("#JobInstallerDetails_Email").val(), PostalAddressType: $("#JobInstallerDetails_AddressID").val(), UnitType: $("#JobInstallerDetails_UnitTypeID").val(), UnitNumber: $("#JobInstallerDetails_UnitNumber").val(), StreetNumber: $("#JobInstallerDetails_StreetNumber").val(), StreetName: $("#JobInstallerDetails_StreetName").val(), StreetType: $("#JobInstallerDetails_StreetTypeID").val(), Town: $("#JobInstallerDetails_Town").val(), State: $("#JobInstallerDetails_State").val(), PostCode: $("#JobInstallerDetails_PostCode").val() }) : InstallerJson.push({ Phone: $("#JobInstallerDetails_Phone").val(), Mobile: $("#JobInstallerDetails_Mobile").val(), FirstName: $("#JobInstallerDetails_FirstName").val(), Surname: $("#JobInstallerDetails_Surname").val(), Email: $("#JobInstallerDetails_Email").val(), PostalAddressType: $("#JobInstallerDetails_AddressID").val(), PostalAddressID: $("#JobInstallerDetails_PostalAddressID").val(), PostalDeliveryNumber: $("#JobInstallerDetails_PostalDeliveryNumber").val(), Town: $("#JobInstallerDetails_Town").val(), State: $("#JobInstallerDetails_State").val(), PostCode: $("#JobInstallerDetails_PostCode").val() }), InstallerEmailFromJson = $("#JobInstallerDetails_Email").val(), InstallerFirstNameFromJson = $("#JobInstallerDetails_FirstName").val(), InstallerLastNameFromJson = $("#JobInstallerDetails_Surname").val() }), $("#btnClearBasicAddressDetail").click(function () { clearPopupBasicAddress(), ElectrianAddressJson = []; var e = $("#JobElectricians_UnitTypeID").find("option:selected").text(), t = $("#JobElectricians_UnitNumber").val(), a = $("#JobElectricians_StreetNumber").val(), l = $("#JobElectricians_StreetName").val(), i = $("#JobElectricians_StreetTypeID").find("option:selected").text(), s = $("#JobElectricians_PostalAddressID").find("option:selected").text(), n = $("#JobElectricians_PostalDeliveryNumber").val(), o = $("#JobElectricians_Town").val(), r = $("#JobElectricians_State").val(), d = $("#JobElectricians_PostCode").val(), c = $("#JobElectricians_CompanyName").val(), u = $("#JobElectricians_FirstName").val(), b = $("#JobElectricians_LastName").val(), D = $("#JobElectricians_Email").val(), m = $("#JobElectricians_Phone").val(), p = $("#JobElectricians_Mobile").val(), v = $("#JobElectricians_LicenseNumber").val(); 1 == $("#JobElectricians_AddressID").val() ? ("" != t ? (e + " " + t + "/" + a + " " + l + " " + i + ", " + o + " " + r + " " + d).replace("Select", "") : (e + " " + a + " " + l + " " + i + ", " + o + " " + r + " " + d).replace("Select", ""), ElectrianAddressJson.push({ PostalAddressType: $("#JobElectricians_AddressID").val(), UnitType: $("#JobElectricians_UnitTypeID").val(), UnitNumber: $("#JobElectricians_UnitNumber").val(), StreetNumber: $("#JobElectricians_StreetNumber").val(), StreetName: $("#JobElectricians_StreetName").val(), StreetType: $("#JobElectricians_StreetTypeID").val(), Town: $("#JobElectricians_Town").val(), State: $("#JobElectricians_State").val(), PostCode: $("#JobElectricians_PostCode").val(), CompanyName: c, FirstName: u, LastName: b, Email: D, Phone: m, Mobile: p, LicenseNumber: v })) : (s + " " + n + ", " + o + " " + r + " " + d, ElectrianAddressJson.push({ PostalAddressType: $("#JobElectricians_AddressID").val(), PostalAddressID: $("#JobElectricians_PostalAddressID").val(), PostalDeliveryNumber: $("#JobElectricians_PostalDeliveryNumber").val(), Town: $("#JobElectricians_Town").val(), State: $("#JobElectricians_State").val(), PostCode: $("#JobElectricians_PostCode").val(), CompanyName: c, FirstName: u, LastName: b, Email: D, Phone: m, Mobile: p, LicenseNumber: v })), $("#txtBasicAddress").val($("#JobElectricians_FirstName").val() + " " + $("#JobElectricians_LastName").val()), $("#spantxtBasicAddress").hide() }), $("#btnBasicAddressDetail").click(function () { $("#popupBasicAddress").modal({ backdrop: "static", keyboard: !1 }), setTimeout(function () { $("#JobElectricians_InstallerID").focus() }, 1e3), $(".popupBasicAddress").find("input[type=text]").each(function () { $(this).attr("class", "form-control valid") }), $(".popupBasicAddress").find(".field-validation-error").attr("class", "field-validation-valid"), $.each(ElectrianAddressJson, function (e, t) { $("#JobElectricians_CompanyName").val(t.CompanyName), $("#JobElectricians_FirstName").val(t.FirstName), $("#JobElectricians_LastName").val(t.LastName), $("#JobElectricians_Email").val(t.Email), $("#JobElectricians_Phone").val(t.Phone), $("#JobElectricians_Mobile").val(t.Mobile), $("#JobElectricians_LicenseNumber").val(t.LicenseNumber), $("#JobElectricians_AddressID").val(t.PostalAddressType), $("#JobElectricians_UnitNumber").val(t.UnitNumber), $("#JobElectricians_UnitTypeID").val(t.UnitType), $("#JobElectricians_StreetNumber").val(t.StreetNumber), $("#JobElectricians_StreetName").val(t.StreetName), $("#JobElectricians_StreetTypeID").val(t.StreetType), $("#JobElectricians_Town").val(t.Town), $("#JobElectricians_State").val(t.State), $("#JobElectricians_PostCode").val(t.PostCode), $("#JobElectricians_PostalDeliveryNumber").val(t.PostalDeliveryNumber), $("#JobElectricians_PostalAddressID").val(t.PostalAddressID) }), "" == $("#JobElectricians_UnitTypeID option:selected").val() ? ($("#lblElectriciansUnitNumber").removeClass("required"), $("#lblElectriciansUnitTypeID").removeClass("required"), $("#lblElectriciansStreetNumber").addClass("required")) : ($("#lblElectriciansUnitNumber").addClass("required"), $("#lblElectriciansUnitTypeID").addClass("required"), $("#lblElectriciansStreetNumber").removeClass("required")), 1 == $("#JobElectricians_AddressID").val() ? ($(".ElectriciansDPA").show(), $(".ElectriciansPDA").hide()) : ($(".ElectriciansPDA").show(), $(".ElectriciansDPA").hide()) }); var U = !1; function B() { function e() { return Math.floor(65536 * (1 + Math.random())).toString(16).substring(1) } return e() + e() + "-" + e() + "-" + e() + "-" + e() + "-" + e() + e() + e() } window.mapsCallback = function () { U = !0, loadMap() }, $("#btnMap").click(function () { if (U) loadMap(); else { var e = document.createElement("script"); e.type = "text/javascript", e.async = !1, e.src = JobMapKeyUrl.toString().replace(/&amp;/g, "&"), document.body.appendChild(e) } $("#popupMap").modal({ backdrop: "static", keyboard: !1 }), setTimeout(function () { $("#txtSource").focus() }, 1e3), $("#txtSource").val(""), $("#dvDistance").html(""), $("#errorMsgRegionMap").hide(); var t = $("#txtAddress").val(); $("#txtDestination").val(t); setTimeout(function () { 1 == ProjectSession_UserTypeId && geocodeAddress(t) }, 1e3) }), $("#btnOwnerDetails").click(function () { $("#popupOwner").modal({ backdrop: "static", keyboard: !1 }), setTimeout(function () { $("#JobOwnerDetails_OwnerType").focus(), $("#JobOwnerDetails_OwnerType").change() }, 1e3), $(".popupOwner").find("input[type=text]").each(function () { $(this).attr("class", "form-control valid") }), $(".popupOwner").find(".field-validation-error").attr("class", "field-validation-valid"), $.each(OwnerAddressJson, function (e, t) { $("#JobOwnerDetails_OwnerType").val(t.OwnerType), $("#JobOwnerDetails_CompanyName").val(t.CompanyName), $("#JobOwnerDetails_FirstName").val(t.FirstName), $("#JobOwnerDetails_LastName").val(t.LastName), $("#JobOwnerDetails_Email").val(t.Email), $("#JobOwnerDetails_Phone").val(t.Phone), $("#JobOwnerDetails_Mobile").val(t.Mobile), $("#JobOwnerDetails_AddressID").val(t.PostalAddressType), $("#JobOwnerDetails_UnitNumber").val(t.UnitNumber), $("#JobOwnerDetails_UnitTypeID").val(t.UnitType), $("#JobOwnerDetails_StreetNumber").val(t.StreetNumber), $("#JobOwnerDetails_StreetName").val(t.StreetName), $("#JobOwnerDetails_StreetTypeID").val(t.StreetType), $("#JobOwnerDetails_Town").val(t.Town), $("#JobOwnerDetails_State").val(t.State), $("#JobOwnerDetails_PostCode").val(t.PostCode), $("#JobOwnerDetails_PostalDeliveryNumber").val(t.PostalDeliveryNumber), $("#JobOwnerDetails_PostalAddressID").val(t.PostalAddressID) }), "" == $("#JobOwnerDetails_UnitTypeID option:selected").val() ? ($("#lblOwnerUnitNumber").removeClass("required"), $("#lblOwnerUnitTypeID").removeClass("required"), $("#lblOwnerStreetNumber").addClass("required")) : ($("#lblOwnerUnitNumber").addClass("required"), $("#lblOwnerUnitTypeID").addClass("required"), $("#lblOwnerStreetNumber").removeClass("required")), 1 == $("#JobOwnerDetails_AddressID").val() ? ($(".OwnerDPA").show(), $(".OwnerPDA").hide()) : ($(".OwnerPDA").show(), $(".OwnerDPA").hide()) }), $("#btnInstallerDetails").click(function () { if ($("#popupInstaller").modal({ backdrop: "static", keyboard: !1 }), setTimeout(function () { $("#JobInstallerDetails_FirstName").focus() }, 1e3), $(".popupInstaller").find("input[type=text]").each(function () { $(this).attr("class", "form-control valid") }), $(".popupInstaller").find(".field-validation-error").attr("class", "field-validation-valid"), $("#JobInstallerDetails_ElectricianID").val($("#JobInstallerDetails_SWHInstallerDesignerId").val()), $("#JobInstallerDetails_LicenseNumber").val($("#JobInstallerDetails_LicenseNumber").val()), $("#JobInstallerDetails_LicenseNumber").attr("readonly", "readonly"), $("#JobInstallerDetails_LicenseNumber").attr("onblur", ""), null != $("#JobInstallerDetails_SESignature").val() && "" != $("#JobInstallerDetails_SESignature").val()) { var e = $("#JobInstallerDetails_SESignature").val(), t = ProjectSession_LoggedInUserId, a = UploadedDocumentPath; SRCSignSWHInstall = a + "UserDocuments/" + t + "/" + e, $("#imgSignSWHInstall").attr("class", e), $("#imgSWHSignatureInstaller").show() } else $("#imgSWHSignatureInstaller").hide(); $.each(InstallerJson, function (e, t) { $("#JobInstallerDetails_FirstName").val(t.FirstName), $("#JobInstallerDetails_Surname").val(t.Surname), $("#JobInstallerDetails_Email").val(t.Email), $("#JobInstallerDetails_Phone").val(t.Phone), $("#JobInstallerDetails_Mobile").val(t.Mobile), $("#JobInstallerDetails_AddressID").val(t.PostalAddressType), $("#JobInstallerDetails_UnitNumber").val(t.UnitNumber), $("#JobInstallerDetails_UnitTypeID").val(t.UnitType), $("#JobInstallerDetails_StreetNumber").val(t.StreetNumber), $("#JobInstallerDetails_StreetName").val(t.StreetName), $("#JobInstallerDetails_StreetTypeID").val(t.StreetType), $("#JobInstallerDetails_Town").val(t.Town), $("#JobInstallerDetails_State").val(t.State), $("#JobInstallerDetails_PostCode").val(t.PostCode), $("#JobInstallerDetails_PostalDeliveryNumber").val(t.PostalDeliveryNumber), $("#JobInstallerDetails_PostalAddressID").val(t.PostalAddressID), $("#JobInstallerDetails_SolarCompanyId").val(t.SolarCompanyId), $("#JobInstallerDetails_SESignature").val(t.SESignature) }), "" == $("#JobInstallerDetails_UnitTypeID option:selected").val() ? ($("#lblInstallerUnitNumber").removeClass("required"), $("#lblInstallerUnitTypeID").removeClass("required"), $("#lblInstallerStreetNumber").addClass("required")) : ($("#lblInstallerUnitNumber").addClass("required"), $("#lblInstallerUnitTypeID").addClass("required"), $("#lblInstallerStreetNumber").removeClass("required")), 1 == $("#JobInstallerDetails_AddressID").val() ? ($(".InstallerDPA").show(), $(".InstallerPDA").hide()) : ($(".InstallerPDA").show(), $(".InstallerDPA").hide()) }), $("#JobInstallationDetails_NoOfPanels").blur(function () { parseInt($(this).val()) > 1e4 ? ($("#spanJobInstallationDetailsNoOfPanelValue").show(), $(this).val("")) : $("#spanJobInstallationDetailsNoOfPanelValue").hide(), parseInt($(this).val()) < 1 && $(this).val("") }), $("#JobSystemDetails_SystemSize").blur(function () { "" == $(this).val() || parseFloat($(this).val()) <= 0 ? $("#spanJobSystemDetails_SystemSize").show() : $("#spanJobSystemDetails_SystemSize").hide() }), $("#JobSystemDetails_SystemSize").blur(function () { "" == $(this).val() || parseFloat($(this).val()) <= 0 ? $("#spanJobSystemDetails_SystemSize").show() : $("#spanJobSystemDetails_SystemSize").hide() }), $("#JobPanelDetails_NoOfPanel").blur(function () { parseInt($(this).val()) > 1e4 ? ($("#spanNoOfPanelValue").show(), $(this).val("")) : $("#spanNoOfPanelValue").hide(), parseInt($(this).val()) < 1 && $(this).val("") }), $("#JobSystemDetails_NoOfPanel").blur(function () { parseInt($(this).val()) > 1e4 ? ($("#spanNoOfPanelSystemValue").show(), $(this).val("")) : $("#spanNoOfPanelSystemValue").hide() }), $("#JobSTCDetails_FailedAccreditationCode").blur(function () { "" != $(this).val() && null != $(this).val() && null != $(this).val() && $("#spanFailedAccreditationCode").hide() }), $("#JobSTCDetails_StatutoryDeclarations").change(function () { "Select" != $(this).val() && null != $(this).val() && null != $(this).val() && "" != $(this).val() && $("#spanStatutoryDeclarations").hide() }), $("#JobSTCDetails_VolumetricCapacity").change(function () { $("#spanStatutoryDeclarations").hide(), "Yes" == $(this).val() ? $("#divStatutoryDeclarations").show() : ($("#divStatutoryDeclarations").val($("#divStatutoryDeclarations option:first").val()), $("#divStatutoryDeclarations").hide()) }), $(".OwnerAddress").change(function () { $(".OwnerDPA").find("input[type=text]").each(function () { $(this).val(""), $(this).attr("class", "form-control valid") }), $(".OwnerDPA").find("Select").each(function () { $(this).find("option:first").attr("selected", "selected") }), $(".OwnerDPA").find(".field-validation-error").attr("class", "field-validation-valid"), $(".OwnerPDA").find("input[type=text]").each(function () { $(this).val(""), $(this).attr("class", "form-control valid") }), $(".OwnerPDA").find("Select").each(function () { $(this).find("option:first").attr("selected", "selected") }), $(".OwnerPDA").find(".field-validation-error").attr("class", "field-validation-valid"), 1 == $(this).val() ? ($(".OwnerDPA").show(), $(".OwnerPDA").hide()) : ($(".OwnerPDA").show(), $(".OwnerDPA").hide()) }), $(".InstallerAddress").change(function () { $(".InstallerDPA").find("Select").each(function () { $(this).find("option:first").attr("selected", "selected") }), $(".InstallerDPA").find("input[type=text]").each(function () { $(this).val(""), $(this).attr("class", "form-control valid") }), $(".InstallerDPA").find(".field-validation-error").attr("class", "field-validation-valid"), $(".InstallerPDA").find("Select").each(function () { $(this).find("option:first").attr("selected", "selected") }), $(".InstallerPDA").find("input[type=text]").each(function () { $(this).val(""), $(this).attr("class", "form-control valid") }), $(".InstallerPDA").find(".field-validation-error").attr("class", "field-validation-valid"), 1 == $(this).val() ? ($(".InstallerDPA").show(), $(".InstallerPDA").hide()) : ($(".InstallerPDA").show(), $(".InstallerDPA").hide()) }), $(".InstallationAddress").change(function () { $(".InstallationDPA").find("Select").each(function () { $(this).find("option:first").attr("selected", "selected") }), $(".InstallationDPA").find("input[type=text]").each(function () { $(this).val(""), $(this).attr("class", "form-control valid") }), $(".InstallationDPA").find(".field-validation-error").attr("class", "field-validation-valid"), $(".InstallationPDA").find("Select").each(function () { $(this).find("option:first").attr("selected", "selected") }), $(".InstallationPDA").find("input[type=text]").each(function () { $(this).val(""), $(this).attr("class", "form-control valid") }), $(".InstallationPDA").find(".field-validation-error").attr("class", "field-validation-valid"), 1 == $(this).val() ? ($(".InstallationDPA").show(), $(".InstallationPDA").hide()) : ($(".InstallationPDA").show(), $(".InstallationDPA").hide()) }), $(".ElectriciansAddress").change(function () { $(".ElectriciansDPA").find("Select").each(function () { $(this).find("option:first").attr("selected", "selected") }), $(".ElectriciansDPA").find("input[type=text]").each(function () { $(this).val(""), $(this).attr("class", "form-control valid") }), $(".ElectriciansDPA").find(".field-validation-error").attr("class", "field-validation-valid"), $(".ElectriciansPDA").find("Select").each(function () { $(this).find("option:first").attr("selected", "selected") }), $(".ElectriciansPDA").find("input[type=text]").each(function () { $(this).val(""), $(this).attr("class", "form-control valid") }), $(".ElectriciansPDA").find(".field-validation-error").attr("class", "field-validation-valid"), 1 == $(this).val() ? ($(".ElectriciansDPA").show(), $(".ElectriciansPDA").hide()) : ($(".ElectriciansPDA").show(), $(".ElectriciansDPA").hide()) }), $("#btnAddPanel").click(function () { var e = $("#JobPanelDetails_Brand").val(), t = $("#JobPanelDetails_Model").val(), a = $("#JobPanelDetails_NoOfPanel").val(); if (null != e && "" != e && null != t && "" != t && null != a && "" != a && 0 != a) { var l = B(), i = "<tr id='" + l + "'>"; i += '<td class="' + e + '"  width="40%">' + e + " </td>", i += '<td class="' + t + '"  width="35%">' + t + " </td>", i += '<td class="' + a + '"  width="10%" >' + a + " </td>", i += '<td  class="action ' + l + '" id="tdAction"  width="15%"><a class="edit sprite-img" title="Edit" id="signEdit" style="cursor: pointer" href="javascript:void(0)" onclick="editPanel(\'' + l + '\')"></a>&nbsp;&nbsp;<a class="delete sprite-img" title="Delete" id="signDelete" style="cursor: pointer" onclick="DeletePanelFromGrid(\'' + l + "')\"></a></td>", i += "</tr>", $("#tblPanel").append(i), $("#gridPanel").show(); var s = 0; "" != $("#JobSystemDetails_NoOfPanel").val() && (s = $("#JobSystemDetails_NoOfPanel").val()), $("#JobSystemDetails_NoOfPanel").val(parseInt(s) + parseInt(a)), PanelXml.push({ ID: l, Brand: e, Model: t, Count: a }) } else null != e && "" != e.trim() || $("#spanJobPanelDetails_Brand").show().fadeOut(3e3), null != t && "" != t.trim() || $("#spanJobPanelDetails_Model").show().text("Panel Model  is required..").fadeOut(3e3), null != a && "" != a.trim() && "0" != a || $("#spanNoOfPanelValue").show().fadeOut(5e3) }), $("#btnAddInverter").click(function () { var e = $("#JobInverterDetails_Brand").val(), t = $("#JobInverterDetails_Model").val(), a = $("#JobInverterDetails_Series").val(); if (null != e && "" != e && null != t && "" != t && null != a && "" != a) { var l = B(), i = "<tr id='+ trId +'>"; i += '<td class="' + e + '"  width="35%">' + e + " </td>", i += '<td class="' + a + '"  width="25%">' + a + " </td>", i += '<td class="' + t + '" width="25%">' + t + " </td>", i += '<td  class="action ' + l + '" id="tdAction"  width="15%" ><a class="edit sprite-img" title="Edit" id="signEdit" style="cursor: pointer" href="javascript:void(0)" onclick="editInverter(\'' + l + '\')"></a>&nbsp;&nbsp;<a class="delete sprite-img" title="Delete" id="signDelete" style="cursor: pointer" onclick="DeleteInverterFromGrid(\'' + l + "')\"></a></td>", i += "</tr>", $("#tblInverter").append(i), $("#gridInverter").show(), InverterXml.push({ ID: l, Brand: e, Model: t, Series: a }) } else null != e && "" != e.trim() || $("#spanJobInverterDetails_Brand").show().fadeOut(3e3), null != t && "" != t.trim() || $("#spanJobInverterDetails_Model").show().fadeOut(3e3), null != a && "" != a.trim() || $("#spanJobInverterDetails_Series").show().text("Inverter Series  is required.").fadeOut(3e3) }), $("#btnAddBatteryManfacturer").click(function () { var e = $("#JobBatteryManufacturer_Manufacturer").val(), t = $("#JobBatteryManufacturer_ModelNumber").val(); if (null != e && "" != e && null != t && "" != t) { var a = B(), l = "<tr id='+ trId +'>"; l += '<td class="' + e + '"  width="35%">' + e + " </td>", l += '<td class="' + t + '" width="25%">' + t + " </td>", l += '<td  class="action ' + a + '" id="tdAction"  width="15%" ><a class="edit sprite-img" title="Edit" id="signEdit" style="cursor: pointer" href="javascript:void(0)" onclick="editBatteryManufacturer(\'' + a + '\')"></a>&nbsp;&nbsp;<a class="delete sprite-img" title="Delete" id="signDelete" style="cursor: pointer" onclick="DeleteBatteryManufacturerFromGrid(\'' + a + "')\"></a></td>", l += "</tr>", $("#tblBatteryManufacturer").append(l), $("#gridBattery").show(), batteryXml.push({ JobBatteryManufacturerId: a, Manufacturer: e, ModelNumber: t }) } else null != e && "" != e.trim() || $("#spanJobBatteryManufacturer").show(), null != t && "" != t.trim() || $("#spanJobBatteryModelNumber").show() }), $("#deletejob").click(function (e) { DeleteJobs() }), $("#JobInstallationDetails_IsSameAsOwnerAddress").change(function () { $(this).is(":checked") ? ($.each(OwnerAddressJson, function (e, t) { $("#JobInstallationDetails_UnitNumber").val(t.UnitNumber), $("#JobInstallationDetails_UnitTypeID").val(t.UnitType), $("#JobInstallationDetails_StreetNumber").val(t.StreetNumber), $("#JobInstallationDetails_StreetName").val(t.StreetName), $("#JobInstallationDetails_StreetTypeID").val(t.StreetType), $("#JobInstallationDetails_Town").val(t.Town), $("#JobInstallationDetails_State").val(t.State), $("#JobInstallationDetails_PostCode").val(t.PostCode), $("#JobInstallationDetails_PostalDeliveryNumber").val(t.PostalDeliveryNumber), $("#JobInstallationDetails_PostalAddressID").val(t.PostalAddressID) }), 1 == $(".OwnerAddress").val() ? ($(".InstallationAddress").val(1), $(".InstallationDPA").show(), $(".InstallationPDA").hide()) : ($(".InstallationAddress").val(2), $(".InstallationPDA").show(), $(".InstallationDPA").hide()), $(".popupAddress").find("input[type=text]").each(function () { $(this).attr("class", "form-control valid") }), $(".popupAddress").find(".field-validation-error").attr("class", "field-validation-valid"), $("#spantxtAddress").hide(), $("#popupAddress").modal("toggle")) : ($(".popupAddress").find("input[type=text]").each(function () { $(this).val(""), $(this).attr("class", "form-control valid") }), $(".popupAddress").find(".field-validation-error").attr("class", "field-validation-valid"), $("#JobInstallationDetails_UnitTypeID").val($("#JobInstallationDetails_UnitTypeID option:first").val()), $("#JobInstallationDetails_StreetTypeID").val($("#JobInstallationDetails_StreetTypeID option:first").val()), $("#JobInstallationDetails_PostalAddressID").val($("#JobInstallationDetails_PostalAddressID option:first").val())) }), $("#JobElectricians_InstallerID").change(function () { $("#JobElectricians_ElectricianID").val(""); var e = $("#JobElectricians_InstallerID").val(); $.ajax({ url: urlGetElectricianDetailbyInstaller, data: { Id: e }, contentType: "application/json", method: "get", success: function (e) { if (0 != e) { var t = JSON.parse(e); $("#JobElectricians_CompanyName").val(t[0].CompanyName), $("#JobElectricians_FirstName").val(t[0].FirstName), $("#JobElectricians_LastName").val(t[0].LastName), $("#JobElectricians_Email").val(t[0].Email), $("#JobElectricians_Phone").val(t[0].Phone), $("#JobElectricians_Mobile").val(t[0].Mobile), $("#JobElectricians_LicenseNumber").val(t[0].ElectricalContractorsLicenseNumber); var a = "False"; if ("False" == t[0].IsPostalAddress ? (a = "1", $(".ElectriciansPDA").hide(), $(".ElectriciansDPA").show()) : (a = "2", $(".ElectriciansDPA").hide(), $(".ElectriciansPDA").show()), $("#JobElectricians_AddressID").val(a), $("#JobElectricians_PostalAddressID").val(t[0].PostalAddressID), $("#JobElectricians_PostalDeliveryNumber").val(t[0].PostalDeliveryNumber), $("#JobElectricians_UnitTypeID").val(t[0].UnitTypeID), $("#JobElectricians_UnitNumber").val(t[0].UnitNumber), $("#JobElectricians_StreetNumber").val(t[0].StreetNumber), $("#JobElectricians_StreetName").val(t[0].StreetName), $("#JobElectricians_StreetTypeID").val(t[0].StreetTypeID), $("#JobElectricians_Town").val(t[0].Town), $("#JobElectricians_State").val(t[0].State), $("#JobElectricians_PostCode").val(t[0].PostCode), "" != t[0].Signature) { var l = t[0].Signature, i = t[0].UserID, s = A + "UserDocuments/" + i + "/" + l; l = $("#imgSign").attr("src"); SRCSign = s, $("#imgSign").attr("class", l), $("#imgSignature").show(), $("input[type='hidden'][name='Signature']").val(t[0].Signature), $('<input type="hidden">').attr({ name: "ProfileSignature", value: t[0].Signature, id: t[0].Signature }).appendTo("form"), $('<input type="hidden">').attr({ name: "ProfileSignatureID", value: t[0].UserID, id: t[0].UserID }).appendTo("form") } else $("#imgSign").attr("class", ""), $("#imgSign").removeAttr("src"), $("#imgSignature").hide(); ElectrianAddressJson = []; var n = $("#JobElectricians_UnitTypeID").find("option:selected").text(), o = $("#JobElectricians_UnitNumber").val(), r = $("#JobElectricians_StreetNumber").val(), d = $("#JobElectricians_StreetName").val(), c = $("#JobElectricians_StreetTypeID").find("option:selected").text(), u = $("#JobElectricians_PostalAddressID").find("option:selected").text(), b = $("#JobElectricians_PostalDeliveryNumber").val(), D = $("#JobElectricians_Town").val(), m = $("#JobElectricians_State").val(), p = $("#JobElectricians_PostCode").val(), v = $("#JobElectricians_CompanyName").val(), S = $("#JobElectricians_FirstName").val(), I = $("#JobElectricians_LastName").val(), J = $("#JobElectricians_Email").val(), h = $("#JobElectricians_Phone").val(), _ = $("#JobElectricians_Mobile").val(), g = $("#JobElectricians_LicenseNumber").val(); 1 == $("#JobElectricians_AddressID").val() ? ("" != o ? (n + " " + o + "/" + r + " " + d + " " + c + ", " + D + " " + m + " " + p).replace("Select", "") : (n + " " + r + " " + d + " " + c + ", " + D + " " + m + " " + p).replace("Select", ""), ElectrianAddressJson.push({ PostalAddressType: $("#JobElectricians_AddressID").val(), UnitType: $("#JobElectricians_UnitTypeID").val(), UnitNumber: $("#JobElectricians_UnitNumber").val(), StreetNumber: $("#JobElectricians_StreetNumber").val(), StreetName: $("#JobElectricians_StreetName").val(), StreetType: $("#JobElectricians_StreetTypeID").val(), Town: $("#JobElectricians_Town").val(), State: $("#JobElectricians_State").val(), PostCode: $("#JobElectricians_PostCode").val(), CompanyName: v, FirstName: S, LastName: I, Email: J, Phone: h, Mobile: _, LicenseNumber: g })) : (u + " " + b + ", " + D + " " + m + " " + p, ElectrianAddressJson.push({ PostalAddressType: $("#JobElectricians_AddressID").val(), PostalAddressID: $("#JobElectricians_PostalAddressID").val(), PostalDeliveryNumber: $("#JobElectricians_PostalDeliveryNumber").val(), Town: $("#JobElectricians_Town").val(), State: $("#JobElectricians_State").val(), PostCode: $("#JobElectricians_PostCode").val(), CompanyName: v, FirstName: S, LastName: I, Email: J, Phone: h, Mobile: _, LicenseNumber: g })), $("#spantxtBasicAddress").hide() } } }) }), $("#JobInstallerDetails_ElectricianID").change(function () { if ($(this).val() > 0) { var e = $("#JobInstallerDetails_ElectricianID").val(), t = $("#BasicDetails_JobType").val(); $.ajax({ url: urlGetElectricianDetailbySolarcompany, data: { Id: e, JobType: t }, contentType: "application/json", method: "get", success: function (e) { if (0 != e) { var t = JSON.parse(e); if ("" != t[0].SESignature) { var a = t[0].SESignature, l = ProjectSession_LoggedInUserId, i = UploadedDocumentPath + "UserDocuments/" + l + "/" + a; a = $("#imgSignSWHInstall").attr("src"); SRCSignSWHInstall = i, $("#imgSignSWHInstall").attr("class", a), $("#imgSWHSignatureInstaller").show(), $("input[type='hidden'][name='Signature']").val(t[0].SESignature) } else $("#imgSignSWHInstall").attr("class", ""), $("#imgSignSWHInstall").removeAttr("src"), $("#imgSWHSignatureInstaller").hide(); $("#JobInstallerDetails_FirstName").val(t[0].FirstName), $("#JobInstallerDetails_Surname").val(t[0].LastName), $("#JobInstallerDetails_Email").val(t[0].Email), $("#JobInstallerDetails_Phone").val(t[0].Phone), $("#JobInstallerDetails_Mobile").val(t[0].Mobile), $("#JobInstallerDetails_LicenseNumber").val(t[0].ElectricalContractorsLicenseNumber), $("#JobInstallerDetails_LicenseNumber").attr("readonly", "readonly"), $("#JobInstallerDetails_LicenseNumber").attr("onblur", ""); var s = "False"; "False" == t[0].IsPostalAddress ? (s = "1", $(".InstallerPDA").hide(), $(".InstallerDPA").show()) : (s = "2", $(".InstallerDPA").hide(), $(".InstallerPDA").show()), $("#JobInstallerDetails_AddressID").val(s), $("#JobInstallerDetails_UnitTypeID").val(t[0].UnitTypeID), $("#JobInstallerDetails_UnitNumber").val(t[0].UnitNumber), $("#JobInstallerDetails_StreetNumber").val(t[0].StreetNumber), $("#JobInstallerDetails_StreetName").val(t[0].StreetName), $("#JobInstallerDetails_StreetTypeID").val(t[0].StreetTypeID), $("#JobInstallerDetails_Town").val(t[0].Town), $("#JobInstallerDetails_State").val(t[0].State), $("#JobInstallerDetails_PostCode").val(t[0].PostCode), $("#JobInstallerDetails_PostalDeliveryNumber").val(t[0].PostalDeliveryNumber), $("#JobInstallerDetails_PostalAddressID").val(t[0].PostalAddressID), ElectrianAddressJson = []; var n = $("#JobInstallerDetails").find("option:selected").text(), o = $("#JobInstallerDetails.UnitNumber").val(), r = $("#JobInstallerDetails_StreetNumber").val(), d = $("#JobInstallerDetails_StreetName").val(), c = $("#JobInstallerDetails_StreetTypeID").find("option:selected").text(), u = $("#JobInstallerDetails_Town").val(), b = $("#JobInstallerDetails_State").val(), D = $("#JobInstallerDetails_PostCode").val(), m = $("#JobInstallerDetails_FirstName").val(), p = $("#JobInstallerDetails_LastName").val(), v = $("#JobInstallerDetails_Email").val(), S = $("#JobInstallerDetails_Phone").val(), I = $("#JobInstallerDetails_Mobile").val(); 1 == $("#JobElectricians_AddressID").val() ? ("" != o ? (n + " " + o + "/" + r + " " + d + " " + c + ", " + u + " " + b + " " + D).replace("Select", "") : (n + " " + r + " " + d + " " + c + ", " + u + " " + b + " " + D).replace("Select", ""), ElectrianAddressJson.push({ PostalAddressType: $("#JobInstallerDetails_AddressID").val(), UnitType: $("#JobInstallerDetails.UnitTypeID").val(), UnitNumber: $("#JobInstallerDetails.UnitNumber").val(), StreetNumber: $("#JobInstallerDetails_StreetNumber").val(), StreetName: $("#JobInstallerDetails_StreetName").val(), StreetType: $("#JobInstallerDetails_StreetTypeID").val(), Town: $("#JobInstallerDetails_Town").val(), State: $("#JobInstallerDetails_State").val(), PostCode: $("#JobInstallerDetails_PostCode").val(), FirstName: m, LastName: p, Email: v, Phone: S, Mobile: I })) : (u + " " + b + " " + D, ElectrianAddressJson.push({ PostalAddressType: $("#JobInstallerDetails_AddressID").val(), Town: $("#JobInstallerDetails_Town").val(), State: $("#JobInstallerDetails_State").val(), PostCode: $("#JobInstallerDetails_PostCode").val(), FirstName: m, LastName: p, Email: v, Phone: S, Mobile: I })), $("#txtInstallerName").val($("#JobInstallerDetails_FirstName").val() + " " + $("#JobInstallerDetails_Surname").val()), $("#spantxtInstallerNames").hide() } } }) } else clearPopupInstaller() }), $("#JobElectricians_ElectricianID").change(function () { $("#JobElectricians_InstallerID").val(""); var e = $("#JobElectricians_ElectricianID").val(); $.ajax({ url: urlGetElectricianDetailbySolarcompany, data: { Id: e }, contentType: "application/json", method: "get", success: function (e) { if (0 != e) { var t = JSON.parse(e); $("#JobElectricians_CompanyName").val(t[0].CompanyName), $("#JobElectricians_FirstName").val(t[0].FirstName), $("#JobElectricians_LastName").val(t[0].LastName), $("#JobElectricians_Email").val(t[0].Email), $("#JobElectricians_Phone").val(t[0].Phone), $("#JobElectricians_Mobile").val(t[0].Mobile), $("#JobElectricians_LicenseNumber").val(t[0].ElectricalContractorsLicenseNumber); var a = "False"; if ("False" == t[0].IsPostalAddress ? (a = "1", $(".ElectriciansPDA").hide(), $(".ElectriciansDPA").show()) : (a = "2", $(".ElectriciansDPA").hide(), $(".ElectriciansPDA").show()), $("#JobElectricians_AddressID").val(a), $("#JobElectricians_PostalAddressID").val(t[0].PostalAddressID), $("#JobElectricians_PostalDeliveryNumber").val(t[0].PostalDeliveryNumber), $("#JobElectricians_UnitTypeID").val(t[0].UnitTypeID), $("#JobElectricians_UnitNumber").val(t[0].UnitNumber), $("#JobElectricians_StreetNumber").val(t[0].StreetNumber), $("#JobElectricians_StreetName").val(t[0].StreetName), $("#JobElectricians_StreetTypeID").val(t[0].StreetTypeID), $("#JobElectricians_Town").val(t[0].Town), $("#JobElectricians_State").val(t[0].State), $("#JobElectricians_PostCode").val(t[0].PostCode), "" != t[0].Signature) { var l = t[0].Signature, i = t[0].JobElectricianID, s = A + "JobDocuments/" + i + "/" + l; l = $("#imgSign").attr("src"); SRCSign = s, $("#imgSign").attr("class", l), $("#imgSignature").show() } else $("#imgSign").attr("class", ""), $("#imgSign").removeAttr("src"), $("#imgSignature").hide(); ElectrianAddressJson = []; var n = $("#JobElectricians_UnitTypeID").find("option:selected").text(), o = $("#JobElectricians_UnitNumber").val(), r = $("#JobElectricians_StreetNumber").val(), d = $("#JobElectricians_StreetName").val(), c = $("#JobElectricians_StreetTypeID").find("option:selected").text(), u = $("#JobElectricians_PostalAddressID").find("option:selected").text(), b = $("#JobElectricians_PostalDeliveryNumber").val(), D = $("#JobElectricians_Town").val(), m = $("#JobElectricians_State").val(), p = $("#JobElectricians_PostCode").val(), v = $("#JobElectricians_CompanyName").val(), S = $("#JobElectricians_FirstName").val(), I = $("#JobElectricians_LastName").val(), J = $("#JobElectricians_Email").val(), h = $("#JobElectricians_Phone").val(), _ = $("#JobElectricians_Mobile").val(), g = $("#JobElectricians_LicenseNumber").val(); 1 == $("#JobElectricians_AddressID").val() ? ("" != o ? (n + " " + o + "/" + r + " " + d + " " + c + ", " + D + " " + m + " " + p).replace("Select", "") : (n + " " + r + " " + d + " " + c + ", " + D + " " + m + " " + p).replace("Select", ""), ElectrianAddressJson.push({ PostalAddressType: $("#JobElectricians_AddressID").val(), UnitType: $("#JobElectricians_UnitTypeID").val(), UnitNumber: $("#JobElectricians_UnitNumber").val(), StreetNumber: $("#JobElectricians_StreetNumber").val(), StreetName: $("#JobElectricians_StreetName").val(), StreetType: $("#JobElectricians_StreetTypeID").val(), Town: $("#JobElectricians_Town").val(), State: $("#JobElectricians_State").val(), PostCode: $("#JobElectricians_PostCode").val(), CompanyName: v, FirstName: S, LastName: I, Email: J, Phone: h, Mobile: _, LicenseNumber: g })) : (u + " " + b + ", " + D + " " + m + " " + p, ElectrianAddressJson.push({ PostalAddressType: $("#JobElectricians_AddressID").val(), PostalAddressID: $("#JobElectricians_PostalAddressID").val(), PostalDeliveryNumber: $("#JobElectricians_PostalDeliveryNumber").val(), Town: $("#JobElectricians_Town").val(), State: $("#JobElectricians_State").val(), PostCode: $("#JobElectricians_PostCode").val(), CompanyName: v, FirstName: S, LastName: I, Email: J, Phone: h, Mobile: _, LicenseNumber: g })), $("#txtBasicAddress").val($("#JobElectricians_FirstName").val() + " " + $("#JobElectricians_LastName").val()), $("#spantxtBasicAddress").hide() } } }) }), $("#btnCollectSignature").click(function () { var e, t, a, l = $("#BasicDetails_JobType").val(), i = "", s = ""; if (1 == l) if ("2" == $("#drpSendMail").val() ? (e = $("#BasicDetails_InstallerID").val(), t = "Installer  is required for it.", a = "No") : (e = OwnerEmailFromJson, t = "Owner Email is required for it.", a = "Yes", i = OwnerFirstNameFromJson, s = OwnerLastNameFromJson), "" != e && null != e && null != e) { var n = "<a href=" + maillink + ">" + maillink + "</a>", o = e; $.ajax({ url: urlMailForCollectSignature, data: { MailUrl: n, MailTo: o, JobType: l, IsOwner: a, FirstName: i, LastName: s }, contentType: "application/json", method: "get", success: function (e) { if (1 == e) return $(".alert").hide(), $("#successMsgRegion").html(closeButton + "Mail has been send successfully."), $("#successMsgRegion").show(), !1; $(".alert").hide(), $("#errorMsgRegion").html(closeButton + "Mail has not been sent."), $("#errorMsgRegion").show() } }) } else $("#spantxtCollectDignature").show().text(t).fadeOut(3e3); else if ("2" == $("#drpSendMail").val() ? (e = InstallerEmailFromJson, t = "Installer Email is required for it.", a = "No", i = InstallerFirstNameFromJson, s = InstallerLastNameFromJson) : (e = OwnerEmailFromJson, t = "Owner Email is required for it.", a = "Yes", i = OwnerFirstNameFromJson, s = OwnerLastNameFromJson), "" != e && null != e && null != e) { n = "<a href=" + maillink + ">" + maillink + "</a>", o = e; $.ajax({ url: urlMailForCollectSignature, data: { MailUrl: n, MailTo: o, JobType: l, IsOwner: a, FirstName: i, LastName: s }, contentType: "application/json", method: "get", success: function (e) { if (1 == e) return $(".alert").hide(), $("#successMsgRegion").html(closeButton + "Mail has been send successfully."), $("#successMsgRegion").show(), !1 } }) } else $("#spantxtCollectDignature").show().text(t).fadeOut(3e3) }), $("#loading-image").hide() }), $("#btnClosePopUpBoxSWHInsaller").click(function () { $("#popupboxSWHInsaller").modal("toggle") });