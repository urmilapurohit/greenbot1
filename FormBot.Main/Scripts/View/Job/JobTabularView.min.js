$(document).ready((function(){function disableSSCdropdown(){BasicDetails_SSCID>0&&1!=ProjectSession_UserTypeId&&3!=ProjectSession_UserTypeId&&4!=ProjectSession_UserTypeId&&5!=ProjectSession_UserTypeId&&2!=ProjectSession_UserTypeId?$("#SSCID").prop("disabled",!0):$("#SSCID").prop("disabled",!1)}var liLength;(($(".line-no.unverified").length>0||$(".line-no.installationVerified").length>0||$(".line-no.verified").length>0||$(".line-no.notverified").length>0)&&"true"==$("#GlobalisAllowedSPV").val().toLowerCase()&&"True"==IsSPVRequired?$("#SPVLabel").show():$("#SPVLabel").hide(),"true"==$("#GlobalisAllowedSPV").val().toLowerCase()&&"True"==IsSPVRequired?($("#btnSPVProductVerificationErrorLog").show(),$("#btnSPVProductVerification").show()):($("#btnSPVProductVerificationErrorLog").hide(),$("#btnSPVProductVerification").hide()),0!=BasicDetails_ScoID&&BasicDetails_ScoID>0?dropDownData.push({id:"ScoID",key:"",value:BasicDetails_ScoID,hasSelect:!0,callback:null,defaultText:null,proc:"User_GetSCOUser",param:[{JobID:Model_JobID}],bText:"Name",bValue:"UserId"}):dropDownData.push({id:"ScoID",key:"",value:null,hasSelect:!0,callback:null,defaultText:null,proc:"User_GetSCOUser",param:[{JobID:Model_JobID}],bText:"Name",bValue:"UserId"}),$("#SSCID").change((function(){var jobPriority=$("#SSCID option:selected").text();$("#BasicDetails_SSCName").val(jobPriority)})),dropDownData.push({id:"SSCID",key:"",value:BasicDetails_SSCID,hasSelect:!0,callback:disableSSCdropdown,defaultText:null,proc:"User_GetSSCUserByJbID",param:[{JobID:Model_JobID}],bText:"Name",bValue:"UserId"}),dropDownData.bindDropdown(),$("#btnJobPrint").click((function(){var url=urlPrint+$(this).attr("jobid");window.open(url)})),console.log(urlIndex),$("#aSwitch").click((function(e){window.location.href="/Job/Index?Id="+eJobId+"&isTabularView=false"})),$("#btnSPVProductVerification").click((function(){SPVProductverification()})),$("#btnSPVProductVerificationErrorLog").click((function(){SPVProductionVerificationErrorLog()})),$("#btnReSPVProductVerification").click((function(){SPVProductverification(!0)})),$("#horizontalTab").easyResponsiveTabs({type:"default",width:"auto",fit:!0,closed:"accordion",activate:function(event){var $tab=$(this),$info=$("#tabInfo"),$name;$("span",$info).text($tab.text()),$info.show(),$("#spnTabIndex").text($("li.resp-tab-active").index()+1),$("#successMsgRegionSTCDetails").hide(),$("#errorMsgRegionSTCDetails").hide()}}),$("#spnTabIndex").text($("li.resp-tab-active").index()+1),$("#verticalTab").easyResponsiveTabs({type:"vertical",width:"auto",fit:!0}),$(".show-bcc").click((function(){$(".cc-input-box").slideToggle("fast")})),$(".mCustomScrollbar").mCustomScrollbar(),UploadAllSignatureOfJob($("#uploadJobOwnerSign")),null!=Model_liLength)&&UpdatePercentage(Model_liLength);null!=Model_OwnerSignature&&""!=Model_OwnerSignature&&(SRCOwnerSign=signatureURL+Model_OwnerSignature_Replace,$("#imgOwnerSignatureView").show()),$("#btnClosepopupOwnerSign").click((function(){$("#popupOwnerSign").modal("toggle")})),$("#imgOwnerSignatureView").click((function(){$("#loading-image").css("display",""),$("#imgOwnerSign").attr("src",SRCOwnerSign).load((function(){logoWidth1=this.width,logoHeight1=this.height,$("#popupOwnerSign").modal({backdrop:"static",keyboard:!1}),$(window).height()<=logoHeight1?($("#imgOwnerSign").closest("div").height($(window).height()-150),$("#imgOwnerSign").closest("div").css("overflow-y","scroll"),$("#imgOwnerSign").height(logoHeight1)):($("#imgOwnerSign").height(logoHeight1),$("#imgOwnerSign").closest("div").removeAttr("style")),screen.width<=logoWidth1||logoWidth1>=screen.width-250?($("#popupOwnerSign").find(".modal-dialog").width(screen.width-250),$("#imgOwnerSign").width(logoWidth1)):($("#imgOwnerSign").width(logoWidth1),$("#popupOwnerSign").find(".modal-dialog").width(logoWidth1)),$("#loading-image").css("display","none")})),$("#imgOwnerSign").unbind("error"),$("#imgOwnerSign").attr("src",SRCOwnerSign).error((function(){alert("Image does not exist."),$("#loading-image").css("display","none")}))})),1==ProjectSession_UserTypeId||3==ProjectSession_UserTypeId||10==$("#STCStatusId").val()||12==$("#STCStatusId").val()||14==$("#STCStatusId").val()||17==$("#STCStatusId").val()?($("#JobOwnerDetails_OwnerType").prop("disabled",!1),$("#JobInstallationDetails_PropertyType").prop("disabled",!1),$("#JobSystemDetails_SystemSize").prop("disabled",!1),$("#BasicDetails_strInstallationDate").prop("disabled",!1),$("#JobSystemDetails_SerialNumbers").prop("disabled",!1)):($("#JobOwnerDetails_OwnerType").prop("disabled",!0),$("#JobInstallationDetails_PropertyType").prop("disabled",!0),$("#JobSystemDetails_SystemSize").prop("disabled",!0),$("#BasicDetails_strInstallationDate").prop("disabled",!0),$("#JobSystemDetails_SerialNumbers").prop("disabled",!0)),ShowHideGSTSection($("#JobInstallationDetails_PropertyType").val().toLowerCase(),$("#JobOwnerDetails_OwnerType").val().toLowerCase())})),$("#btnSaveTab").click((function(e){e.preventDefault();var Type=$("#horizontalTab").find(".resp-tab-active").data("type");"basic"==Type?TabularView.UpdateBasicDetail():"owner"==Type?TabularView.UpdateOwnerDetail():"system"==Type?TabularView.UpdateSystemDetail():"installer"==Type||("stc"==Type?(TabularView.UpdateStcDetail(),TabularView.UpdateGstDetail()):"installation"==Type&&TabularView.UpdateInstallationDetail())}));var TabularView={UpdateBasicDetail:function(obj){var soldBy=$("#BasicDetails_JobSoldByText").val(),url,data;($("#BasicDetails_SoldBy").val(soldBy),$("#frmBasicDetail").valid())&&($("#SSCID").prop("disabled",!1),getDataTabular(urlUpdateBasicDetail,$("#frmBasicDetail").serializeToJson().BasicDetails,(function(result){result.status?(ReloadSTCModule(),showSuccessMessage("Basic details has been saved successfully."),""!=$("#SSCID").val()?$("#SSCID").prop("disabled",!0):$("#SSCID").prop("disabled",!1)):(showErrorMessage("Basic details has not been saved."),""!=$("#SSCID").val()?$("#SSCID").prop("disabled",!0):$("#SSCID").prop("disabled",!1))})))},UpdateOwnerDetail:function(){$("#JobOwnerDetails_JobID").val(BasicDetails_JobID);var isValid=addressValidationRules("JobOwnerDetails"),propertyType=$("#JobInstallationDetails_PropertyType").val(),emailOwner=$("#JobOwnerDetails_Email").val();if("commercial"==propertyType.toLowerCase()&&(null==emailOwner||""==emailOwner))return showErrorMessage("Owner email address is mandatory for commercial jobs."),!1;if("school"==propertyType.toLowerCase()&&(null==emailOwner||""==emailOwner))return showErrorMessage("Owner email address is mandatory for installation property type school."),!1;if($("#frmOwnerDetail").valid()&&isValid){var url=urlUpdateOwnerDetail,data=$("#frmOwnerDetail").serializeToJson();data.jobId=BasicDetails_JobID,data.isGST=$("#BasicDetails_IsGst").val(),getDataTabular(url,data,(function(result){result.status?(ShowHideGSTSection($("#JobInstallationDetails_PropertyType").val().toLowerCase(),$("#JobOwnerDetails_OwnerType").val().toLowerCase()),ReloadSTCModule(),showSuccessMessage("Owner details has been saved successfully.")):showErrorMessage("Owner details has not been saved.")}))}},UpdateStcDetail:function(){var url=urlUpdateStcDetail,data=$("#frmStcDetail").serializeToJson();data.JobType=$("#BasicDetails_JobType").val();var propertyType=$("#JobInstallationDetails_PropertyType").val(),emailOwner=$("#JobOwnerDetails_Email").val(),stcLatitude=$("#JobSTCDetails_Latitude").val(),stcLongitude=$("#JobSTCDetails_Longitude").val(),decimal=/^[-+]?[0-9]+\.[0-9]+$/;return""==stcLatitude||stcLatitude.match(decimal)?""==stcLongitude||stcLongitude.match(decimal)?"commercial"!=propertyType.toLowerCase()||null!=emailOwner&&""!=emailOwner?"school"!=propertyType.toLowerCase()||null!=emailOwner&&""!=emailOwner?void getDataTabular(url,data,(function(result){result.status?(ReloadSTCModule(),showSuccessMessage("Stc detail has been saved successfully.")):showErrorMessage("Stc detail has not been saved.")})):(showErrorMessage("Owner email address is mandatory for installtion property type school."),!1):(showErrorMessage("Owner email address is mandatory for commercial jobs."),!1):(showErrorMessage("Please enter longitude in decimal format of STC job details."),!1):(showErrorMessage("Please enter latitude in decimal format of STC job details."),!1)},UpdateInstallationDetail:function(){var InstallationAddress=$("#txtAddress").val();if(""==InstallationAddress.trim()||null==InstallationAddress||null==InstallationAddress)return $("#spantxtAddress").show(),!1;if($("#spantxtAddress").hide(),$("#JobInstallationDetails_JobID").val(BasicDetails_JobID),$("#frmInstallationDetail").valid()){var data=JSON.stringify($("#frmInstallationDetail").serializeToJson()),objData=JSON.parse(data),installationAddressData=JSON.stringify($("#JobInstallationAddress").serializeToJson()),objInstallationAddressData=JSON.parse(installationAddressData),installationData=JSON.stringify($("#JobInstallationDetailInfo").serializeToJson()),objInstallationData=JSON.parse(installationData),extraInstallationData=JSON.stringify($("#JobExtraInstallationInfo").serializeToJson()),objExtraInstallationData=JSON.parse(extraInstallationData);$.extend(objData.JobInstallationDetails,objInstallationAddressData.JobInstallationDetails),$.extend(objData.JobInstallationDetails,objInstallationData.JobInstallationDetails),$.extend(objData.JobInstallationDetails,objExtraInstallationData.JobInstallationDetails);var lstCustomDetails=[],jobData,url;$("#customDetails").find(".spanCustomFields").each((function(){lstCustomDetails.push({JobCustomFieldId:$(this).attr("data-jobcustomfieldid"),FieldValue:$(this).val(),SeparatorId:$(this).attr("data-SeperatorId")})})),objData.JobInstallationDetails.lstCustomDetails=lstCustomDetails;for(var customLength=$("#customDetails").find(".spanCustomFields").length,i=0;i<customLength;i++)delete objData["lstCustomDetails["+i+"]"];getDataTabular(urlUpdateInstallationDetail,objData,(function(result){ShowHideGSTSection($("#JobInstallationDetails_PropertyType").val().toLowerCase(),$("#JobOwnerDetails_OwnerType").val().toLowerCase()),result.status?(ReloadSTCModule(),showSuccessMessage("Installation detail has been saved successfully.")):showErrorMessage("Installation detail has not been saved.")}))}},UpdateSystemDetail:function(){var panelData="",xmlPanel="",inverterData="",xmlInverter="",batteryManufacturerData=[];if(batteryManufacturerData=JSON.parse(JSON.stringify(batteryXml)),PanelXml.length>0){var jsonp=JSON.stringify(PanelXml),sName="",obj=$.parseJSON(jsonp);$.each(obj,(function(){sName+="<panel><Brand>"+htmlEncode(this.Brand)+"</Brand><Model>"+htmlEncode(this.Model)+"</Model><NoOfPanel>"+this.Count+"</NoOfPanel><Supplier>"+htmlEncode(this.Supplier)+"</Supplier></panel>"})),xmlPanel="<Panels>"+sName+"</Panels>"}if(InverterXml.length>0){var jsonp=JSON.stringify(InverterXml),sName="",obj=$.parseJSON(jsonp);$.each(obj,(function(){sName+="<inverter><Brand>"+htmlEncode(this.Brand)+"</Brand><Model>"+htmlEncode(this.Model)+"</Model><Series>"+htmlEncode(this.Series)+"</Series><NoOfInverter>"+htmlEncode(this.NoOfInverter)+"</NoOfInverter><Supplier>"+htmlEncode(this.Supplier)+"</Supplier></inverter>"})),xmlInverter="<Inverters>"+sName+"</Inverters>"}$("#panelXml").val(xmlPanel),$("#inverterXml").val(xmlInverter),$("#JobSystemDetails_jobTypeTab").val(jobType),$("#JobSystemDetails_JobID").val(BasicDetails_JobID),$("#OldPanelDetails").val(JSON.stringify(OldPanelXml)),$("#NewPanelDetails").val(JSON.stringify(PanelXml));var data=JSON.stringify($("#frmSystemDetail").serializeToJson()),objData={},jobSystemDetails=JSON.parse(data).JobSystemDetails,isRequiredFieldofSTC;if(jobSystemDetails.ModifiedCalculatedSTC=1==$("#BasicDetails_JobType").val()?$("#JobSystemDetails_CalculatedSTC").val():$("#JobSystemDetails_CalculatedSTCForSWH").val(),jobSystemDetails.NoOfPanel=$("#JobSystemDetails_NoOfPanel").html(),jobSystemDetails.InstallationType=$("#JobSystemDetails_InstallationType").val(),systemXml.length>0&&(jobSystemDetails.SystemBrand=systemXml[0].Brand,jobSystemDetails.SystemModel=systemXml[0].Model),jobSystemDetails.panelXmlTabular=xmlPanel,jobSystemDetails.inverterXmlTabular=xmlInverter,batteryManufacturerData.length>0){for(var i=0;i<batteryManufacturerData.length;i++)delete batteryManufacturerData[i].JobBatteryManufacturerId;jobSystemDetails.lstJobBatteryManufacturer=batteryManufacturerData,"select"==$("#JobSTCDetails_batterySystemPartOfAnAggregatedControl").val().toLowerCase()?jobSystemDetails.batterySystemPartOfAnAggregatedControl="":jobSystemDetails.batterySystemPartOfAnAggregatedControl=$("#JobSTCDetails_batterySystemPartOfAnAggregatedControl").val(),"select"==$("#JobSTCDetails_changedSettingOfBatteryStorageSystem").val().toLowerCase()?jobSystemDetails.changedSettingOfBatteryStorageSystem="":jobSystemDetails.changedSettingOfBatteryStorageSystem=$("#JobSTCDetails_changedSettingOfBatteryStorageSystem").val()}isRequiredFieldofSTC=1==$("#BasicDetails_JobType").val()?!!($("#BasicDetails_strInstallationDate").val()&&$("#JobSTCDetails_DeemingPeriod").val()&&$("#JobInstallationDetails_PostCode").val()):!!(systemXml.length>0&&systemXml[0].Brand&&systemXml[0].Model&&$("#JobInstallationDetails_PostCode").val());var isSystemSize=$("#JobSystemDetails_SystemSize").val()>0,isInstallationDate=!!$("#BasicDetails_strInstallationDate").val(),isValidDataForSTC,serialVal,url;(isValidDataForSTC=1==$("#BasicDetails_JobType").val()?!isSystemSize||isSystemSize&&isRequiredFieldofSTC:!isInstallationDate||isInstallationDate&&isRequiredFieldofSTC,objData.objSystem=jobSystemDetails,objData.OldPanelDetails=JSON.parse(data).OldPanelDetails,objData.NewPanelDetails=JSON.parse(data).NewPanelDetails,serialVal="false"==isPanelSerialNumber.toLowerCase()&&8==ProjectSession_UserTypeId||SerialNumbersValidation())&&(isValidDataForSTC?getDataTabular(urlUpdateSystemDetail,objData,(function(result){if(result.status){var unverifiedSerialNumber;if(OldPanelXml=[],OldPanelXml=JSON.parse(JSON.stringify(PanelXml)),1==result.jobType?result.STCValue>0?$("#JobSystemDetails_CalculatedSTC").val(result.STCValue):$("#JobSystemDetails_CalculatedSTC").val(""):result.STCValue>0?$("#JobSystemDetails_CalculatedSTCForSWH").val(result.STCValue):$("#JobSystemDetails_CalculatedSTCForSWH").val(""),ReloadSTCModule(),serialNumber=result.serialnumbers,$("div.line-no").removeClass("verified"),$("div.line-no").removeClass("unverified"),$("div.line-no").removeClass("installationVerified"),$("div.line-no").removeClass("notverified"),$("#GlobalisAllowedSPV").val(result.GlobalisAllowedSPV),result.IsSPVRequired)IsSPVRequired="True",VerifyUnVerifySerialNumber(),null!=serialNumber.find(serialNumber=>null==serialNumber.IsVerified)&&"true"==$("#GlobalisAllowedSPV").val().toLowerCase()&&"True"==IsSPVRequired?$(".isSPVRequired").show():$(".isSPVRequired").hide();else $(".isSPVRequired").hide(),$("#SPVLabel").hide(),IsSPVRequired="False";showSuccessMessage(result.isRECUp?"System detail has been saved successfully.":"System detail has been saved successfully but STC Value cannot be calculated since REC website is down.")}else showErrorMessage("System detail has not been saved.")})):1==$("#BasicDetails_JobType").val()?showErrorMessage("Please fill Installation Date, STC DeemingPeriod, Installation postcode to set STC value."):showErrorMessage("Please fill Installation Date, System brand, System Model, Installation postcode to set STC value."))},UpdateGstDetail:function(){2==modelIsGSTSetByAdminUser&&"true"==modelIsRegisteredWithGST||"corporate body"==$("#JobOwnerDetails_OwnerType").val().toLowerCase()||"trustee"==$("#JobOwnerDetails_OwnerType").val().toLowerCase()||"commercial"==$("#JobInstallationDetails_PropertyType").val().toLowerCase()||"school"==$("#JobInstallationDetails_PropertyType").val().toLowerCase()?$("#BasicDetails_IsGst").prop("checked",!0):$("#BasicDetails_IsGst").prop("checked",!1);var obj={isGST:$("#BasicDetails_IsGst").prop("checked"),FileName:$("#BasicDetails_GSTDocument").val(),jobId:BasicDetails_JobID},url;getDataTabular(urlUpdateGstDetail,obj,(function(result){result.status||showErrorMessage("GST detail has not been saved.")}))}};function getDataTabular(url,data,callback){$.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:url,data:JSON.stringify(data),success:function(result){result.status?callback&&callback(result):showErrorMessage(result.error)},error:function(ex){showErrorMessage("job has not been saved."+ex)}})}function UploadAllSignatureOfJob(objSignUpload){var typeOfSignature=objSignUpload.attr("typeOfSignature");objSignUpload.fileupload({url:urlUploadJobSignature,dataType:"json",done:function(e,data){var UploadFailedFiles=[];UploadFailedFiles.length=0;for(var i=0;i<data.result.length;i++)if(1==data.result[i].Status){var path=signatureURL+"JobDocuments/"+Model_JobID+"/"+data.result[i].FileName;1==typeOfSignature&&(isOwnerSignUpload=!0,SRCOwnerSign=path,$("#imgOwnerSignatureView").show())}else UploadFailedFiles.push(data.result[i].FileName.replace("%","$"));UploadFailedFiles.length>0?showErrorMessage("File has not been uploaded."):showSuccessMessage("File has been uploaded successfully.")},progressall:function(e,data){},singleFileUploads:!1,send:function(e,data){var documentType,mimeType=data.files[0].type.split("/")[0];if(data.files.length>1)for(var i=0;i<data.files.length;i++){if(data.files[i].size>parseInt(documentSizeLimit))return showErrorMessage(" "+data.files[i].name+" Maximum file size limit exceeded. Please upload a file smaller  than "+maxsize+"MB"),!1;if(CheckSpecialCharInFileName(data.files[i].name))return showErrorMessage("Please upload file that not conatain <> ^ [] ."),!1}else{if(data.files[0].size>parseInt(documentSizeLimit))return showErrorMessage("Maximum file size limit exceeded.Please upload a file smaller than "+maxsize+"MB"),!1;if(CheckSpecialCharInFileName(data.files[0].name))return showErrorMessage("Please upload file that not conatain <> ^ [] ."),!1}return"image"!=mimeType?(showErrorMessage("Please upload a file with .jpg , .jpeg or .png extension."),$("html").animate({scrollTop:0},"slow"),$("body").animate({scrollTop:0},"slow"),!1):($(".alert").hide(),$("#errorMsgRegion").html(""),$("#errorMsgRegion").hide(),!0)},formData:{jobId:BasicDetails_JobID,typeOfSignature:typeOfSignature}})}function clearSignature(typeOfSignature){confirm("Are you sure you want to delete uploaded signature?")&&1==typeOfSignature&&(ClearAllSignature(typeOfSignature,SRCOwnerSign,isOwnerSignUpload),isOwnerSignUpload=!1,$("#imgOwnerSignatureView").hide())}function ClearAllSignature(typeOfSignature,signPath,isUpload){$.ajax({url:urlClearJobSignture,dataType:"json",contentType:"application/json; charset=utf-8",type:"get",data:{typeOfSignature:typeOfSignature,signaturePath:signPath,jobId:BasicDetails_JobID,isUpload:isUpload.toString().toLowerCase()},success:function(response){response.status?showSuccessMessage("Signature has been deleted successfully."):showErrorMessage(response.error)},error:function(){showErrorMessage("Signature has not been deleted.")}})}var TypeOneLi=20,TypeTwoLi=11;function UpdatePercentage(liLength){var mainLi="1"==jobType?TypeOneLi:TypeTwoLi,a=mainLi-liLength,per;setProgressbarValue(Math.ceil(100*a/mainLi))}function setProgressbarValue(value){$(".progress-bar").css("width",value+"%").attr("aria-valuenow",value).html(value+"%")}function ReloadSTCJobScreen(jobId){ReloadSTCModule()}function ReloadSTCModule(){$("#loading-image").show(),setTimeout((function(){$.get(urlGetSTCJobForTabular+BasicDetails_JobID,(function(data){$("#reloadSTCJobScreen").empty(),$("#reloadSTCJobScreen").append(data),10!=$("#STCStatusId").val()&&12!=$("#STCStatusId").val()&&14!=$("#STCStatusId").val()&&17!=$("#STCStatusId").val()&&($("#CESDocbtns").hide(),$("#STCDocBtns").hide(),$(".isdelete").css("display","none")),1!=ProjectSession_UserTypeId&&3!=ProjectSession_UserTypeId&&4!=ProjectSession_UserTypeId&&2!=ProjectSession_UserTypeId&&5!=ProjectSession_UserTypeId||($("#CESDocbtns").show(),$("#STCDocBtns").show()),1!=ProjectSession_UserTypeId&&3!=ProjectSession_UserTypeId||$(".isdelete").css("display","block"),1!=ProjectSession_UserTypeId&&3!=ProjectSession_UserTypeId&&10!=$("#STCStatusId").val()&&12!=$("#STCStatusId").val()&&14!=$("#STCStatusId").val()&&17!=$("#STCStatusId").val()&&$("#btnsave").hide(),$("#loading-image").hide()}))}),500)}function LoadCommonJobsWithSameInstallDateAndInstaller(){$.ajax({url:urlLoadCommonJobsWithSameInstallDateAndInstaller,type:"GET",data:{jobId:Model_JobID,installerId:$("#hdBasicDetails_InstallerID").val(),installationDate:$("#BasicDetails_strInstallationDate").val()},dataType:"json",success:function(Data){if(Data.commonJobs.length>2){for(var div='<div class="warning-notice" id="divWarning"><h5>Warning Notice:</h5> <br/> Installer: <b>'+Data.commonJobs[0].InstallerName+"</b> has been already assigned the following jobs.",i=0;i<Data.commonJobs.length;i++){var companyName="<b class=commonJobs>Company : </b>"+Data.commonJobs[i].CompanyName,resellerName=" <b class=commonJobs>Reseller : </b>"+Data.commonJobs[i].ResellerName,p;div+=p='<p>RefNumber : <a target="_blank" href="/Job/Index?id='+Data.commonJobs[i].JobID+'"> '+Data.commonJobs[i].RefNumber+" </a> "+companyName+resellerName+"</p>"}div+="</div>",$("#loadCommonJobs").show(),$("#loadCommonJobs").html(div)}else $("#loadCommonJobs").html(""),$("#loadCommonJobs").hide();if(Data.commonJobsWithFailedSTCStaus.length>0){for(var div='<div class="warning-notice" id="divWarning"><h5>Warning Notice:</h5> <br/> Installer: <b>'+Data.commonJobsWithFailedSTCStaus[0].InstallerName+"</b> has been already assigned the following jobs which have failed stc statuses.",i=0;i<Data.commonJobsWithFailedSTCStaus.length;i++){var companyName="<b class=commonJobs>Company : </b>"+Data.commonJobsWithFailedSTCStaus[i].CompanyName,resellerName=" <b class=commonJobs>Reseller : </b>"+Data.commonJobsWithFailedSTCStaus[i].ResellerName,p;div+=p='<p>RefNumber : <a target="_blank" href="/Job/Index?id='+Data.commonJobsWithFailedSTCStaus[i].JobID+'"> '+Data.commonJobsWithFailedSTCStaus[i].RefNumber+" </a> "+companyName+resellerName+"</p>"}div+="</div>",$("#loadCommonJobsWithFailedStcStatus").show(),$("#loadCommonJobsWithFailedStcStatus").html(div)}else $("#loadCommonJobsWithFailedStcStatus").html(""),$("#loadCommonJobsWithFailedStcStatus").hide();var unverifiedSerialNumber;(serialNumber=Data.serialnumbers,$("div.line-no").removeClass("verified"),$("div.line-no").removeClass("unverified"),$("div.line-no").removeClass("installationVerified"),$("div.line-no").removeClass("notverified"),Data.IsSPVRequired)?(IsSPVRequired="True",VerifyUnVerifySerialNumber(),null!=serialNumber.find(serialNumber=>null==serialNumber.IsVerified)?$(".isSPVRequired").show():$(".isSPVRequired").hide()):($(".isSPVRequired").hide(),IsSPVRequired="False")}})}$("#btnViewHistory").click((function(e){e.preventDefault(),$("#JobHistoryOfJob").load(urlShowHistory+urlRequestContext,(function(){$("#JobHistory").modal({backdrop:"static",keyboard:!1})}))})),$("#nxtTab").click((function(e){e.preventDefault(),$("li.resp-tab-active").next().click(),$("#successMsgRegionSTCDetails").hide(),$("#errorMsgRegionSTCDetails").hide(),$("#spnTabIndex").text($("li.resp-tab-active").index()+1)})),$("#prevTab").click((function(e){e.preventDefault(),$("li.resp-tab-active").prev().click(),$("#successMsgRegionSTCDetails").hide(),$("#errorMsgRegionSTCDetails").hide(),$("#spnTabIndex").text($("li.resp-tab-active").index()+1)})),$("#JobInstallationDetails_PropertyType").change();